[[databaseasyncexecutor]]
==== `DatabaseAsyncExecutor` Interface

image:../images/edit.png[link="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/java-ref-database-async.adoc" float=right]

This is the class to manage asynchronous operations.
To obtain an instance of DatabaseAsyncExecutor, use the method `.async()` in `<<database-url,Database>>`.

The Asynchronous API schedule the operation to be executed as soon as possible, but by a different thread.
ArcadeDB optimizes the usage of asynchronous threads to be equals to the number of cores found in the machine (but it is still configurable).
Use Asynchronous API if the response of the operation can be managed in asynchronous way and if you want to avoid developing Multi-Threads application by yourself.

===== Methods

[cols=4]
|===
|<<asynccommandpos,**command(...)** positional parameters>>
|<<async-command-map,**command(Map<K,V>)** parameter map>>
|<<asyncquerypos,**query(...)** positional parameters>>
|<<async-query-map,**query(Map<K,V>)** parameter map>>
|<<async-transaction,**transaction()**>>
|<<async-transaction,**transaction(retries)**>>
|<<async-transaction,**transaction(retries, callbacks)**>>
|<<asynccreate,**createRecord()**>>
|<<asyncupdate,**updateRecord()**>>
|<<asyncdelete,**deleteRecord()**>>
|
|
|===

'''

[[asyncquerypos]]
[discrete]
====== query( language, command, callback, positionalParameters )

Executes a query in asynchronous way, with optional positional parameters.
This method returns immediately.
This method only executes idempotent statements, namely `SELECT` and `MATCH`, that cannot change the database.
The execution of any other commands will throw a `IllegalArgumentException` exception.

Syntax:

```java
void query( String language, String command, AsyncResultsetCallback callback,
            Object... positionalParameters )
```

Where:

* **`language`** is the language used, which can be "sql", "sqlscript", "cypher", etc.
* **`command`** is the command to execute
* **`callback`** is the callback instance that will be invoked when the query is executed
* **`positionalParameters`** Optional, variable number of parameters to bind to the query

Example:

```java
database.async().query(
  "sql",
  "select name from Person where surname = ? and age > ?",
  resultset -> {
    resultset.stream().
      map(Result::getProperty).
      forEach(System.out::println);
  },
  "Smith", 18);
```

'''

[[asyncquerymap]]
[[async-query-map]]
[discrete]
====== query( language, command, callback, parameterMap )

Executes a query in asynchronous way, with optional named parameter.
This method returns immediately.
This method only executes idempotent statements, namely `SELECT` and `MATCH`, that cannot change the database.
The execution of any other commands will throw a `IllegalArgumentException` exception.

Syntax:

```java
void query( String language, String command, AsyncResultsetCallback callback,
            Map<String, Object> parameterMap )
```

Where:

* **`language`** is the language used, which can be "sql", "sqlscript", "cypher", etc.
* **`command`** is the command to execute
* **`callback`** is the callback instance that will be invoked when the query is executed
* **`parameterMap`** Map string-value of named parameters

Example:

```java
database.async().query(
  "sql",
  "select name from Person where surname = :surname and age > :age",
  resultset -> {
    resultset.stream().
      map(Result::getProperty).
      forEach(System.out::println);
  },
  Map.of("surname", "Smith", "age", 18));
```

'''

[[asynccommandpos]]
[discrete]
====== command( language, command, callback, positionalParameters )

Executes any command in asynchronous way, with optional positional parameters and callback.
This method returns immediately.

Syntax:

```java
void command( String language, String command,
            AsyncResultsetCallback callback,
            Object... positionalParameters )
```

Where:
* **`language`** is the language used, which can be "sql", "sqlscript", "cypher", etc.
* **`command`** is the command to execute
* **`callback`** is the callback instance that will be invoked when the query is executed
* **`positionalParameters`** Optional, variable number of parameters to bind to the query

Example:

```java
database.async().command(
  "sql",
  "insert into Person(name, surname, age) values(?,?,?)",
  resultset -> {
    resultset.stream().
      map(Result::getProperty).
      forEach(System.out::println);
  },
  "Jay", "Miner", 12);
```

'''

[[asynccommandmap]]
[[async-command-map]]
[discrete]
====== command( language, command, callback, parameterMap )

Executes any command in asynchronous way, with optional parameters passed in map format.
This method returns immediately.
It takes named parameters. Each parameter name (in the SQL query) is prefixed by a semicolon (`:`).


Syntax:

```java
void command( String language, String command,
            AsyncResultsetCallback callback,
            Map<String, Object> parameterMap )
```

Where:
* **`language`** is the language used, which can be "sql", "sqlscript", "cypher", etc.
* **`command`** is the command to execute
* **`callback`** is the callback instance that will be invoked when the query is executed
* **`parameterMap`** Optional map of parameters to bind to the statement

Example:

```java
database.async().command(
  "sql",
  "insert into Person(name, surname, age) values(:name, :surname, :age)",
  resultset -> {
    resultset.stream().
      map(Result::getProperty).
      forEach(System.out::println);
  },
  Map.of("surname", "Smith", "age", 18, "name", "John"));
```

'''

[[async-transaction]]
[discrete]
====== transaction()

Executes a transaction in async mode. The transaction is executed in a separated thread. Example of use:

```java
database.async().transaction( database -> {
  // EXECUTE OPERATIONS WITHIN TRANSACTION ASYNCHRONOUSLY
  // I.E.: database.command("sql", "update client set bonus = true where type = 'gold' and bonus is null");
  // I.E.: database.command("sql", "insert into notification set type = 'bonus', status = 'waiting', date = sysdate() ");
});
```

'''

[[asynccreate]]
[discrete]
====== createRecord( record, callback )

Create a record in async way. Once the record is created in the database, the callback will be executed.
This method returns immediately.

Syntax:

```java
void createRecord( Record record, AsyncDocumentCallback callback )
```

Where:
* **`record`** is the pojo to persist in the database
* **`callback`** is the callback instance that will be invoked once the record has been created

Example:

```java
MutableDocument doc = database.newDocument( "Client" );
doc.set( "name", "Elon" );
doc.set( "surname", "Musk" );
doc.set( "status", "active" );

database.async().createRecord( doc, document -> {
  // DOCUMENT CREATED ASYNCHRONOUSLY
  System.out.println( "Async creation completed, record=" + document.getIdentity() );
});
```

'''

[[asyncupdate]]
[discrete]
====== updateRecord( record, callback )

Updates a record in async way. Once the record is updated in the database, the callback will be executed.
This method returns immediately.

Syntax:

```java
void updateRecord( Record record, AsyncDocumentCallback callback )
```

Where:
* **`record`** is the pojo to update in the database
* **`callback`** is the callback instance that will be invoked once the record has been updated

Example:

```java
database.async().update( document, document -> {
  // DOCUMENT UPDATED ASYNCHRONOUSLY
  System.out.println( "Async update completed, record=" + document.getIdentity() + " version=" + document.getVersion() );
});
```

'''

[[asyncdelete]]
[discrete]
====== deleteRecord( record, callback )

Deletes a record in async way. Once the record is deleted from the database, the callback will be executed.
This method returns immediately.

Syntax:

```java
void deleteRecord( Record record, AsyncResultCallback callback )
```

Where:
* **`record`** is the pojo to delete from the database
* **`callback`** is the callback instance that will be invoked once the record has been deleted

Example:

```java
database.async().deleteRecord( document, result -> {
  // DOCUMENT DELETED ASYNCHRONOUSLY
  System.out.println( "Async deletion completed, deleted=" + result.isDeleted() );
});
```
