<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<link rel="icon" type="image/x-icon" href="images/favicon.ico">
<title>ArcadeDB Manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>ArcadeDB Manual</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/arcadedb-logo.png" alt="arcadedb logo">
</div>
</div>
<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
<script>
    $(document).ready(function () {
       $('a').click(function(e) {
          $('title').text(e.target.text + " - ArcadeDB Manual");
          history.pushState({}, '', $(this).attr('href'));

      });
    });
</script>
<div class="paragraph">
<p>Documentation available also in PDF format: <a href="https://docs.arcadedb.com/ArcadeDB-manual.pdf">ArcadeDB-Manual.pdf</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jump_to_the_hot_topics">1. Jump to the Hot Topics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Skip the boring parts and check this out:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#Quick-Start-Docker">Run ArcadeDB with Open Beer demo database in 30 seconds</a></p>
</li>
<li>
<p>What is <a href="#Multi-Model">Multi-Model</a>?</p>
</li>
<li>
<p>ArcadeDB supports the following models:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#Graph-Model">Graph</a> (compatible with Gremlin and OrientDB SQL)</p>
</li>
<li>
<p><a href="#Document-Model">Document</a> (compatible with the MongoDB driver and MongoDB queries)</p>
</li>
<li>
<p><a href="#KeyValue-Model">Key/Value</a> (compatible with the Redis driver)</p>
</li>
<li>
<p><a href="#TimeSeries-Model">Time Series</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>ArcadeDB understands multiple languages:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL">SQL</a> (inspired from OrientDB SQL dialect that supports pattern matching on graphs)</p>
</li>
<li>
<p><a href="#Open-Cypher">Cypher</a></p>
</li>
<li>
<p><a href="#Gremlin-API">Apache Gremlin (Apache Tinkerpop v3.6.x)</a></p>
</li>
<li>
<p><a href="#MongoDB-API">MongoDB Query Language</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>ArcadeDB can be used as:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#Embedded-Server">Embedded</a> from any language on top of the Java Virtual Machine</p>
</li>
<li>
<p>Remotely by using <a href="#HTTP-API">HTTP/JSON</a></p>
</li>
<li>
<p>Remotely by using a <a href="#Postgres-Driver">Postgres driver</a> (ArcadeDB implements Postgres Wire protocol)</p>
</li>
<li>
<p>Remotely by using a <a href="#MongoDB-API">MongoDB driver</a> (only a subset of the operations are implemented)</p>
</li>
<li>
<p>Remotely by using a <a href="#Redis-API">Redis driver</a> (only a subset of the operations are implemented)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Getting started with ArcadeDB:</p>
<div class="ulist">
<ul>
<li>
<p>Tutorials: <a href="#Java-Tutorial">Java Tutorial</a></p>
</li>
<li>
<p>Tools: <a href="#Console-Tutorial">Working with the Console</a></p>
</li>
<li>
<p>Containers: <a href="#Docker">Docker</a>, <a href="#Kubernetes">Kubernetes</a></p>
</li>
<li>
<p>Migrating: <a href="#OrientDB">from OrientDB</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>ArcadeDB Links:</p>
<div class="ulist">
<ul>
<li>
<p>Project Website: <a href="https://arcadedb.com" class="bare">https://arcadedb.com</a></p>
</li>
<li>
<p>Source Repository: <a href="https://github.com/ArcadeData/arcadedb" class="bare">https://github.com/ArcadeData/arcadedb</a></p>
</li>
<li>
<p>Latest Release: <a href="https://github.com/ArcadeData/arcadedb/releases/latest">23.3.1</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Introduction">2. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_arcadedb">2.1. What is ArcadeDB?</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/introduction/what-is-arcadedb.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB is the new generation of DBMS that runs on pretty much every hardware/software configuration.
ArcadeDB is Multi-Model, that means it can work with graphs, documents and other forms of data.</p>
</div>
<h4 id="_how_can_it_be_so_fast" class="discrete">How can it be so fast?</h4>
<div class="paragraph">
<p>ArcadeDB is written in LLJ ("Low-Level-Java"), that means it&#8217;s written in Java (Java8+), but without using high-level API.
The result is that ArcadeDB does not allocate many objects at run-time on the Heap, so the Garbage Collection doesn&#8217;t do much.
At the same time, it&#8217;s still able to run on pretty much every sw/hw configuration and leverage of the hyper optimized Java Virtual Machine*.
Furthermore, the kernel is built to be efficient on multi-core CPUs by using novel Mechanical Sympathy techniques.</p>
</div>
<div class="paragraph">
<p>ArcadeDB is a Native Graph Database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No more Joins: relationships are physical links to the records</p>
</li>
<li>
<p>Traverses parts of or entire trees and graphs of records in milliseconds</p>
</li>
<li>
<p>Traversing speed is not affected by the database size</p>
</li>
</ul>
</div>
<h4 id="_cloud_dbms" class="discrete">Cloud DBMS</h4>
<div class="paragraph">
<p>ArcadeDB was born on the cloud.
Even though you can run ArcadeDB as embedded and in an on-premise setup, you can spin an ArcadeDB server/cluster in a few seconds with Docker, Kubernetes, Amazon AWS (coming soon) and Microsoft Azure consoles (coming soon).</p>
</div>
<h4 id="_is_arcadedb_free" class="discrete">Is ArcadeDB FREE?</h4>
<div class="paragraph">
<p>ArcadeDB Community Edition is really FREE for any purpose because released under Apache 2.0 license.
We love knowing about your project with ArcadeDB and any contributions back to the Open Community (reports, patches, test cases, documentations, etc) are welcome.</p>
</div>
<div class="paragraph">
<p>Which is more likely to have better quality?
A DBMS created and tested by a handful of developers or one tested by over 100,000 developers globally?
When code is public, everyone can scrutinize, test, report and resolve issues.
All things Open Source move faster compared to the proprietary world.</p>
</div>
</div>
<div class="sect2">
<h3 id="Multi-Model">2.2. Multi Model</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/introduction/multimodel.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>The ArcadeDB engine supports <strong>Graph</strong>, <strong>Document</strong>, <strong>Key/Value</strong>, and <strong>Time-Series</strong> models, so you can use ArcadeDB as a replacement for a product in any of these categories. However, the main reason why users choose ArcadeDB is because of its true <strong>Multi-Model</strong> DBMS abilities, which combine all the features of the four models into the core. These abilities are not just interfaces to the database engine, but rather the engine itself was built to support all four models. This is also the main difference to other multi-model DBMSs, as they implement an additional layer with an API, which mimics additional models. However, under the hood, they&#8217;re truly only one model, therefore they are limited in speed and scalability.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://arcadedb.com/assets/images/multi-model-small.png" alt="multi model small">
</div>
</div>
<div class="sect3">
<h4 id="Graph-Model">2.2.1. Graph Model</h4>
<div class="paragraph">
<p>A graph represents a network-like structure consisting of Vertices (also known as Nodes) interconnected by Edges (also known as Arcs). ArcadeDB&#8217;s graph model is represented by the concept of a property graph, which defines the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Vertex</strong> - an entity that can be linked with other Vertices and has the following mandatory properties:</p>
<div class="ulist">
<ul>
<li>
<p>unique identifier</p>
</li>
<li>
<p>set of incoming Edges</p>
</li>
<li>
<p>set of outgoing Edges</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Edge</strong> - an entity that links two Vertices and has the following mandatory properties:</p>
<div class="ulist">
<ul>
<li>
<p>unique identifier</p>
</li>
<li>
<p>link to an incoming Vertex (also known as head)</p>
</li>
<li>
<p>link to an outgoing Vertex (also known as tail)</p>
</li>
<li>
<p>label that defines the type of connection/relationship between head and tail vertex</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to mandatory properties, each vertex or edge can also hold a set of custom properties. These properties can be defined by users, which can make vertices and edges appear similar to documents. In the table below, you can find a comparison between the graph model, the relational data model, and the ArcadeDB graph model:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Relational Model</th>
<th class="tableblock halign-left valign-top">Graph Model</th>
<th class="tableblock halign-left valign-top">ArcadeDB Graph Model</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vertex and Edge Types</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Row</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vertex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vertex</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vertex and Edge property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vertex and Edge property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Edge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Edge</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Document-Model">2.2.2. Document Model</h4>
<div class="paragraph">
<p>The data in this model is stored inside documents. A document is a set of key/value pairs (also referred to as fields or properties), where the key allows access to its value. Values can hold primitive data types, embedded documents, or arrays of other values. Documents are not typically forced to have a schema, which can be advantageous, because they remain flexible and easy to modify. Documents are stored in collections, enabling developers to group data as they decide. ArcadeDB uses the concepts of "<a href="#Types">Types</a>" and "<a href="#Buckets">Buckets</a>" as its form of "collections" for grouping documents. This provides several benefits, which we will discuss in further sections of the documentation.</p>
</div>
<div class="paragraph">
<p>ArcadeDB&#8217;s Document model also adds the concept of a "<a href="#Relationships">Relationship</a>" between documents. With ArcadeDB, you can decide whether to embed documents or link to them directly. When you fetch a document, all the links are automatically resolved by ArcadeDB. This is a major difference to other Document Databases, like MongoDB or CouchDB, where the developer must handle any and all relationships between the documents herself.</p>
</div>
<div class="paragraph">
<p>The table below illustrates the comparison between the relational model, the document model, and the ArcadeDB document model:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Relational Model</th>
<th class="tableblock halign-left valign-top">Document Model</th>
<th class="tableblock halign-left valign-top">ArcadeDB Document Model</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Types">Type</a> or <a href="#Buckets">Bucket</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Row</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Document</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Document</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key/value pair</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Document property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not available</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Relationships">Relationship</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="KeyValue-Model">2.2.3. Key/Value Model</h4>
<div class="paragraph">
<p>This is the simplest model of the three. Everything in the database can be reached by a key, where the values can be simple and complex types. ArcadeDB supports Documents and Graph Elements as values allowing for a richer model, than what you would normally find in the typical Key/Value model. The usual Key/Value model provides "buckets" to group key/value pairs in different containers. The most typical use cases of the Key/Value Model are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>POST the value as payload of the HTTP call &#8594; <code>/&lt;bucket&gt;/&lt;key&gt;</code></p>
</li>
<li>
<p>GET the value as payload from the HTTP call &#8594; <code>/&lt;bucket&gt;/&lt;key&gt;</code></p>
</li>
<li>
<p>DELETE the value by Key, by calling the HTTP call &#8594; <code>/&lt;bucket&gt;/&lt;key&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The table below illustrates the comparison between the relational model, the Key/Value model, and the ArcadeDB Key/Value model:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Relational Model</th>
<th class="tableblock halign-left valign-top">Key/Value Model</th>
<th class="tableblock halign-left valign-top">ArcadeDB Key/Value Model</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bucket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Buckets">Bucket</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Row</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key/Value pair</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Document</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not available</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Document field or Vertex/Edge property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not available</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Relationships">Relationship</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="TimeSeries-Model">2.2.4. Time-Series Model</h4>
<div class="paragraph">
<p>Coming Soon.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_run_arcadedb">2.3. Run ArcadeDB</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/introduction/run.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>You can run ArcadeDB in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On the cloud (coming soon), by using ArcadeDB instance on Amazon AWS, Microsoft Azure and Google Cloud Engine marketplaces</p>
</li>
<li>
<p>On-premise, on your servers, any OS is good. You can run with Docker, Kubernetes or by just run the server script.</p>
</li>
<li>
<p>Embedded, if you develop with a language that runs on the JVM (Java* Virtual Machine)*</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To reach the best performance, use ArcadeDB in embedded mode to reach 2 Million insertions per second on common hardware.
If you need to scale up with the queries, run a HA configuration with at least 3 servers, with a load balancer in front.
Run ArcadeDB with Kubernetes to have an automatic setup of servers in HA with a load balancer upfront.</p>
</div>
<h4 id="_embedded" class="discrete">Embedded</h4>
<div class="paragraph">
<p>This mode is possible only if your application is running in a JVM* (Java* Virtual Machine).
In this configuration ArcadeDB runs in the same JVM of your application.
In this way you completely avoid the client/server communication cost (TCP/IP, marshalling/unmarshalling, etc.)
If the JVM that hosts your application crashes, then also ArcadeDB crashes, but don&#8217;t worry, ArcadeDB uses a WAL to recover partially committed transactions.
Your data is safe.</p>
</div>
<h4 id="_client_server" class="discrete">Client-Server</h4>
<div class="paragraph">
<p>This is the classic way people use a DBMS, like with Relational Databases.
The ArcadeDB server exposes <a href="#HTTP-API">HTTP/JSON API</a>, so you can connect to ArcadeDB from any language without even using drivers.
Take a look at the <a href="#Drivers">driver</a> chapter for more information.</p>
</div>
<h4 id="_high_availability_ha" class="discrete">High Availability (HA)</h4>
<div class="paragraph">
<p>You can spin up as many ArcadeDB servers you want to have a HA setup and scale up with queries that can be executed on any servers.
ArcadeDB uses a RAFT based election system to guarantee the consistency of the database.
For more information look at <a href="#High-Availability">High Availability</a>.</p>
</div>
<h4 id="_binaries" class="discrete">Binaries</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"><strong>Linux</strong> / <strong>Mac</strong></th>
<th class="tableblock halign-left valign-top"><strong>Windows</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_server">Server</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bin/server.sh</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bin/server.bat</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Console">Console</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bin/console.sh</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bin/console.bat</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Concepts">3. Main Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/concepts/basics.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="sect2">
<h3 id="_record">3.1. Record</h3>
<div class="paragraph">
<p>A record is the smallest unit you can load from and store in the database.
Records come in three types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Document</p>
</li>
<li>
<p>Vertex</p>
</li>
<li>
<p>Edge</p>
</li>
</ul>
</div>
<h4 id="_document" class="discrete">Document</h4>
<div class="paragraph">
<p>Documents are softly typed and are defined by schema types, but you can also use them in a schema-less mode too.
Documents handle fields in a flexible manner.
You can easily import and export them in JSON format.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "name":"Jay",
  "surname":"Miner",
  "job":"Developer",
  "creations":[{
    "name":"Amiga 1000",
    "company":"Commodore Inc."
  },{
    "name":"Amiga 500",
    "company":"Commodore Inc."
  }]
}</code></pre>
</div>
</div>
<h4 id="_vertex" class="discrete">Vertex</h4>
<div class="paragraph">
<p>In Graph databases the vertices (also named vertexes), or nodes represent the main entity that holds the information.
It can be a Patient, a Company or a Product.
Vertices are themselves documents with some additional features.
This means they can contain embedded records and arbitrary properties exactly like documents.
Vertices are connected with other vertices through Edges.</p>
</div>
<h4 id="_edge" class="discrete">Edge</h4>
<div class="paragraph">
<p>An Edge, or Arc, is the connection between two vertices.
Edges can be unidirectional and bidirectional.
One edge can only connect two vertices.</p>
</div>
<div class="paragraph">
<p>For more information on connecting vertices in general, see <a href="#Relationships">Relationships</a> below.</p>
</div>
<h4 id="RID" class="discrete">Record ID</h4>
<div class="paragraph">
<p>When ArcadeDB generates a record, it auto-assigns a unique identifier called a Record ID, RID for short.
The syntax for the RID is the pound sign with the bucket identifier, colon, and the position like so:</p>
</div>
<div class="paragraph">
<p><code>#&lt;bucket-identifier&gt;:&lt;record-position&gt;</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>bucket-identifier</strong>: This number indicates the bucket id to which the record belongs.
Positive numbers in the bucket identifier indicate persistent records.
You can have up to 2,147,483,648 buckets in a database.</p>
</li>
<li>
<p><strong>record-position</strong>: This number defines the absolute position of the record in the bucket.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>#-1:-1</code> is a null RID.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The prefix character <code>#</code> is mandatory.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each Record ID is immutable, universal, and is never reused.
Additionally, records can be accessed directly through their RIDs at&#160;O(1)&#160;complexity which means the query speed is constant, unaffected by database size.
For this reason, you don&#8217;t need to create a field to serve as the primary key as you do in Relational databases.</p>
</div>
</div>
<div class="sect2">
<h3 id="Types">3.2. Types</h3>
<div class="paragraph">
<p>The concept of the Type is taken from the <a href="http://en.wikipedia.org/wiki/Object-oriented_programming">Object Oriented Programming</a> paradigm, sometimes as 'Class'.
In ArcadeDB, types define records.
It is closest to the concept of a 'Table' in Relational databases and a 'Class' in an Object Database.</p>
</div>
<div class="paragraph">
<p>Types can be schema-less, schema-full, or a mix.
They can inherit from other types, creating a tree of types. <a href="http://en.wikipedia.org/wiki/Inheritance_%28object-oriented_programming%29">Inheritance</a>, in this context, means that a subtype extends a parent type, inheriting all of its attributes.
Practically, this is done by <a href="#SQL-Create-Type">extending a type</a> or <a href="#SQL-Alter-Type">setting a super-type</a>.</p>
</div>
<div class="paragraph">
<p>Each type has its own <a href="#Buckets">buckets (data files)</a>.
A type can support multiple buckets.
When you execute a query against a type, it automatically fetches from all the buckets that are part of the type.
When you create a new record, ArcadeDB selects the bucket to store it in using a <a href="#Bucket-Selection">configurable strategy</a>.</p>
</div>
<div class="paragraph">
<p>As a default, ArcadeDB creates as many buckets per type as many cores (processors) the host machine has.
In this, CRUD operations can go full speed in parallel with zero contention between CPUs and/or COREs.
Having many buckets per type means having more files at file system level.
Check if your Operative System has any limitation with the number of files supported and opened at the same time (<code>ulimit</code> for Unix-like systems).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can query the defined types by executing the following SQL query: <code>select from schema:types</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Buckets">3.3. Buckets</h3>
<div class="paragraph">
<p>Where types provide you with a logical framework for organizing data, buckets provide physical or in-memory space in which ArcadeDB actually stores the data.
Each bucket is one file at file system level.
It is comparable to the "collection" in Document databases, the "table" in Relational databases and the "cluster" in OrientDB.
You can have up to 2,147,483,648 buckets in a database.</p>
</div>
<div class="paragraph">
<p>A bucket can only be part of one type. This means two types can not share the same bucket.</p>
</div>
<div class="paragraph">
<p>When you create a new type, the <a href="#SQL-Create-Type"><code>CREATE TYPE</code></a> statement automatically creates the physical buckets (files) that serve as the default location in which to store data for that type.
ArcadeDB forms the bucket names by using the type name + underscore + a sequential number starting from 0. For example, the first bucket for the type <code>Beer</code> will be <code>Beer_0</code> and the correspondent file in the file system will be <code>Beer_0.31.65536.bucket</code>.
ArcadeDB creates additional buckets for each type, (one for each CPU core on the server), to improve performance of parallelism.</p>
</div>
<h4 id="_types_vs_buckets_in_queries" class="discrete">Types vs. Buckets in Queries</h4>
<div class="paragraph">
<p>The combination of types and buckets is very powerful and has a number of use cases.
In most case, you can work with Types and you will be fine.
But if you are able to split your database into multiple buckets, you could address a specific bucket based instead of the entire Type.
By wisely using the buckets to divide your database in a way that help you with the retrieval means zero or less use of indexes.
Indexes slow down insertion and take space on disk and RAM.
In most cases you need indexes to speed up your queries, but in some use cases you could totally or partially avoid using indexes and still having good performance on queries.</p>
</div>
<h4 id="_one_bucket_per_period" class="discrete">One bucket per period</h4>
<div class="paragraph">
<p>Consider an example where you create a type <code>Invoice</code>, with one bucket per year. <code>Invoice_2015</code> and <code>Invoice_2016</code>.
You can query all invoices using the type as a target with the <a href="#SQL-Select"><code>SELECT</code></a> statement.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">arcadeDB&gt; SELECT FROM Invoice</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to this, you can filter the result set by the year.
The type <code>Invoice</code> includes a <code>year</code> field, you can filter it through the <a href="#Filtering"><code>WHERE</code></a> clause.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">arcadeDB&gt; SELECT FROM Invoice WHERE year = 2016</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also query specific records from a single bucket.
By splitting the type <code>Invoice</code> across multiple buckets, (that is, one per year in our example), you can optimize the query by narrowing the potential result set.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">arcadeDB&gt; SELECT FROM BUCKET:Invoice_2016</code></pre>
</div>
</div>
<div class="paragraph">
<p>By using the explicit bucket instead of the logical type, this query runs significantly faster, because ArcadeDB can narrow the search to the targeted bucket.
No index is needed on the year, because all the invoices for year 2016 will be stored in the bucket <code>Invoice_2016</code> by the application.</p>
</div>
<h4 id="_one_bucket_per_location" class="discrete">One bucket per location</h4>
<div class="paragraph">
<p>Like with the example above, we could split our records by location creating one bucket per location.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE BUCKET Customer_Europe
CREATE BUCKET Customer_Americas
CREATE BUCKET Customer_Asia
CREATE BUCKET Customer_Other

CREATE VERTEX TYPE Customer BUCKET Customer_Europe,Customer_Americas,Customer_Asia,Customer_Other</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we are using the graph model by creating a vertex type, but it&#8217;s the same with documents.
Use <a href="#SQL-Create-Type"><code>CREATE DOCUMENT TYPE</code></a> instead.</p>
</div>
<div class="paragraph">
<p>Now in your application store the vertices or documents in the right bucket, based on the location of such customer.
You can use any API and set the bucket.
If you&#8217;re using SQL, this is the way you can insert a new Customer into a specific bucket.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">arcadeDB&gt; INSERT INTO BUCKET:Customer_Europe CONTENT { firstName: 'Enzo', lastName: 'Ferrari' }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since a bucket can only be part of one type, when you use the bucket notation with SQL, the type is inferred from the bucket, "Customer" in this case.</p>
</div>
<div class="paragraph">
<p>When you&#8217;re looking for customers based in Europe, you could execute this query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">arcadeDB&gt; SELECT FROM BUCKET:Customer_Europe</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can go even more specific by creating a bucket per country, not just for continent, and query from that bucket.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE BUCKET 'Customer_Europe_Italy'
CREATE BUCKET 'Customer_Europe_Spain'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now get all the customers that live in Italy.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">arcadeDB&gt; SELECT FROM BUCKET:Customer_Europe_Italy</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify a list of buckets in your query.
This is the query to retrieve both Italian and Spanish customers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">arcadeDB&gt; SELECT FROM BUCKET:[Customer_Europe_Italy,Customer_Europe_Spain]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Relationships">3.4. Relationships</h3>
<div class="paragraph">
<p>ArcadeDB supports two kinds of relationships: <strong>referenced</strong> and <strong>embedded</strong>.
It can manage relationships in a schema-full or schema-less scenario.</p>
</div>
<h4 id="_referenced_relationships" class="discrete">Referenced Relationships</h4>
<div class="paragraph">
<p>In Relational databases, tables are linked through <code>JOIN</code> commands, which can prove costly on computing resources.
ArcadeDB manages relationships natively without computing `JOIN&#8217;s by storing direct links to the target objects of the relationship. This boosts the load speed for the entire graph of connected objects, such as in Graph and Object database systems.</p>
</div>
<div class="paragraph">
<p>Example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>    Record A -------------&gt; Record B
 TYPE=Customer            TYPE=Invoice
    RID #5:23               RID #10:2</code></pre>
</div>
</div>
<h4 id="_embedded_relationships" class="discrete">Embedded Relationships</h4>
<div class="paragraph">
<p>When using Embedded relationships, ArcadeDB stores the relationship within the record that embeds it.
These relationships are stronger than Reference relationships.
You can represent it as a <a href="http://en.wikipedia.org/wiki/Class_diagram#Composition">UML Composition relationship</a>.</p>
</div>
<div class="paragraph">
<p>Embedded records do not have their own <a href="#RID">RID</a>, given that you can&#8217;t directly reference it through other records.
It is only accessible through the container record.</p>
</div>
<div class="paragraph">
<p>In the event that you delete the container record, the embedded record is also deleted.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>    Record A &lt;&gt;----------&gt; Record B
   TYPE=Account          TYPE=Address
    RID #5:23               NO RID</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here,record <code>A</code> contains the entirety of record <code>B</code> in the property <code>address</code>.
You can reach record <code>B</code> only by traversing the container record.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>arcadeDB&gt; SELECT FROM Account WHERE address.city = 'Rome'</code></pre>
</div>
</div>
<h4 id="_11_and_n1_embedded_relationships" class="discrete">1:1 and n:1 Embedded Relationships</h4>
<div class="paragraph">
<p>ArcadeDB expresses relationships of these kinds using the <code>EMBEDDED</code> type.</p>
</div>
<h4 id="_1n_and_nn_embedded_relationships" class="discrete">1:n and n:n Embedded Relationships</h4>
<div class="paragraph">
<p>ArcadeDB expresses relationships of these kinds using a list or a map of links, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LIST</code> An ordered list of records.</p>
</li>
<li>
<p><code>MAP</code> An ordered map of records as the value and a string as the key, it doesn&#8217;t accept duplicate keys.</p>
</li>
</ul>
</div>
<h4 id="_inverse_relationships" class="discrete">Inverse Relationships</h4>
<div class="paragraph">
<p>In ArcadeDB, all Edges in the Graph model are bidirectional.
This differs from the Document model, where relationships are always unidirectional, requiring the developer to maintain data integrity.
In addition, ArcadeDB automatically maintains the consistency of all bidirectional relationships.</p>
</div>
</div>
<div class="sect2">
<h3 id="_database">3.5. Database</h3>
<div class="paragraph">
<p>Each server or Java VM can handle multiple database instances, but the database name must be unique.</p>
</div>
<h4 id="Database-URL" class="discrete">Database URL</h4>
<div class="paragraph">
<p>ArcadeDB uses its own <a href="http://en.wikipedia.org/wiki/Uniform_Resource_Locator">URL</a> format, of engine and database name as <code>&lt;engine&gt;:&lt;db-name&gt;</code>.
The embedded engine is the default and can be omitted.
To open a database on the local file system you can use directly the path as URL.</p>
</div>
<h4 id="_database_usage" class="discrete">Database Usage</h4>
<div class="paragraph">
<p>You must always close the database once you finish working on it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
ArcadeDB automatically closes all opened databases, when the process dies gracefully (not by killing it by force).
This is assured if the Operating System allows a graceful shutdown.
For example, on Unix/Linux systems using <code>SIGTERM</code>, or in Docker <code>exit code 143</code> instead of <code>SIGKILL</code>, or in Docker <code>exit code 137</code>.)
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Transactions">3.6. Transactions</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/concepts/transactions.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>A transaction comprises a unit of work performed within a database management system (or similar system) against a database, and treated in a coherent and reliable way independent of other transactions.
Transactions in a database environment have two main purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>to provide reliable units of work that allow correct recovery from failures and keep a database consistent even in cases of system failure, when execution stops (completely or partially) and many operations upon a database remain uncompleted, with unclear status</p>
</li>
<li>
<p>to provide isolation between programs accessing a database concurrently.
If this isolation is not provided, the program&#8217;s outcome are possibly erroneous.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A database transaction, by definition, must be <a href="#Atomicity">atomic</a>, <a href="#Consistency">consistent</a>, <a href="#Isolation">isolated</a> and <a href="#Durability">durable</a>.
Database practitioners often refer to these properties of database transactions using the acronym <a href="#ACID-Properties">ACID</a>).
- <a href="http://en.wikipedia.org/wiki/Database_transaction">Wikipedia</a></p>
</div>
<div class="paragraph">
<p>ArcadeDB is an <a href="#ACID-Properties">ACID</a> compliant DBMS.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
ArcadeDB keeps the transaction on client RAM, so the transaction size is affected by the available RAM (Heap memory) on JVM.
For transactions involving many records, consider to split it in multiple transactions.
</td>
</tr>
</table>
</div>
<h4 id="ACID-Properties" class="discrete">ACID Properties</h4>
<h4 id="Atomicity" class="discrete">Atomicity</h4>
<div class="paragraph">
<p>"Atomicity requires that each transaction is 'all or nothing': if one part of the transaction fails, the entire transaction fails, and the database state is left unchanged.
An atomic system must guarantee atomicity in each and every situation, including power failures, errors, and crashes.
To the outside world, a committed transaction appears (by its effects on the database) to be indivisible ("atomic"), and an aborted transaction does not happen." - <a href="https://en.wikipedia.org/wiki/ACID#Atomicity">Wikipedia</a></p>
</div>
<h4 id="Consistency" class="discrete">Consistency</h4>
<div class="paragraph">
<p>"The consistency property ensures that any transaction will bring the database from one valid state to another.
Any data written to the database must be valid according to all defined rules, including but not limited to constraints, cascades, triggers, and any combination thereof.
This does not guarantee correctness of the transaction in all ways the application programmer might have wanted (that is the responsibility of application-level code) but merely that any programming errors do not violate any defined rules." - <a href="http://en.wikipedia.org/wiki/ACID#Consistency_(Correctness)">Wikipedia</a></p>
</div>
<div class="paragraph">
<p>ArcadeDB uses the <a href="http://en.wikipedia.org/wiki/Multiversion_concurrency_control">MVCC</a> to assure consistency by versioning the page where the record are stored.</p>
</div>
<div class="paragraph">
<p>Look at this example:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Sequence</th>
<th class="tableblock halign-left valign-top">Client/Thread 1</th>
<th class="tableblock halign-left valign-top">Client/Thread 2</th>
<th class="tableblock halign-left valign-top">Version of page containing record X</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Begin of Transaction</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read(x)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Begin of Transaction</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read(x)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">write(x)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">commit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 &#8594; 11</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">write(x)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">commit</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 &#8594; 11 = Error, in database x already is at 11</p></td>
</tr>
</tbody>
</table>
<h4 id="Isolation" class="discrete">Isolation</h4>
<div class="paragraph">
<p>"The isolation property ensures that the concurrent execution of transactions results in a system state that would be obtained if transactions were executed serially, i.e. one after the other.
Providing isolation is the main goal of concurrency control.
Depending on concurrency control method, the effects of an incomplete transaction might not even be visible to another transaction." - <a href="https://en.wikipedia.org/wiki/ACID#Isolation">Wikipedia</a></p>
</div>
<div class="paragraph">
<p>The SQL standard defines the following phenomena which are prohibited at various levels are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Dirty Read</strong>: a transaction reads data written by a concurrent uncommitted transaction. This is never possible with ArcadeDB.</p>
</li>
<li>
<p><strong>Non Repeatable Read</strong>: a transaction re-reads data it has previously read and finds that data has been modified by another transaction (that committed since the initial read).</p>
</li>
<li>
<p><strong>Phantom Read</strong>: a transaction re-executes a query returning a set of rows that satisfy a search condition and finds that the set of rows satisfying the condition has changed due to another recently-committed transaction. This happens also when records are deleted or inserted during the transaction and they could become visible during the transaction.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The SQL standard transaction isolation levels are described in the table below:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Isolation Level</th>
<th class="tableblock halign-left valign-top">Dirty Read</th>
<th class="tableblock halign-left valign-top">Non repeatable Read</th>
<th class="tableblock halign-left valign-top">Phantom Read</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>READ_COMMITTED</code> (default)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not possible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Possible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Possible</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REPEATABLE_READ</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not possible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not possible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Possible</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The SQL <code>SERIALIZABLE</code> level is not supported by ArcadeDB.</p>
</div>
<div class="paragraph">
<p>Using <code>remote</code> access all the commands are executed on the server, so out of transaction scope.
Look below for more information.</p>
</div>
<div class="paragraph">
<p>Look at these examples:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Sequence</th>
<th class="tableblock halign-left valign-top">Client/Thread 1</th>
<th class="tableblock halign-left valign-top">Client/Thread 2</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Begin of Transaction</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read(x)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Begin of Transaction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read(x)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">write(x)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">commit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read(x)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">commit</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>At operation 7 the client 1 continues to read the same version of x read in operation 2.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Sequence</th>
<th class="tableblock halign-left valign-top">Client/Thread 1</th>
<th class="tableblock halign-left valign-top">Client/Thread 2</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Begin of Transaction</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read(x)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Begin of Transaction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read(y)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">write(y)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">commit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read(y)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">commit</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>At operation 7 the client 1 reads the version of y which was written at operation 6 by client 2. This is because it never reads y before.</p>
</div>
<h4 id="Durability" class="discrete">Durability</h4>
<div class="paragraph">
<p>"Durability means that once a transaction has been committed, it will remain so, even in the event of power loss, crashes, or errors.
In a relational database, for instance, once a group of SQL statements execute, the results need to be stored permanently (even if the database crashes immediately thereafter).
To defend against power loss, transactions (or their effects) must be recorded in a non-volatile memory." - <a href="https://en.wikipedia.org/wiki/ACID#Durability">Wikipedia</a></p>
</div>
<h5 id="_fail_over" class="discrete">Fail-over</h5>
<div class="paragraph">
<p>An ArcadeDB instance can fail for several reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HW problems, such as loss of power or disk error</p>
</li>
<li>
<p>SW problems, such as a Operating System crash</p>
</li>
<li>
<p>Application problem, such as a bug that crashes your application that is connected to the ArcadeDB engine.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use the ArcadeDB engine directly in the same process of your application.
This gives superior performance due to the lack of inter-process communication.
In this case, should your application crash (for any reason), the ArcadeDB Engine also crashes.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using an ArcadeDB Server connected remotely, if your application crashes the engine continue to work, but any pending transaction owned by the client will be rolled back.</p>
</div>
<h5 id="_auto_recovery" class="discrete">Auto-recovery</h5>
<div class="paragraph">
<p>At start-up the ArcadeDB Engine checks to if it is restarting from a crash.
In this case, the auto-recovery phase starts which rolls back all pending transactions.</p>
</div>
<div class="paragraph">
<p>ArcadeDB has different levels of durability based on storage type, configuration and settings.</p>
</div>
<h4 id="_optimistic_transaction" class="discrete">Optimistic Transaction</h4>
<div class="paragraph">
<p>This mode uses the well known Multi Version Control System <a href="http://en.wikipedia.org/wiki/Multiversion_concurrency_control">MVCC</a> by allowing multiple reads and writes on the same records.
The integrity check is made on commit.
If the record has been saved by another transaction in the interim, then an <code>OConcurrentModificationException</code> will be thrown.
The application can choose either to repeat the transaction or abort it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
ArcadeDB keeps the whole transaction on client&#8217;s RAM, so the transaction size is affected by the available RAM (Heap) memory on JVM.
For transactions involving many records, consider to split it in multiple transactions.
</td>
</tr>
</table>
</div>
<h4 id="_nested_transactions_and_propagation" class="discrete">Nested transactions and propagation</h4>
<div class="paragraph">
<p>ArcadeDB does support nested transaction.
If further <code>begin()</code> are called after a transaction is already begun, then the new transaction is the current one until commit or rollback.
When the nested transaction is completed, the previous transaction becomes the current transaction.</p>
</div>
</div>
<div class="sect2">
<h3 id="Inheritance">3.7. Inheritance</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/concepts/inheritance.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Unlike many Object-relational mapping tools, ArcadeDB does not split documents between different types.
Each document resides in one or a number of buckets associated with its specific type.
When you execute a query against a type that has subtypes, ArcadeDB searches the buckets of the target type and all subtypes.</p>
</div>
<h4 id="_declaring_inheritance_in_schema" class="discrete">Declaring Inheritance in Schema</h4>
<div class="paragraph">
<p>In developing your application, bear in mind that ArcadeDB needs to know the type inheritance relationship.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DocumentType account = database.getSchema().createDocumentType("Account");
DocumentType company = database.getSchema().createDocumentType("Company").addParent(account);</code></pre>
</div>
</div>
<h4 id="_using_polymorphic_queries" class="discrete">Using Polymorphic Queries</h4>
<div class="paragraph">
<p>By default, ArcadeDB treats all queries as polymorphic.
Using the example above, you can run the following query from the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Account WHERE name.toUpperCase() = 'GOOGLE'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query returns all instances of the types <code>Account</code> and <code>Company</code> that have a property name that matches <code>Google</code>.</p>
</div>
<h4 id="_how_inheritance_works" class="discrete">How Inheritance Works</h4>
<div class="paragraph">
<p>Consider an example, where you have three types, listed here with the bucket identifier in the parentheses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Account(10) &lt;|--- Company (13) &lt;|--- OrientTechnologiesGroup (27)</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, ArcadeDB creates a separate bucket for each type.
It indicates this bucket by the <code>defaultBucketId</code> property in the type <code>OType</code> and indicates the bucket used by default when not specified.
However, the type <code>OType</code> has a property <code>bucketIds</code>, (as <code>int[]</code>), that contains all the buckets able to contain the records of that type.  <code>bucketIds</code> and <code>defaultBucketId</code> are the same by default.</p>
</div>
<div class="paragraph">
<p>When you execute a query against a type, ArcadeDB limits the result-sets to only the records of the buckets contained in the <code>bucketIds</code> property.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Account WHERE name.toUpperCase() = 'GOOGLE'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query returns all the records with the name property set to <code>GOOGLE</code> from all three types, given that the base type <code>Account</code> was specified.
For the type <code>Account</code>, ArcadeDB searches inside the buckets <code>10</code>, <code>13</code> and <code>27</code>, following the inheritance specified in the schema.</p>
</div>
</div>
<div class="sect2">
<h3 id="Indexes">3.8. Indexes</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/concepts/indexes.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB indexes are built by using the LSM Tree algorithm.</p>
</div>
<div class="sect3">
<h4 id="_lsm_tree_algorithm">3.8.1. LSM Tree algorithm</h4>
<div class="paragraph">
<p>LSM tree is a type of data structure that is used to store and retrieve data efficiently.
It works by organizing data in a tree-like structure, where each node in the tree represents a certain range of data.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s how it works:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When you want to store a piece of data in the LSM tree, it first goes into a special part of the tree called a "write buffer." The write buffer is like a temporary storage area where new data is kept until it&#8217;s ready to be added to the tree.</p>
</li>
<li>
<p>When the write buffer gets full, the LSM tree will "flush" the data from the write buffer into the main part of the tree.
This is done by creating a new node in the tree and adding the data from the write buffer to it.</p>
</li>
<li>
<p>As more and more data is added to the tree, it will eventually become too large to be stored in memory (this is known as "overflowing").
When this happens, the LSM tree will start to "compact" the data by moving some of it to disk storage.
This allows the tree to continue growing without running out of memory.</p>
</li>
<li>
<p>When you want to retrieve a piece of data from the LSM tree, the algorithm will search for it in the write buffer, the main part of the tree, and any data that has been compacted to disk storage.
If the data is found, it will be returned to you</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_lsm_tree_vs_btree">3.8.2. LSM Tree vs B+Tree</h4>
<div class="paragraph">
<p>B+Tree is the most common algorithm used by Relational DBMSs. What are the differences?</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>LSM tree and B+ tree are both data structures that are commonly used to store and retrieve data efficiently. Here are some of the main advantages of LSM tree over B+ tree:</p>
</li>
<li>
<p>LSM tree is more efficient for writes: LSM tree uses a write buffer to temporarily store new data, which allows it to batch writes and reduce the number of disk accesses required. This can make it faster than B+ tree for inserting large amounts of data.</p>
</li>
<li>
<p>LSM tree is more efficient for compaction: Because LSM tree stores data in a sorted fashion, it can compact data more efficiently by simply merging sorted data sets. B+ tree, on the other hand, requires more complex rebalancing operations when compacting data.</p>
</li>
<li>
<p>LSM tree is more space-efficient: LSM tree stores data in a compact, sorted format, which can make it more space-efficient than B+ tree. This can be especially useful when storing large amounts of data on disk.</p>
</li>
<li>
<p>However, there are also some potential disadvantages of LSM tree compared to B+ tree. For example, B+ tree may be faster for queries that require range scans or random access, and it may be easier to implement in some cases.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you&#8217;re interested to ArcadeDB&#8217;s LSM-Tree index implementation detail, look at <a href="#LSM-Tree">LSM-Tree</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Server">4. Server</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">4.1. Server</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/server/server.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>To start ArcadeDB as a server run the script <code>server.sh</code> under the <code>bin</code> directory of ArcadeDB distribution. If you&#8217;re using MS Windows OS, replace <code>server.sh</code> with <code>server.bat</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ bin/server.sh

 █████╗ ██████╗  ██████╗ █████╗ ██████╗ ███████╗██████╗ ██████╗
██╔══██╗██╔══██╗██╔════╝██╔══██╗██╔══██╗██╔════╝██╔══██╗██╔══██╗
███████║██████╔╝██║     ███████║██║  ██║█████╗  ██║  ██║██████╔╝
██╔══██║██╔══██╗██║     ██╔══██║██║  ██║██╔══╝  ██║  ██║██╔══██╗
██║  ██║██║  ██║╚██████╗██║  ██║██████╔╝███████╗██████╔╝██████╔╝
╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝╚═╝  ╚═╝╚═════╝ ╚══════╝╚═════╝ ╚═════╝
PLAY WITH DATA                                    arcadedb.com

INFO  [ArcadeDBServer]  ArcadeDB Server v21.9.1 (build 258eb/163044331/main) is starting up...
INFO  [ArcadeDBServer]  Starting ArcadeDB Server with plugins [] ...
INFO  [ArcadeDBServer]  - JMX Metrics Started...

+--------------------------------------------------------------------+
|                WARNING: FIRST RUN CONFIGURATION                    |
+--------------------------------------------------------------------+
| This is the first time the server is running. Please type a        |
| password of your choice for the 'root' user or leave it blank      |
| to auto-generate it.                                               |
|                                                                    |
| To avoid this message set the environment variable or JVM          |
| setting `arcadedb.server.rootPassword` to the root password to use.|
+--------------------------------------------------------------------+

Root password [BLANK=auto generate it]: *</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first time the server is running, the root password must be inserted and confirmed.
The hash (+salt) of the inserted password will be stored in the file <code>config/security.json</code>. To know more about this topic, look at <a href="#Security">Security</a>.
Delete this file and restart the server to reinsert the password for server&#8217;s root user.</p>
</div>
<div class="paragraph">
<p>The default rule of security are pretty basic.
The password length must be between 8 and 256 characters.
You can implement your own security policy.
Check <a href="#Security-Policy">Security Policy</a>.</p>
</div>
<div class="paragraph">
<p>You can skip the request for the password by passing it as a setting.
Example:</p>
</div>
<div class="paragraph">
<p><code>-Darcadedb.server.rootPassword=this_is_a_password</code></p>
</div>
<div class="paragraph">
<p>Once inserted the password for the root user, you should see this output.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Root password [BLANK=auto generate it]: ***********
*Please type the root password for confirmation (copy and paste will not work): ***********

INFO  [HttpServer] &lt;ArcadeDB_0&gt; - Starting HTTP Server (host=0.0.0.0 port=2480)...
INFO  [undertow] starting server: Undertow - 2.2.10.Final
INFO  [xnio] XNIO version 3.8.4.Final
INFO  [nio] XNIO NIO Implementation Version 3.8.4.Final
INFO  [threads] JBoss Threads version 3.1.0.Final
INFO  [HttpServer] &lt;ArcadeDB_0&gt; - HTTP Server started (host=0.0.0.0 port=2480)
INFO  [ArcadeDBServer] &lt;ArcadeDB_0&gt; ArcadeDB Server started (CPUs=16 MAXRAM=2.00GB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the following components start with the server:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JMX Metrics, to monitor server performance and statistics</p>
</li>
<li>
<p>HTTP Server, that listens on port 2480 by default. if 2480 is already occupied, then the next is taken up to 2489.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the output above, the name <code>ArcadeDB_0</code> is the server name.
By default, <code>ArcadeDB_0</code> is used.
To specify a different name define it with the setting <a href="#Settings"><code>server.name</code></a>, example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ bin/server.sh -Darcadedb.server.name=ArcadeDB_Europe_0</code></pre>
</div>
</div>
<div class="paragraph">
<p>In HA configuration, it&#8217;s mandatory all the servers in cluster have different names.</p>
</div>
<div class="sect3">
<h4 id="_start_server_hint">4.1.1. Start server hint</h4>
<div class="paragraph">
<p>To start the server from a location different than the ArcadeDB folder,
for example, if starting the server as a service,
set the environment variable <code>ARCADEDB_HOME</code> to the ArcadeDB folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">export ARCADEDB_HOME=/path/to/arcadedb</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_server_modes">4.1.2. Server modes</h4>
<div class="paragraph">
<p>The server can be started in one of three modes, which affect the studio and logging:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mode</th>
<th class="tableblock halign-left valign-top">Studio</th>
<th class="tableblock halign-left valign-top">Logging</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>development</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Detailed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brief</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>production</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brief</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The mode is controlled by the <a href="#Setting-Table"><code>server.mode</code></a> setting with a default mode <code>development</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_default_databases">4.1.3. Create default database(s)</h4>
<div class="paragraph">
<p>Instead of starting a server and then connect to it to create the default databases, ArcadeDB Server takes an initial default databases list by using the setting <a href="#Settings"><code>server.defaultDatabases</code></a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ bin/server.sh "-Darcadedb.server.defaultDatabases=Universe[elon:musk]"</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the example above the database "Universe" will be created if doesn&#8217;t exist, with user "elon", password "musk".</p>
</div>
<div class="paragraph">
<p>Once the server is started, multiple clients can be connected to the server by using one of the supported protocols:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#HTTP-API">HTTP/JSON</a></p>
</li>
<li>
<p><a href="#Postgres-Driver">Postgres Driver</a></p>
</li>
<li>
<p><a href="#MongoDB-API">MongoDB Driver</a></p>
</li>
<li>
<p><a href="#Redis-API">Redis Driver</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_logging">4.1.4. Logging</h4>
<div class="paragraph">
<p>The log files are created in the folder <code>./log</code> with the filenames <code>arcadedb.log.X</code>,
where <code>X</code> is a number between 0 to 9, set up for log rotate.
The current log file has the number 0, and is rotated based on server starts or file size.</p>
</div>
<div class="paragraph">
<p>By default ArcadeDB does not log debug messages into the console and file. You can change this settings by editing the file <code>config/arcadedb-log.properties</code>. The file is a standard logging configuration file.</p>
</div>
<div class="paragraph">
<p>The default configuration is the following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>1  handlers = java.util.logging.ConsoleHandler, java.util.logging.FileHandler
2  .level = INFO
3  com.arcadedb.level = INFO
4  java.util.logging.ConsoleHandler.level = INFO
5  java.util.logging.ConsoleHandler.formatter = com.arcadedb.utility.AnsiLogFormatter
6  java.util.logging.FileHandler.level = INFO
7  java.util.logging.FileHandler.pattern=./log/arcadedb.log
8  java.util.logging.FileHandler.formatter = com.arcadedb.log.LogFormatter
9  java.util.logging.FileHandler.limit=100000000
10 java.util.logging.FileHandler.count=10</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Line 1 contains 2 loggers, the console and the file. This means logs will be written in both console (process output) and configured file (see (7))</p>
</li>
<li>
<p>Line 2 sets INFO (information) as the default logging level for all the Java classes between FINER, FINE, INFO, WARNING, SEVERE</p>
</li>
<li>
<p>Line 3 is as (2) but sets the level for ArcadeDB package only SEVERE</p>
</li>
<li>
<p>Line 4 sets the minimum level the console logger filters the log file (below INFO level will be discarded)</p>
</li>
<li>
<p>Line 5 sets the formatter used for the console. The AnsiLogFormatter supports ANSI color codes</p>
</li>
<li>
<p>Line 6 sets the minimum level the file logger filters the log file (below INFO level will be discarded)</p>
</li>
<li>
<p>Line 7 sets the path where to write the log file (the file will have a counter suffix, see (10))</p>
</li>
<li>
<p>Line 8 sets the formatter used for the file</p>
</li>
<li>
<p>Line 9 sets the maximum file size for the log, before creating a new file. By default is 100MB</p>
</li>
<li>
<p>Line 10 sets the number of files to keep in the directory. By default is 10. This means that after the 10th file, the oldest file will be removed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you&#8217;re running ArcadeDB in embedded mode, make sure you&#8217;re using the logging setting by specifying the <code>arcadedb-log.properties</code> file at JVM startup:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>java ... -Djava.util.logging.config.file=$ARCADEDB_HOME/config/arcadedb-log.properties ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also use your own configuration for logging. In this case replace the path above with your own file.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Changing-Settings">4.2. Changing Settings</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/server/settings.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>To change the default value of a setting, always put <code>arcadedb.</code> as a prefix. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ java -Darcadedb.dumpConfigAtStartup=true ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>To change the same setting via Java code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">GlobalConfiguration.findByKey("arcadedb.dumpConfigAtStartup").setValue(true);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the <a href="#Settings">Appendix</a> for all the available settings.</p>
</div>
<div class="sect3">
<h4 id="_ram_configuration">4.2.1. RAM Configuration</h4>
<div class="paragraph">
<p>ArcadeDB Server, by default, uses a dynamic allocation for the used RAM. Sometimes you want to limit this to a specific amount. You can define the environment variable <code>ARCADEDB_OPTS_MEMORY</code> to the JVM settings for the usage of the RAM.</p>
</div>
<div class="paragraph">
<p>Example to use 800M fixed RAM for ArcadeDB Server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">export ARCADEDB_OPTS_MEMORY="-Xms800M -Xmx800M"
bin/server.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>ArcadeDB can run with as little as 16 MB for RAM. In case you&#8217;re running ArcadeDB with less than 800M of RAM, you should set the "low-ram" as profile:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">export ARCADEDB_OPTS_MEMORY="-Xms128M -Xmx128M"
bin/server.sh -Darcadedb.profile=low-ram</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting a profile is like executing a macro that changes multiple settings at once. You can tune them individually, check <a href="#Settings">Settings</a>.</p>
</div>
<div class="paragraph">
<p>In case of memory latency problems under Linux systems, the following JVM setting can improve performance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">export ARCADEDB_OPTS_MEMORY="-XX:+PerfDisableSharedMem"</code></pre>
</div>
</div>
<div class="paragraph">
<p>for more information, see <a href="https://www.evanjones.ca/jvm-mmap-pause.html" class="bare">https://www.evanjones.ca/jvm-mmap-pause.html</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="High-Availability">4.3. High Availability</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/server/ha.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB supports a High Availability mode where multiple servers share the same database (replication).</p>
</div>
<div class="paragraph">
<p>In order to start an ArcadeDB server with the support for replication, you need to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enable the HA module by setting the configuration <code>arcadedb.ha.enabled</code> to <code>true</code></p>
</li>
<li>
<p>Define the servers that are part of the clusters (if you are using Kubernetes, look at <a href="#Kubernetes">Kubernetes</a> paragraph).
To setup the server list, define the <code>arcadedb.ha.serverList</code> setting by separating the servers with commas (<code>,</code>) and using the following format for servers: <code>&lt;hostname/ip-address[:port]&gt;</code>.
The default port is <code>2424</code> if not specified.</p>
</li>
<li>
<p>Define the local server name by setting the <code>arcadedb.server.name</code> configuration.
Each node must have a unique name.
If not specified, the default server name is "ArcadeDB_0"</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ bin/server.sh -Darcadedb.ha.enabled=true
                -Darcadedb.server.name=FloridaServer
                -Darcadedb.ha.serverList=localhost,192.168.0.1:2424,japan-server:8888</code></pre>
</div>
</div>
<div class="paragraph">
<p>The log should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">[HttpServer] &lt;FloridaServer&gt; - HTTP Server started (host=0.0.0.0 port=2480)
[LeaderNetworkListener] &lt;ArcadeDB_0&gt; Listening for replication connections on 127.0.0.1:2424 (protocol v.-1)
[HAServer] &lt;FloridaServer&gt; Unable to find any Leader, start election (cluster=arcadedb configuredServers=1 majorityOfVotes=1)
[HAServer] &lt;FloridaServer&gt; Change election status from DONE to VOTING_FOR_ME
[HAServer] &lt;FloridaServer&gt; Starting election of local server asking for votes from [] (turn=1 retry=0 lastReplicationMessage=-1 configuredServers=1 majorityOfVotes=1)
[HAServer] &lt;FloridaServer&gt; Current server elected as new Leader (turn=1 totalVotes=1 majority=1)
[HAServer] &lt;FloridaServer&gt; Change election status from VOTING_FOR_ME to LEADER_WAITING_FOR_QUORUM
[HAServer] &lt;FloridaServer&gt; Contacting all the servers for the new leadership (turn=1)...</code></pre>
</div>
</div>
<div class="paragraph">
<p>At startup, the ArcadeDB server will look for an existent cluster to join based on the configured list of servers, otherwise a new cluster will be created.
In this example we set the server name to <code>FloridaServer</code>.</p>
</div>
<div class="paragraph">
<p>Every time a server joins a cluster, it starts the process to elect the new leader.
If the cluster exists and already contains a Leader, then the existent leader is kept.
Every time a server leaves the cluster (because it becomes unreachable), the election process is started again.
To know more about the RAFT election process, look at <a href="https://raft.github.io/">RAFT protocol</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The cluster name by default is "arcadedb", but you can have multiple clusters in the same network.
To specify a custom name, set the configuration <code>arcadedb.ha.clusterName=&lt;name&gt;</code>.
Example: <code>bin/server.sh -Darcadedb.ha.clusterName=projectB</code>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All servers of a cluster serve the same databases.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_architecture">4.3.1. Architecture</h4>
<div class="paragraph">
<p>ArcadeDB has a Leader/Replica model by using RAFT consensus for election and replication.</p>
</div>
<div class="literalblock">
<div class="title">Cluster of Servers</div>
<div class="content">
<pre> +------------+        +------------+        +------------+
 | ArcadeDB_1 |&lt;-------| ArcadeDB_0 |-------&gt;| ArcadeDB_2 |
 |  Replica   |        |   Leader   |        |  Replica   |
 +------------+        +------------+        +------------+
       |                     |                     |
       |                     |                     |
       V                     V                     V
  +----------+          +----------+          +----------+
  |  Journal |          |  Journal |          |  Journal |
  |      {d} |          |      {d} |          |      {d} |
  +----------+          +----------+          +----------+</pre>
</div>
</div>
<div class="paragraph">
<p>Each server has its own Journal.
The Journal is used in case of recovery of the cluster to get the most updated replica and to align the other nodes.
All the write operations must be coordinated by the Leader node.</p>
</div>
<div class="paragraph">
<p>Any read operation, like a query, can be executed by any server in the cluster, while write operations can be executed only by the Leader server.</p>
</div>
<div class="literalblock">
<div class="title">Read Request executed on a Replica</div>
<div class="content">
<pre>            +------------+
            |  Client A  |
            +-----+------+
               ^  |
(2) send result|  | (1) read request
 to the client |  V
            +------------+
            | ArcadeDB_1 |
            |  Replica   |
            +------------+</pre>
</div>
</div>
<div class="paragraph">
<p>ArcadeDB doesn&#8217;t mandate the clients to be connected directly to the leader to execute write operations, but will use the Replica server to forward the write request to the Leader server.
Everything is transparent for the end user where both Leader and Replica servers can read and write, but internally only the read requests are executed on the connected server.
All the write requests will be transparently forwarded to the Leader.</p>
</div>
<div class="paragraph">
<p>Look at the picture below where the client <code>Client A</code> is connected to the replica server <code>ArcadeDB_1</code> where it executes a write request.</p>
</div>
<div class="literalblock">
<div class="title">Write Request executed on a Replica</div>
<div class="content">
<pre>            +------------+
            |  Client A  |
            +-----+------+
               ^  |
(6) send result|  | (1) write request
 to the client |  V
            +------------+              +------------+
            | ArcadeDB_1 |-------------&gt;| ArcadeDB_0 | (3) execute write request
            |  Replica   | (2) forward  |   Leader   | (4) replicate to all the servers
            +------------+              +------------+  (including ArcadeDB_1)
                  ^                           |
                  |                           |
                  +---------------------------+
                   (5) Send result back to the
                      requesting server</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_auto_fail_over">4.3.2. Auto fail-over</h4>
<div class="paragraph">
<p>ArcadeDB cluster uses a quorum to assure the integrity of the database is maintained across all the servers forming the cluster.
The quorum is set by default to <code>MAJORITY</code>, that means the majority of the servers in the cluster must return the same result to be considered accepted and propagated to all the servers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The quorum is <code>MAJORITY</code> by default.
You can specify a different quorum by setting the number of servers or <code>none</code> to have no quorum and <code>all</code> to wait the response from all the servers.
Set the configuration <code>arcadedb.ha.quorum=&lt;quorum&gt;</code>.
Example: <code>bin/server.sh -Darcadedb.ha.quorum=all</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the configured quorum is not met, the transaction is rollback on all the servers, the database returns to the previous state and a transaction error is thrown to the client.</p>
</div>
<div class="paragraph">
<p>ArcadeDB manages the fail-over automatically in most of the cases.</p>
</div>
<div class="sect4">
<h5 id="_server_unreachable">Server unreachable</h5>
<div class="paragraph">
<p>A server can become unreachable for many reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The ArcadeDB Server process has been terminated</p>
</li>
<li>
<p>The physical or virtual server hosting the ArcadeDB Server process has been shut off or is rebooting</p>
</li>
<li>
<p>The physical or virtual server hosting the ArcadeDB Server process has network issues and can&#8217;t reach one or more of the other servers</p>
</li>
<li>
<p>Network issues that prevent the ArcadeDB Server to communicate with the rest of the servers in the cluster</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_auto_balancing_clients">4.3.3. Auto balancing clients</h4>
<div class="paragraph">
<p>More coming soon.</p>
</div>
</div>
<div class="sect3">
<h4 id="_troubleshooting">4.3.4. Troubleshooting</h4>
<div class="sect4">
<h5 id="_unsupported_class_file_major_version_61">Unsupported class file major version 61</h5>
<div class="paragraph">
<p>This error means you&#8217;re running ArcadeDB with a JDK 16 or major.
Unfortunately Apache Gremlin is not compliant with such version of the JDK.
We suggest to use JDK 11 to run ArcadeDB.</p>
</div>
</div>
<div class="sect4">
<h5 id="_performance_insertion_is_slow">Performance: insertion is slow</h5>
<div class="paragraph">
<p>ArcadeDB uses an optimistic lock approach: if two threads try to update the same page, the first thread wins, the second thread throws a <code>ConcurrentModificationException</code> and forces the client to retry the transaction or fail after a certain number of retries (configurable).
Often this fail/retry mechanism is totally hidden to the developer that executes a transaction via HTTP or via the Java API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.transaction( ()-&gt; {
  // MY TRANSACTION CODE
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are inserting a lot of record in parallel (by using the Server, or just via API multi-thread), you could benefit by allocating the bucket per thread. Example to change the bucket selection strategy for the vertex type "User":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">alter type User BucketSelectionStrategy `thread`</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the command above, in insertion ArcadeDB will select the physical bucket based on the thread the request is coming from. If you have enough buckets (created by default when you create a new type, but you can manually adjust it) insertions can go truly in parallel with zero contentions in pages, meaning zero exception and retries.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ha_settings">4.3.5. HA Settings</h4>
<div class="paragraph">
<p>The following <a href="#Settings">settings</a> are used by the High Availability module:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Setting</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.clusterName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cluster name.
Useful in case of multiple clusters in the same network</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.serverList</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Servers in the cluster as a list of &lt;hostname/ip-address:port&gt; items separated by comma.
Example: localhost:2424,192.168.0.1:2424. If not specified, auto-discovery is enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NOT DEFINED (auto discovery is enabled by default)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.quorum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default quorum between 'none', 1, 2, 3, 'majority' and 'all' servers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAJORITY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.quorumTimeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timeout waiting for the quorum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.k8s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The server is running inside Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.k8sSuffix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When running inside Kubernetes use this suffix to reach the other servers.
Example: arcadedb.default.svc.cluster.local</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.replicationQueueSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Queue size for replicating messages between servers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.replicationFileMaxSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum file size for replicating messages between servers"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.replicationChunkMaxSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum channel chunk size for replicating messages between servers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16777216</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.replicationIncomingHost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP host name used for incoming replication connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">localhost</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb.ha.replicationIncomingPorts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP port number used for incoming replication connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2424-2433</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Embedded-Server">4.4. Embedded Server</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/server/embed-server.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Embedding the server in your JVM allows to have all the benefits of working in embedded mode with ArcadeDB (zero cost for network transport and marshalling) and still having the database accessible from the outside, such as Studio, remote API, Postgres, REDIS and MongoDB drivers.</p>
</div>
<div class="paragraph">
<p>First, add the server library in your classpath.
If you&#8217;re using Maven include this dependency in your <code>pom.xml</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.arcadedb&lt;/groupId&gt;
    &lt;artifactId&gt;arcadedb-server&lt;/artifactId&gt;
    &lt;version&gt;23.3.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This library depends on <code>arcadedb-network-&lt;version&gt;.jar</code>.
If you&#8217;re using Maven or Gradle it will be imported automatically as a dependency, otherwise please add also the <code>arcadedb-network</code> library to your classpath.</p>
</div>
<div class="sect3">
<h4 id="_start_the_server_in_the_jvm">4.4.1. Start the server in the JVM</h4>
<div class="paragraph">
<p>To start a server as embedded, create it with an empty configuration, so all the setting will be the default ones:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ContextConfiguration config = new ContextConfiguration();
ArcadeDBServer server = new ArcadeDBServer(config);
server.start();</code></pre>
</div>
</div>
<div class="paragraph">
<p>To start a server in distributed configuration (with replicas), you can set your settings in the <code>ContextConfiguration</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">config.setValue(GlobalConfiguration.HA_SERVER_LIST, "localhost,192.168.10.1,192.168.10.2");
config.setValue(GlobalConfiguration.HA_REPLICATION_INCOMING_HOST, "0.0.0.0");
config.setValue(GlobalConfiguration.HA_ENABLED, true);</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you embed the server, you should always get the database instance from the server itself.
This assures the database instance is just one in the entire JVM.
If you try to create or open another database instance from the <code>DatabaseFactory</code>, you will receive an error that the underlying database is locked by another process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Database database = server.getDatabase(&lt;URL&gt;);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or this if you want to create a new database if not exists:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Database database = server.getOrCreateDatabase(&lt;URL&gt;);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_custom_http_commands">4.4.2. Create custom HTTP commands</h4>
<div class="paragraph">
<p>You can easily add custom HTTP commands on ArcadeDB&#8217;s Undertow HTTP Server by creating a server plugin (look at <code>MongoDBProtocolPlugin</code> plugin implementation) and implementing the <code>registerAPI</code> method.
Example for the HTTP POST API <code>/myapi/test</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.yourpackage;

public class MyTest implements ServerPlugin {
  // ...

  @Override
  public void registerAPI(HttpServer httpServer, final PathHandler routes) {
    routes.addPrefixPath("/myapi",//
      Handlers.routing()//
        .get("/account/{id}", new RetieveeAccount(this))// YOU CAN ADD YOUR HANDLERS UNDER THE SAME PREFIX PATH
        .post("/test/{name}", new MyTestAPI(this))//
    );
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use <code>GET</code>, <code>POST</code> or any HTTP methods when you register your handler.
Note that multiple handlers are defined under the same prefix <code>/myapi</code>.
Below you can find the implementation of the Test handler that will called by using HTTP POST method against the URL <code>/myapi/test/{name}</code> where <code>{name}</code> is the name passed as an argument.
Note that the <code>MyTestAPI</code> class is inheriting <code>DatabaseAbstractHandler</code> to have the database instance as a parameter.
If the user is not authenticated, the <code>execute()</code> method is not called at all, but an authentication error is returned. If you don&#8217;t need to access to the database, then you can extend the <code>AbstractHandler</code> class instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class MyTestAPI extends DatabaseAbstractHandler {

  public MyTestAPI(final HttpServer httpServer) {
    super(httpServer);
  }

  @Override
  public void execute(final HttpServerExchange exchange, ServerSecurityUser user, final Database database) throws IOException {
    final Deque&lt;String&gt; namePar = exchange.getQueryParameters().get("name");
    if (namePar == null || namePar.isEmpty()) {
      exchange.setStatusCode(400);
      exchange.getResponseSender().send("{ \"error\" : \"name is null\"}");
      return;
    }

    final String name = namePar.getFirst();

    // DO SOMETHING MEANINGFUL HERE
    // ...

    exchange.setStatusCode(204);
    exchange.getResponseSender().send("");
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>At startup, ArcadeDB Server will initiate your plugin and register your API.
To start the server with your plugin, register the full class in
<code>arcadedb.server.plugins</code> setting:</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>java ... -Darcadedb.server.plugins=MyPlugin:com.yourpackage.MyPlugin ...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_https_connection">4.4.3. HTTPS connection</h4>
<div class="paragraph">
<p>In order to enable HTTPS on ArcadeDB server, you have to set the following configuration before the server starts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">configuration.setValue(GlobalConfiguration.NETWORK_USE_SSL, true);
configuration.setValue(GlobalConfiguration.NETWORK_SSL_KEYSTORE, "src/test/resources/master.jks");
configuration.setValue(GlobalConfiguration.NETWORK_SSL_KEYSTORE_PASSWORD, "keypassword");
configuration.setValue(GlobalConfiguration.NETWORK_SSL_TRUSTSTORE, "src/test/resources/master.jks");
configuration.setValue(GlobalConfiguration.NETWORK_SSL_TRUSTSTORE_PASSWORD, "storepassword");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NETWORK_USE_SSL</code> enable the SSL support for the HTTP Server</p>
</li>
<li>
<p><code>NETWORK_SSL_KEYSTORE</code> is the path where is located the keystore file</p>
</li>
<li>
<p><code>NETWORK_SSL_KEYSTORE_PASSWORD</code> is the keystore password</p>
</li>
<li>
<p><code>NETWORK_SSL_TRUSTSTORE</code> is the path where is located the truststore file</p>
</li>
<li>
<p><code>NETWORK_SSL_TRUSTSTORE_PASSWORD</code> is the truststore password</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the default port for HTTPs is configured under the new global setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">GlobalConfiguration.SERVER_HTTPS_INCOMING_PORT</code></pre>
</div>
</div>
<div class="paragraph">
<p>And by default starts from 2490 to 2499 (increases the port if it&#8217;s already occupied).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
if HTTP or HTTPS port are already used, the next ports are used. With the default range of 2480-2489 for HTTP and 2490-2499 for HTTPS, if the port 2480 is not available, then the next port for both HTTP and HTTPS will be used, namely 2481 for HTTP and 2491 for HTTPS
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Docker">4.5. Docker</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/server/docker.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>To run ArcadeDB Server with Docker, type this (replace &lt;password&gt; with the root password you want to use):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ docker run --rm -p 2480:2480 -p 2424:2424 \
       --env JAVA_OPTS="-Darcadedb.server.rootPassword=playwithdata" \
            arcadedata/arcadedb:latest

5bb2ef9d4704ae9b55b4dfa08a00568596ab8a89fd8a2135f2a15736c891d248</code></pre>
</div>
</div>
<div class="paragraph">
<p>If there are no errors, Docker prints immediately the container id. You can use that id to stop the container, or execute some commands from it.</p>
</div>
<div class="paragraph">
<p>To run the console from the container started above, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ docker exec -it 5bb2ef9d4704ae9b55b4dfa08a00568596ab8a89fd8a2135f2a15736c891d248 bin/console.sh
ArcadeDB Console v.21.9.1 - Copyrights (c) 2021 Arcade Data (https://arcadedb.com)

&gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="Quick-Start-Docker">4.5.1. Quick start with the OpenBeer database</h4>
<div class="paragraph">
<p>You can run ArcadeDB server with a demo database in less than 1 minute. Run ArcadeDB server with docker specifying the database to import as a parameter in the docker command.</p>
</div>
<div class="paragraph">
<p>Example of running ArcadeDB Server with all the plugins enabled (Redis, Postgres, Mongo, Gremlin) that download and install OrientDB&#8217;s <code>OpenBeer</code> dataset:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">docker run --rm  -p 2480:2480 -p 2424:2424 -p 6379:6379 -p 5432:5432 -p 8182:8182 \
           --env JAVA_OPTS="-Darcadedb.server.rootPassword=playwithdata \
-Darcadedb.server.defaultDatabases=Imported[root]{import:https://github.com/ArcadeData/arcadedb-datasets/raw/main/orientdb/OpenBeer.gz} \
-Darcadedb.server.plugins=Redis:com.arcadedb.redis.RedisProtocolPlugin,MongoDB:com.arcadedb.mongo.MongoDBProtocolPlugin,Postgres:com.arcadedb.postgres.PostgresProtocolPlugin,GremlinServer:com.arcadedb.server.gremlin.GremlinServerPlugin " \
       arcadedata/arcadedb:latest</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now point your browser on <strong><a href="https://localhost:2480" class="bare">https://localhost:2480</a></strong> and you&#8217;ll see ArcadeDB Studio. Now enter "root" as a user and "playwithdata" as a password.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
user and password are specified in the docker command above
</td>
</tr>
</table>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/openbeer-demo-login.png" alt="Demo Database Login">
</div>
</div>
<div class="paragraph">
<p>Now click on the "Database" icon on the toolbar on the left. This is the database schema. Click on "OpenBeer" vertex type and then on the action "Display the first 100 records of Beer together with all the vertices that are directly connected".</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/openbeer-demo-schema.png" alt="Demo Database Schema">
</div>
</div>
<div class="paragraph">
<p>You should see the first 100 beers in the database and all their connections.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/openbeer-demo-graph.png" alt="Demo Database Graph">
</div>
</div>
<h4 id="DockerTuning" class="discrete">Tuning</h4>
<div class="paragraph">
<p>In general, the RAM allocated for the JVM should be ≤80% of the container RAM. The default Dockerfile for ArcadeDB sets 2 GB of RAM for ArcadeDB (<code>-Xms2G -Xmx2G</code>), so you should allocate at least 2.3G to the Docker container running exclusively ArcadeDB.</p>
</div>
<div class="paragraph">
<p>To run ArcadeDB with 1G docker container, you could start ArcadeDB by using 800M for ArcadeDB&#8217;s server RAM by setting <code>ARCADEDB_OPTS_MEMORY</code> variable with Docker:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">docker ... -e ARCADEDB_OPTS_MEMORY="-Xms800M -Xmx800M" ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>To run ArcadeDB with RAM &lt;800M, it&#8217;s suggested to tune some settings. You can use the <code>low-ram</code> profile to use the least memory possible.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">docker ... -e ARCADEDB_OPTS_MEMORY="-Xms800M -Xmx800M" -e arcadedb.profile=low-ram ...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Kubernetes">4.6. Kubernetes</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/server/kubernetes.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Before starting the cluster, set ArcadeDB Server root password as a secret (replace &lt;password&gt; with the root password you want to use):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ kubectl create secret generic server-root-password --from-literal=arcadedb.server.rootPassword='&lt;password&gt;'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will set the password in the environment variable <code>arcadedb.server.rootPassword</code>. The ArcadeDB server will use this password for the <code>root</code> user.</p>
</div>
<div class="paragraph">
<p>Now you can start a Kubernetes cluster with 3 servers by using the default configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ kubectl apply -f config/arcadedb-statefulset.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on ArcadeDB Kubernetes config <a href="https://github.com/ArcadeData/arcadedb/blob/main/package/src/main/config/arcadedb-statefulset.yaml">please check</a>.</p>
</div>
<div class="paragraph">
<p>In order to scale up or down with the number of replicas, use this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ kubectl scale statefulsets arcadedb-server --replicas=&lt;new-number-of-replicas&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where the value of <code>&lt;new-number-of-replicas&gt;</code> is the new number of replicas. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ kubectl scale statefulsets arcadedb-server --replicas=3</code></pre>
</div>
</div>
<div class="paragraph">
<p>Scaling up and down doesn&#8217;t affect current workload. There are no pauses when a server enters/exits from the cluster.</p>
</div>
<div class="paragraph">
<p>More coming soon.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Studio">5. Studio</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Studio is the web tool that comes bundled with ArcadeDB Server. It starts automatically on port 2480. If you have installed ArcadeDB, and it&#8217;s running on your local computer, then you can access Studio at <a href="http://localhost:2480" class="bare">http://localhost:2480</a>. Replace "localhost" with the host name or IP address of the server where ArcadeDB server is running.</p>
</div>
<h3 id="_command" class="discrete">Command</h3>
<div class="paragraph">
<p>The first and most important panel in Studio is the Command panel.
Below you can find a screenshot with the main components.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/studio-command-panel-explained.png" alt="studio command panel explained">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Main Menu</strong> is the vertical tab with the following options:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Command</strong>, the current panel to execute commands against the database</p>
</li>
<li>
<p><strong>Database</strong>, containing the information about the selected database and its schema.
From this panel you can switch to a different database</p>
</li>
<li>
<p><strong>API</strong>, with the description of the public HTTP API exposed on the current server</p>
</li>
<li>
<p><strong>Information</strong>, containing a quick reference to the online documentation</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<h4 id="_execute_a_commandquery" class="discrete">Execute a command/query</h4>
<div class="paragraph">
<p>In order to execute a command (or query), select the language first. By default is SQL, but you can choose between:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SQL</strong> (for any models, including graphs and documents)</p>
</li>
<li>
<p><strong>SQL Script</strong> (multiple commands/queries)</p>
</li>
<li>
<p><strong>Apache Tinkerpop Gremlin</strong> (only for graphs)</p>
</li>
<li>
<p><strong>Open Cypher</strong> (only for graphs)</p>
</li>
<li>
<p><strong>MongoDB</strong> (only for documents)</p>
</li>
<li>
<p><strong>GraphQL</strong></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/studio-command-select-language.png" alt="studio command select language">
</div>
</div>
<div class="paragraph">
<p>Based on the selected language, the command text area will adjust the syntax highlighting to simplify the writing of the command.</p>
</div>
<div class="paragraph">
<p>The result of the command will appear in the Command Result area as a <a href="#Studio-Graph">Graph</a> a <a href="#Studio-Table">Table</a> or <a href="#Studio-JSON">JSON Panel</a>.</p>
</div>
<h3 id="Studio-Graph" class="discrete">Graph Panel</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><span class="image"><img src="images/studio-graph-node-menu-unselected.png" alt="studio graph node menu unselected"></span></th>
<th class="tableblock halign-left valign-top">Hold the selection on a node to show its context menu.
Then while still holding the selection, slide on the action to execute and then release the selection.</th>
<th class="tableblock halign-left valign-top"><span class="image"><img src="images/studio-graph-node-menu-selected.png" alt="studio graph node menu selected"></span></th>
</tr>
</thead>
</table>
<div class="paragraph">
<p>The context menu has the following actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&#8592;</code>  Load incoming vertices</p>
</li>
<li>
<p><code>&#8594;</code>  Load outgoing vertices</p>
</li>
<li>
<p>Load both incoming and outgoing vertices</p>
</li>
<li>
<p>Hide the current node.
This action will remove the node from the graph</p>
</li>
</ul>
</div>
<h4 id="_node_panel" class="discrete">Node Panel</h4>
<div class="paragraph">
<p>When a node is selected, its property are displayed in the right panel.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/studio-node-panel.png" alt="studio node panel">
</div>
</div>
<div class="paragraph">
<p>The right panel can always be hidden by clicking on <code>Hide Properties</code> button.</p>
</div>
<div class="paragraph">
<p>In the right panel you can find all the information relative to the selected node, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Element type: <code>Node</code> or <code>Edge</code></p>
</li>
<li>
<p><a href="#RID">Record ID (RID)</a></p>
</li>
<li>
<p>Type</p>
</li>
<li>
<p>Properties table</p>
</li>
<li>
<p>Actions, containing quick actions to execute against the selected node</p>
</li>
<li>
<p>Layout</p>
</li>
</ul>
</div>
<h5 id="_node_layout" class="discrete">Node Layout</h5>
<div class="paragraph">
<p>Click on the <code>+</code> button to expand and make visible the layout panel relative to the node type selected.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/studio-node-panel-layout.png" alt="studio node panel layout">
</div>
</div>
<div class="paragraph">
<p>Change the label to an attribute that represents the node.
In this example, selecting the title for the type <code>Movie</code> and the name for <code>Person</code>, makes the same graph much more readable and useful in terms of information.</p>
</div>
<div class="paragraph">
<p>This is the default rendering of a small graph from the OpenBeer dataset.
The nodes have the type as label.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/studio-graph-default.png" alt="studio graph default">
</div>
</div>
<div class="paragraph">
<p>After selecting the attribute <code>name</code> on each node types, this is the result.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/studio-graph-add-label.png" alt="studio graph add label">
</div>
</div>
<div class="paragraph">
<p>You can save your setting in a file and share the settings with your colleagues.
To do this, click on <code>Export</code> button and select <code>Settings</code>, then download the file. You can re-apply the same style by selecting <code>Import</code> and then <code>Settings</code>. Upload the file saved before and your style settings will be restored. You can share the setting filw with your colleagues and friends to work on the same dataset by using the same style.</p>
</div>
<div class="paragraph">
<p>Below you can find an example of customization for the OpenBeer database with custom icons, colors and labels:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/openbeer-demo-custom.png" alt="openbeer demo custom">
</div>
</div>
<h4 id="_direct_neighbors" class="discrete">Direct Neighbors</h4>
<div class="paragraph">
<p>Selects the nodes directly connected to the selected ones.</p>
</div>
<div class="paragraph">
<p><strong>Usage</strong></p>
</div>
<div class="paragraph">
<p>Select one or more nodes from the graph and click on <code>Select &#8594; Direct Neighbors</code>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/studio-direct-neighbors.png" alt="studio direct neighbors">
</div>
</div>
<h4 id="_orphan_vertices" class="discrete">Orphan Vertices</h4>
<div class="paragraph">
<p>Selects the nodes that are not connected with any other node.</p>
</div>
<div class="paragraph">
<p><strong>Usage</strong></p>
</div>
<div class="paragraph">
<p>Click on <code>Select &#8594; Orphan Vertices</code>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/studio-orphans.png" alt="studio orphans">
</div>
</div>
<h4 id="_invert_node_selection" class="discrete">Invert Node Selection</h4>
<div class="paragraph">
<p>Inverts the current selection.
All the elements that are currently selected will be not selected and all the element that were not selected become selected.</p>
</div>
<div class="paragraph">
<p><strong>Usage</strong></p>
</div>
<div class="paragraph">
<p>Select some nodes from the graph and click on <code>Select &#8594; Invert Node Selection</code>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/studio-invert.png" alt="studio invert">
</div>
</div>
<h4 id="_shortest_path" class="discrete">Shortest Path</h4>
<div class="paragraph">
<p>Displays the shortest path between 2 nodes.
The Dijkstra algorithm is used (with fixed weight 1 per node).
If the two nodes are connected, the entire path will be selected.</p>
</div>
<div class="paragraph">
<p><strong>Usage</strong></p>
</div>
<div class="paragraph">
<p>Select 2 nodes from the graph and click on <code>Select &#8594; Shortest Path</code>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/studio-shortest-path.png" alt="studio shortest path">
</div>
</div>
<h3 id="Studio-Table" class="discrete">Table Panel</h3>
<div class="paragraph">
<p>The Table panel renders the result set as a table.
If the result of the command is a graph, then both vertices and edges will be flattened into a table.
If the result has documents, they will be displayed in table format as well.
Connections to other records (like edges in vertices) are not displayed in the table, but only the number of connection is reported.
In the example below <code>@in</code> is the number of incoming edges for each vertex, and <code>@out</code> the number of outgoing edges.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/studio-table.png" alt="studio table">
</div>
</div>
<div class="paragraph">
<p>By clicking on the <a href="#RID">RecordID (RID)</a> (always the first column), the record will be displayed in the graph view with all its attributes.</p>
</div>
<div class="paragraph">
<p>The Table View automatically layout the records in pages.
You can select the amount of records per page and moving between pages with the toolbar at the bottom of the table.</p>
</div>
<div class="paragraph">
<p>To quick search a record, type what you&#8217;re looking for in the <code>Search</code> input field.
The filtering works in real-time as soon as you type.
The filtering only applies on the current result set.</p>
</div>
<div class="paragraph">
<p>The table can be exported in the following formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Copy</strong>, to copy the entire content in the clipboard.
You can then paste the content into your favorite editor or document with CTRL+V or CMD+V.</p>
</li>
<li>
<p><strong>Excel</strong>, for Microsoft&#174; Excel format</p>
</li>
<li>
<p><strong>CSV</strong> (Comma Separated values)</p>
</li>
<li>
<p><strong>PDF</strong> to export the entire table in PDF format</p>
</li>
<li>
<p><strong>Print</strong> to print all the pages of the table</p>
</li>
</ul>
</div>
<h3 id="Studio-JSON" class="discrete">JSON Panel</h3>
<div class="paragraph">
<p>This panel renders the command result as a JSON.
The JSON returned from the <a href="#HTTP-API">HTTP API</a> of the <a href="#Server">ArcadeDB Server</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/studio-json.png" alt="studio json">
</div>
</div>
<div class="paragraph">
<p>Press the <code>Copy to clipboard</code> to copy the entire content into the clipboard.</p>
</div>
<h3 id="Studio-Database" class="discrete">Database Panel</h3>
<div class="paragraph">
<p>The Database Panel shows the information about the selected database and its schema and allows to execute the most common operations.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/studio-database.png" alt="studio database">
</div>
</div>
<div class="paragraph">
<p>The main parts of the Database Panel are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Server Version</strong>, report the version you are using when you open an issue</p>
</li>
<li>
<p><strong>User</strong>, the user logged into the server.
The list of available databases is filtered by the current user.
User the <code>admin</code> user to access to all the databases.
See <a href="#Users">Users</a>.</p>
</li>
<li>
<p><strong>Selected Database</strong>, the selected database.
Click to select a different database from the available on the server for the current user.</p>
</li>
<li>
<p><strong>Database Commands</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Create</strong> to create a new database.
Enter the database name in the popup and the new database will be ready to be used</p>
</li>
<li>
<p><strong>Drop</strong> to drop the current database.
<strong><em>NOTE: This operation cannot be undone.</em></strong></p>
</li>
<li>
<p><strong>Backup</strong> to execute a backup of the selected database.
The backup will be available under the directory <code>backups</code> where ArcadeDB server is installed.
The generated backup filename is in the format <code>backups/&lt;db-name&gt;/&lt;db-name&gt;-backup-&lt;timestamp&gt;.tgz</code>, where the timestamp is expresses from the year to the millisecond.
Example of backup file name <code>backups/TheMatrix/TheMatrix-backup-20210921-172750767.zip</code>.
For more information look at <a href="#Backup">Backup</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Types</strong>, with a vertical tab you can select the type you&#8217;re interested in.
One a type is selected, its information are displayed, such as configured indexes and properties.</p>
</li>
<li>
<p><strong>Actions</strong> is a list of quick actions you can execute against the selected type.
The most common actions are:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Display tge first 30 records</strong> of the selected type</p>
</li>
<li>
<p><strong>Display tge first 30 records with all the vertices connected</strong> to display a graph of the first 30 records.
The graph will have the 30 records and their direct neighbors.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<h3 id="Studio-API" class="discrete">API Panel</h3>
<div class="paragraph">
<p>This panel contains the description of the public HTTP API exposed on the current server.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/studio-api.png" alt="studio api">
</div>
</div>
<h3 id="Studio-Information" class="discrete">Information Panel</h3>
<div class="paragraph">
<p>This panel contains a quick reference to the online documentation.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/studio-info.png" alt="studio info">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tools">6. Tools</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="Console">6.1. Console</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/tools/console.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Run the console by executing <code>console.sh</code> under <code>bin</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ bin/console.sh

ArcadeDB Console v.23.1.1 - Copyrights (c) 2021 Arcade Data Ltd (https://arcadedb.com)

&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The console supports the following commands (you can always retrieve this help by typing <code>HELP</code> or just <code>?</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>begin                                             -&gt; begins a new transaction
check database                                    -&gt; check database integrity
close |&lt;path&gt;|remote:&lt;url&gt; &lt;user&gt; &lt;pw&gt;            -&gt; closes the database
commit                                            -&gt; commits current transaction
connect &lt;path&gt;|local:&lt;url&gt;|remote:&lt;url&gt; &lt;user&gt; &lt;pw&gt;            -&gt; connects to a database
create database &lt;path&gt;|remote:&lt;url&gt; &lt;user&gt; &lt;pw&gt;   -&gt; creates a new database
create user &lt;user&gt; identified by &lt;pw&gt; [grant connect to &lt;db&gt;*] -&gt; creates a user
drop database &lt;path&gt;|remote:&lt;url&gt; &lt;user&gt; &lt;pw&gt;     -&gt; deletes a database
drop user &lt;user&gt;                                  -&gt; deletes a user
help|?                                            -&gt; ask for this help
info types                                        -&gt; prints available types
info type &lt;type&gt;                                  -&gt; prints details about type
info transaction                                  -&gt; prints current transaction
list databases |remote:&lt;url&gt; &lt;user&gt; &lt;pw&gt;          -&gt; lists databases
load &lt;path&gt;                                       -&gt; runs local script
rollback                                          -&gt; rolls back current transaction
set language = sql|sqlscript|cypher|gremlin|mongo -&gt; sets console query language
-- &lt;comment&gt;                                      -&gt; comment (no operation)
quit|exit                                         -&gt; exits from the console</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>close</code> command can be used without path or url, then it closes the currently connected database.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>comment</code> command is useful for scripts.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="Console-Tutorial">6.1.1. Tutorial</h4>
<div class="paragraph">
<p>Let&#8217;s create our first database, located in our local filesystem. To identify the database you specify in a connection string. It could be either absolute, or relative to the database directory. The database directoty can be explicitely set, when you start the console, like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">    ./bin/console.sh -Darcadedb.server.databaseDirectory=/Users/&lt;USER-ID&gt;/Arcadedb</code></pre>
</div>
</div>
<div class="paragraph">
<p>If no database directory is given at startup, it is the <code>databases</code> directory under the root path of the arcadedb server by default.
To create a new database under the database directory, you would run the following command in the console</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">&gt; create database mydb

{mydb}&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to create your database somwhere else in the local filesystem, you would use an absolute path to the db, prefixed with "local:".
Like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">&gt; create database local://Users/&lt;USER-ID&gt;/Arcadedb/mydb

{mydb}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you already have a database, you can simply connect to it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">&gt; connect mydb

{mydb}&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">&gt; connect local://Users/&lt;USER-ID&gt;/Arcadedb/mydb

{mydb}&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is how you create a or connect to a database without an intermediate ArcadeDB server.
But you can also connect to a database, which is managed by a running server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">&gt; connect remote:localhost/mydb root arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s also create a user with access to "mydb":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">&gt; create user elon identified by muskmusk grant connect to mydb</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s create a "Profile" type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{mydb}&gt; create document type Profile

+---------+--------------------+
|NAME     |VALUE               |
+---------+--------------------+
|operation|create document type|
|typeName |Profile             |
+---------+--------------------+
Command executed in 99ms</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check your new type is there:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">{mydb}&gt; info types

AVAILABLE TYPES
+-------+--------+-----------+-------------------------------------+-----------+-------------+
|NAME   |TYPE    |SUPER TYPES|BUCKETS                              |PROPERTIES |SYNC STRATEGY|
+-------+--------+-----------+-------------------------------------+-----------+-------------+
|Profile|Document|0[]        |8[Profile_0,...,Profile_7]|0[]       |round-robin|             |
+-------+--------+-----------+-------------------------------------+-----------+-------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also query the defined types by executing the following SQL query: <code>select from schema:types</code>.</p>
</div>
<div class="paragraph">
<p>Finally, let&#8217;s create a document of type "Profile":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">{mydb}&gt; insert into Profile set name = 'Jay', lastName = 'Miner'

DOCUMENT @type:Profile @rid:#1:0
+--------+-----+
|NAME    |VALUE|
+--------+-----+
|name    |Jay  |
|lastName|Miner|
+--------+-----+
Command executed in 17ms</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see your brand new record with RID #1:0. Now let&#8217;s query the database to see if our new document can be found:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">{mydb}&gt; select from Profile

DOCUMENT @type:Profile @rid:#1:0
+--------+-----+
|NAME    |VALUE|
+--------+-----+
|name    |Jay  |
|lastName|Miner|
+--------+-----+
Command executed in 37ms</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we go: our document is there.</p>
</div>
<div class="paragraph">
<p>Remember that a transaction is automatically started. In order to make changes persistent, execute a <code>commit</code> command.
When the console exists (<code>exit</code> or <code>quit</code> command), the pending transaction is committed automatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="Console-Scripting">6.1.2. Scripting</h4>
<div class="paragraph">
<p>The console can also run local SQL scripts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ bin/console.sh myscript.sql</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Make sure to <code>create database</code> or <code>connect</code> to a database first in the script before using <a href="#SQL">SQL commands</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Backup">6.2. Backup of a Database</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/tools/backup.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB allows to execute a non-stop backup of a database while it is used without blocking writes or affecting performance.
You can execute the backup of a database from SQL.</p>
</div>
<div class="paragraph">
<p>Look at <a href="#SQL-Backup-Database">Backup Database SQL command</a> for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="Restore">6.3. Restore a Database</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/tools/restore.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB allows to restore a database previously backed up.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If a server is running, it must be restarted in order to access to the restored database.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>Example for restoring the database "mydb" from the backup located in <code>backups/mysb/mydb-backup-20210921-172750767.zip</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ bin/restore.sh -f backups/mysb/mydb-backup-20210921-172750767.zip -d databases/mydb</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_configuration">6.3.1. Configuration</h4>
<div class="ulist">
<ul>
<li>
<p><code>-f &lt;backup-file&gt;</code>   (string) path to the backup file to restore.</p>
</li>
<li>
<p><code>-d &lt;database-path&gt;</code> (string) path on local filesystem where to create the ArcadeDB database.</p>
</li>
<li>
<p><code>-o</code>                 (boolean) true to overwrite the database if already exists.
If false and the <code>database-path</code> already exists, an error is thrown.
Default is false.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Importer">6.4. Importer</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/tools/importer.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB provides some basic ETL capabilities for automatically importing datasets in any of the following formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://orientdb.org">OrientDB</a> database export</p>
</li>
<li>
<p><a href="https://neo4j.com">Neo4j</a> database export</p>
</li>
<li>
<p><a href="http://graphml.graphdrawing.org">GraphML</a> database export</p>
</li>
<li>
<p><a href="https://github.com/tinkerpop/blueprints/wiki/GraphSON-Reader-and-Writer-Library">GraphSON</a> database export</p>
</li>
<li>
<p>Generic XML files</p>
</li>
<li>
<p>Generic <a href="#JSON-Importer">JSON</a> files</p>
</li>
<li>
<p>Generic CSV files</p>
</li>
<li>
<p>Generic RDF files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>From file of types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Plain text</p>
</li>
<li>
<p>Compressed with ZIP (only the first file is read)</p>
</li>
<li>
<p>Compressed with GZip</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Located on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>local</strong> file system (just provide the path or use <code>file://</code> in the URL)</p>
</li>
<li>
<p><strong>remote</strong>, by specifying <code>http://</code> or <code>https://</code> in the URL</p>
</li>
<li>
<p><strong>classpath</strong>, by using <code>classpath://</code> as a prefix</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The easiest way is to use the console and the SQL <code>IMPORT DATABASE</code> command. You can also use directly the Java API located in <code>com.arcadedb.integration.importer.Importer</code>.</p>
</div>
<div class="paragraph">
<p>To start importing it&#8217;s super easy as providing the URL where the source file to import is located.
URLs can be local paths (use <code>file://</code>) or from the Internet by using <code>http://</code> and <code>https://</code>.</p>
</div>
<div class="paragraph">
<p>Example of loading the Freebase RDF dataset:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt; create database FreeBase
{FreeBase}&gt; import database http://commondatastorage.googleapis.com/freebase-public/rdf/freebase-rdf-latest.gz

Analyzing url: http://commondatastorage.googleapis.com/freebase-public/rdf/freebase-rdf-latest.gz... [SourceDiscovery]
Recognized format RDF (limitBytes=9.54MB limitEntries=0) [SourceDiscovery]
Creating type 'Node' of type VERTEX [Importer]
Creating type 'Relationship' of type EDGE [Importer]
Parsed 144951 (28990/sec) - 0 documents (0/sec) - 143055 vertices (28611/sec) - 144951 edges (28990/sec) [Importer]
Parsed 362000 (54256/sec) - 0 documents (0/sec) - 164118 vertices (5260/sec) - 362000 edges (54256/sec) [Importer]
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example of loading the Discogs dataset in the database on path "/temp/discogs":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt; import database https://discogs-data.s3-us-west-2.amazonaws.com/data/2018/discogs_20180901_releases.xml.gz</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in this case the URL is <code>https</code> and the file is compressed with <code>GZip</code>.</p>
</div>
<div class="paragraph">
<p>Example of importing New York Taxi dataset in CSV format.
The first line of the CSV file set the property names:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt; import database file:///personal/Downloads/data-society-uber-pickups-in-nyc/original/uber-raw-data-april-15.csv/uber-raw-data-april-15.csv</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Import-Database">SQL Import Database command</a>,</p>
</li>
<li>
<p><a href="#JSON-Importer">JSON Importer</a></p>
</li>
<li>
<p><a href="#Neo4j-Importer">Neo4j Importer</a>,</p>
</li>
<li>
<p><a href="#OrientDB-Importer">OrientDB Importer</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_additional_settings">6.4.1. Additional Settings</h4>
<div class="paragraph">
<p>The Importer takes additional settings as pairs of setting name and value. With the SQL <a href="#SQL-Import-Database"><code>IMPORT DATABASE</code></a> command, this is the syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">IMPORT DATABASE &lt;url&gt; [ WITH ( &lt;setting-name&gt; = &lt;setting-value&gt; [,] )* ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt; import database file:///import/file.csv with forceDatabaseCreate = true, commitEvery = 100</code></pre>
</div>
</div>
<div class="paragraph">
<p>Below you can find all the supported settings for the Importer.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Setting</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">url</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">url of the file to import</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">./databases/imported</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path of the final imported database</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">forceDatabaseCreate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, the database is created brand new at every import</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">wal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the WAL (journal) for the importing. If the WAL is enabled the importing process will be much slower and will require much more RAM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commitEvery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create transactions that commit every X records</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parallel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Half of the available cores - 1. If you have 8 cores, the default is 3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of concurrent threads used</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">typeIdProperty</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property that represents the ID of the vertex</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">typeIdUnique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True creates a unique index on the type id property, otherwise a non unique index</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">typeIdType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of the id property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trimText</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True if the imported text is trimmed from heading and tailing spaces</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">analysisLimitBytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100,000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of bytes parsed from the source to determine the source file type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">analysisLimitEntries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10,000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of entries (if applicable) parsed from the source to determine the source file type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parsingLimitBytes</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of bytes parsed from the source to be imported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parsingLimitEntries</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of entries imported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">documents</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">url of the file to import containing documents only. This is useful when the database is split in separate files</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">documentsFileType</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format of the file containing documents (csv, graphml, graphson)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">documentsDelimiter</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delimiter used to separate documents</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">documentsHeader</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Header containing the properties in the CSV document. One property per column. If not defined it is parsed from the first line</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">documentsSkipEntries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of rows to skip from the documents file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">documentPropertiesInclude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of property to import from documents. <code>*</code> means all</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">documentType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Document</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the type defined in the schema when importing documents</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vertices</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">url of the file to import containing vertices only. This is useful when the database is split in separate files</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">verticesFileType</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format of the file containing vertices (csv, graphml, graphson)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">verticesDelimiter</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delimiter used to separate vertices</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">verticesHeader</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Header containing the properties in the CSV vertices. One property per column. If not defined it is parsed from the first line</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">verticesSkipEntries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of rows to skip from the vertices file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expectedVertices</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of vertices expected. This is useful to determine the ETA of the importing process of vertices. 0 means unknown</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vertexType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vertex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the type defined in the schema when importing vertices</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vertexPropertiesInclude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of property to import from vertices. <code>*</code> means all</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">edges</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">url of the file to import containing edges only. This is useful when the database is split in separate files</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">edgesFileType</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format of the file containing edges (csv, graphml, graphson)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">edgesDelimiter</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delimiter used to separate edges</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">edgesHeader</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Header containing the properties in the CSV edges. One property per column. If not defined it is parsed from the first line</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">edgesSkipEntries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of rows to skip from the edges file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expectedEdges</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of edges expected. This is useful to determine the ETA of the importing process of edges. 0 means unknown</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxRAMIncomingEdges</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum RAM used to create edges. The more RAM, the faster.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">edgeType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Edge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the type defined in the schema when importing edges</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">edgePropertiesInclude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of property to import from edges. <code>*</code> means all</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">edgeFromField</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the property containing the starting edge</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">edgeToField</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the property containing the ending edge</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">edgeBidirectional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When creating edges, create bidirectional edges if true, otherwise unidirectional</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="JSON-Importer">6.4.2. JSON Importer</h4>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/tools/json-importer.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB is able to import data from JSON format.
Thanks to the flexible mapping, it&#8217;s possible to define the rules of conversion between the input json file and the graph.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start from this simple JSON file to import as an example. The file contains a flat structure of records with a relationship of employee and manager:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Users":[
    {
      "EmployeeID":"1234",
      "ManagerID":"1230",
      "Name":"Marcus"
    },
    {
      "EmployeeID":"1230",
      "ManagerID":"1231",
      "Name":"Win"
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>First, create a new database "employees" by using the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>~/arcadedb $ create database employees</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then execute the following command (assuming the file above is saved in the local directory as <code>employees.json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>import database employees.json
with mapping = {
    "Users": [{
        "@cat": "v",
        "@type": "User",
        "@id": "id",
        "@idType": "string",
        "@strategy": "merge",
        "EmployeeID": "@ignore",
        "ManagerID": {
            "@cat": "e",
            "@type": "HAS_MANAGER",
            "@cardinality": "no-duplicates",
            "@in": {
                "@cat": "v",
                "@type": "User",
                "@id": "id",
                "@idType": "string",
                "@strategy": "merge",
                "EmployeeID": "@ignore",
                "id": "&lt;../ManagerID&gt;"
            }
        }
    }]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mapping file is a JSON snippet with directives about what to import, what to ignore and how to map edges with JSON objects.
Below all the supported tags:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@cat</code>: is the category of record to use between "v" for vertex, "e" for edge and "d" for document</p>
</li>
<li>
<p><code>@type</code>: is the type name to use on record creation.
If the type doesn&#8217;t exist, it&#8217;s implicitly created during the import</p>
</li>
<li>
<p><code>@id</code>: is the property that works as primary key. if not already defined, a unique index is created on the configured <code>@id</code> property</p>
</li>
<li>
<p><code>@idType</code>: is the type of the primary key in the <code>@id</code> property.
If not defined, the type is taken from the first value found.
In case of numbers, the JSON parser always uses DOUBLE as a type.
You can, for example, use LONG to force using LONG instead of DOUBLE</p>
</li>
<li>
<p><code>@cardinality</code>: if "no-duplicates", the edges are not created if there is an edge of the same type between the two vertices</p>
</li>
<li>
<p><code>@strategy</code>: represents the strategy to use when the record with the configured <code>@id</code> already exists By default the existent record is used, but the "merge" strategy allows to merge the current record with the existent one.
The current properties will overwrite the existent ones</p>
</li>
<li>
<p><code>@in</code>: used for edges and represents the destination vertex for the edge</p>
</li>
<li>
<p><code>@ignore</code>: ignore the property, do not import into the database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note the "id" property in the manager is taken by using <code>"&lt;../ManagerID&gt;"</code> that means get the property "ManagerID" from the parent (<code>../</code>).</p>
</div>
<div class="paragraph">
<p>How to import a JSON file with a hierarchical structure? Let&#8217;s look at the second example coming from the JSON export of food and nutrients from the <a href="https://fdc.nal.usda.gov/download-datasets.html">U.S. DEPARTMENT OF AGRICULTURE website (USDA)</a>.
USDA provides updated files to download in both CSV and JSON format.</p>
</div>
<div class="paragraph">
<p>First, create a new database "food" by using the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>~/arcadedb $ create database food</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>import database https://fdc.nal.usda.gov/fdc-datasets/FoodData_Central_foundation_food_json_2022-10-28.zip
with mapping = {
	"FoundationFoods": [{
		"@cat": "v",
		"@type": "&lt;foodClass&gt;",
		"foodNutrients": [{
			"@cat": "e",
			"@type": "HAS_NUTRIENT",
			"@in": "nutrient",
			"@cardinality": "no-duplicates",
			"nutrient": {
				"@cat": "v",
				"@type": "Nutrient",
				"@id": "id",
				"@idType": "long",
				"@strategy": "merge"
			},
			"foodNutrientDerivation": "@ignore"
		}],
		"inputFoods": [{
			"@cat": "e",
			"@type": "INPUT",
			"@in": "inputFood",
			"@cardinality": "no-duplicates",
			"inputFood": {
				"@cat": "v",
				"@type": "&lt;foodClass&gt;",
				"@id": "fdcId",
				"@idType": "long",
				"@strategy": "merge",
				"foodCategory": {
					"@cat": "e",
					"@type": "HAS_CATEGORY",
					"@cardinality": "no-duplicates",
					"@in": {
						"@cat": "v",
						"@type": "FoodCategory",
						"@id": "id",
						"@idType": "long",
						"@strategy": "merge"
					}
				}
			}
		}]
	}]
}</code></pre>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/json-import.png" alt="json import">
</div>
</div>
<div class="paragraph">
<p>This command downloads the zip file from the USDA website and uses the mapping to create the graph from the JSON file.</p>
</div>
<div class="paragraph">
<p>The mapping file is a JSON snippet with directives about what to import, what to ignore and how to map edges with JSON objects.
Below all the supported tags:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@cat</code>: is the category of record to use between "v" for vertex, "e" for edge and "d" for document</p>
</li>
<li>
<p><code>@type</code>: is the type name to use on record creation.
If the type doesn&#8217;t exist, it&#8217;s implicitly created during the import</p>
</li>
<li>
<p><code>@id</code>: is the property that works as primary key. if not already defined, a unique index is created on the configured <code>@id</code> property</p>
</li>
<li>
<p><code>@idType</code>: is the type of the primary key in the <code>@id</code> property.
If not defined, the type is taken from the first value found.
In case of numbers, the JSON parser always uses DOUBLE as a type.
You can, for example, use LONG to force using LONG instead of DOUBLE</p>
</li>
<li>
<p><code>@cardinality</code>: if "no-duplicates", the edges are not created if there is an edge of the same type between the two vertices</p>
</li>
<li>
<p><code>@strategy</code>: represents the strategy to use when the record with the configured <code>@id</code> already exists By default the existent record is used, but the "merge" strategy allows to merge the current record with the existent one.
The current properties will overwrite the existent ones</p>
</li>
<li>
<p><code>@in</code>: used for edges and represents the destination vertex for the edge</p>
</li>
<li>
<p><code>@ignore</code>: ignore the property, do not import into the database</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="OrientDB-Importer">6.4.3. OrientDB Importer</h4>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/tools/orientdb-importer.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB is able to import a database exported from OrientDB in JSON format.</p>
</div>
<div class="paragraph">
<p>For more information about how to export a database from OrientDB, look at <a href="http://orientdb.com/docs/3.1.x/console/Console-Command-Export.html">Export Database</a>.</p>
</div>
<div class="paragraph">
<p>To import a database use the <a href="#SQL-Import-Database">Import Database</a> command from API, Studio or Console. Below you can find an example of importing a OrientDB database by using ArcadeDB <a href="#Console">Console</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ create database MyDatabase
~/arcadedb $ import database file:///temp/orientdb-export.tgz</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Neo4j-Importer">6.4.4. Neo4j Importer</h4>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/tools/neo4j-importer.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB is able to import a database exported from Neo4j in JSONL format (one json per line).</p>
</div>
<div class="paragraph">
<p>To export a Neo4j database follow the instructions in <a href="https://neo4j.com/labs/apoc/4.3/export/json/">Export in JSON</a>.
The resulting file contains one json per line.</p>
</div>
<div class="paragraph">
<p>Neo4j supports multiple labels per node, while in ArcadeDB a node (vertex) must have only one type.
The Neo4j importer will simulate multiple labels by creating new types with the following name: <code>&lt;label1&gt;[_&lt;labelN&gt;]*</code>.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{"type":"node","id":"1","labels":["User", "Administrator"],"properties":{"name":"Jim","age":42}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This vertex will be created in ArcadeDB with type "Administrator_User" (the labels are always sorted alphabetically) that extends both "Administrator" and "User" types.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>graph g {
    "Administrator_User" -- "Administrator"
    "Administrator_User" -- "User"
}</pre>
</div>
</div>
<div class="paragraph">
<p>In this way you can use the polymorphism of ArcadeDB to retrieve all the nodes of type "User" and the record of User and all its subtypes will be returned.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>Example of importing the following mini graph exported from Neo4j.
This is the example taken from Neo4j documentation about Export to JSON.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{"type":"node","id":"0","labels":["User"],"properties":{"born":"2015-07-04T19:32:24","name":"Adam","place":{"crs":"wgs-84","latitude":33.46789,"longitude":13.1,"height":null},"age":42,"male":true,"kids":["Sam","Anna","Grace"]}}
{"type":"node","id":"1","labels":["User"],"properties":{"name":"Jim","age":42}}
{"type":"node","id":"2","labels":["User"],"properties":{"age":12}}
{"id":"0","type":"relationship","label":"KNOWS","properties":{"since":1993,"bffSince":"P5M1DT12H"},"start":{"id":"0","labels":["User"]},"end":{"id":"1","labels":["User"]}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the file contains one json per line.
First all the nodes (vertices), then the relationships (edges).</p>
</div>
<div class="paragraph">
<p>To import a database use the <a href="#SQL-Import-Database">Import Database</a> command from API, Studio or Console. Below you can find an example of importing the Neo4j&#8217;s PanamaPapers database by using ArcadeDB <a href="#Console">Console</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ create database PanamaPapers
~/arcadedb $ import database file:///temp/panama-papers-neo4j.jsonl

ArcadeDB 21.9.1 - Neo4j Importer
Importing Neo4j database from file 'panama-papers-neo4j.jsonl' to 'databases/PanamaPapers'
Creation of the schema: types, properties and indexes
- Creation of vertices started
- Creation of vertices completed: created 3 vertices, skipped 1 edges (0 vertices/sec elapsed=0 secs)
- Creation of edges started: creating edges between vertices
- Creation of edged completed: created 1 edges, (0 edges/sec elapsed=0 secs)
**********************************************************************************************
Import of Neo4j database completed in 0 secs with 0 errors and 0 warnings.

SUMMARY

- Vertices.............: 0
-- User                : 3
- Edges................: 0
-- KNOWS               : 1
- Total attributes.....: 9
**********************************************************************************************

NOTES:
- you can find your new ArcadeDB database in 'databases/PanamaPapers'</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Upgrade">6.5. Upgrade ArcadeDB</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/tools/upgrade.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB is able to automatically upgrade a database when a newer version of ArcadeDB is used.
The migration is completely automatic and transparent.</p>
</div>
<div class="sect3">
<h4 id="_steps">6.5.1. Steps</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download and extract a newer version of ArcadeDB in the local file system</p>
</li>
<li>
<p>Stop any ArcadeDB running servers (or close manually the database by using the HTTP command <a href="#HTTP-CloseDatabase">Close a database (POST)</a>).</p>
</li>
<li>
<p>Copy the databases directory from the old server to the new one</p>
</li>
<li>
<p>Start the new server</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_downgrade_arcadedb">6.6. Downgrade ArcadeDB</h3>
<div class="paragraph">
<p>In the case you need to downgrade to an older version of ArcadeDB, check the binary compatibility between the versions.
ArcadeDB uses the <a href="https://semver.org">semantic versioning</a> with 100% compatibility for migration of databases up or down between patch version (the Z in X.Y.Z). To downgrade to a minor or major, the safest way is to export the database with the newest version and re-import the database with the older version.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="API">7. API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The power of a Multi-Model database is also in the way you can interact with it.
ArcadeDB supports multiple languages, so it&#8217;s easier to use it coming from other DBMS.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Java-API">JVM Embedded API</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL">SQL</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Gremlin-API">Apache Gremlin</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Open-Cypher">Cypher</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#GraphQL">GraphQL</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#MongoDB-API">MongoDB Query</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Redis-API">Redis</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Speed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* * *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flexibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* * *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for Documents</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for Graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embedded mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes via <a href="#HTTP-API">HTTP/JSON</a> and <a href="#Postgres-Driver">Postgres Driver</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes via <a href="#Gremlin-Server">Gremlin Server</a>, <a href="#HTTP-API">HTTP/JSON</a> and <a href="#Postgres-Driver">Postgres Driver</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes via <a href="#Gremlin-Server">Gremlin Server</a>, <a href="#HTTP-API">HTTP/JSON</a> and <a href="#Postgres-Driver">Postgres Driver</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes via <a href="#HTTP-API">HTTP/JSON</a> and <a href="#Postgres-Driver">Postgres Driver</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes via <a href="#MongoDB-Protocol">MongoDB Protocol plugin</a>, <a href="#HTTP-API">HTTP/JSON</a> and <a href="#Postgres-Driver">Postgres Driver</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes via <a href="#Redis-Protocol">Redis Protocol plugin</a></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="Drivers">7.1. Drivers</h3>
<div class="paragraph">
<p>ArcadeDB provides <a href="#HTTP-API">HTTP API</a> to interface to the server from a remote application. You can use any programming language that supports HTTP calls (pretty much any language) or use a driver to have a little abstraction over <a href="#HTTP-API">HTTP API</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 60%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Language</th>
<th class="tableblock halign-left valign-top">Project URL</th>
<th class="tableblock halign-left valign-top">License</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bundled with the project. Look at <code>Remote Database</code> class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHICKEN Scheme</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://wiki.call-cc.org/eggref/5/arcadedb" class="bare">http://wiki.call-cc.org/eggref/5/arcadedb</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">zlib-acknowledgement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.NET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/tetious/ArcadeDb.Client" class="bare">https://github.com/tetious/ArcadeDb.Client</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ruby</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/topofocus/arcadedb" class="bare">https://github.com/topofocus/arcadedb</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MIT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://crates.io/crates/arcadedb-rs" class="bare">https://crates.io/crates/arcadedb-rs</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache 2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="Java-API">7.2. Java API (Embedded)</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/java-api.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Add the following dependency in your Maven pom.xml file under the tag <code>&lt;dependencies&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.arcadedb&lt;/groupId&gt;
    &lt;artifactId&gt;arcadedb-engine&lt;/artifactId&gt;
    &lt;version&gt;23.3.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
ArcadeDB works in both synchronous and asynchronous modes.
By using the asynchronous API you let to ArcadeDB to use all the resources of your hw/sw configuration without managing multiple threads.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#Database">Synchronous API</a></th>
<th class="tableblock halign-left valign-top"><a href="#DatabaseAsyncExecutor">Asynchronous API</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Synchronous API executes the operation immediately, by the current thread, and returns when it&#8217;s finished. If you use a procedural approach, using the synchronous API is the easiest way to use ArcadeDB. In order to use all the resource of your machine, you might use multi-threading in your application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Asynchronous API schedules jobs to be executed as soon as possible by a pool of threads. ArcadeDB optimizes the usage of asynchronous threads pool to be equals to the number of cores found in the machine (you can modify it via API). Use Asynchronous API if the response of the operation can be managed in asynchronous way. Thanks to the asynchronous API, your application doesn&#8217;t need to be multi-threads to use all the available cores.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="Java-Tutorial">7.2.1. 10-Minute Tutorial</h4>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/java-tutorial.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>You can create a new database from scratch or open an existent one.
Most of the API works in both synchronous and asynchronous modes.
The asynchronous API are available from the <code>&lt;db&gt;.async()</code> object.</p>
</div>
<div class="paragraph">
<p>To start from scratch, let&#8217;s create a new database.
The entry point it&#8217;s the <code><a href="#DatabaseFactory">DatabaseFactory</a></code> class that allows to create and open a database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DatabaseFactory arcade = new DatabaseFactory("/databases/mydb");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pass the path in the file system where you want the database to be stored.
In this case a new directory 'mydb' will be created under the path "/databases/" of your file system.
You can also use a relative path like "databases/mydb".</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A <code><a href="#DatabaseFactory">DatabaseFactory</a></code> object doesn&#8217;t hold the <code><a href="#Database">Database</a></code> instances.
It&#8217;s up to you to close them once you have finished.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_create_a_new_database">Create a new database</h5>
<div class="paragraph">
<p>To create a new database from scratch, use the <code>.create()</code> method in <code><a href="#DatabaseFactory">DatabaseFactory</a></code> class.
If the database already exists, an exception is thrown.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DatabaseFactory databaseFactory = new DatabaseFactory("/databases/mydb");
try( Database db = databaseFactory.create(); ){
  // YOUR CODE
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The database instance <code>db</code> is ready to be used inside the try block.
The <code><a href="#Database">Database</a></code> instance extends Java7 <code>AutoClosable</code> interface, that means the database is closed automatically when the Database variable reaches out of the scope.</p>
</div>
</div>
<div class="sect4">
<h5 id="_open_an_existent_database">Open an existent database</h5>
<div class="paragraph">
<p>If you want to open an existent database, use the <code>open()</code> method instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DatabaseFactory databaseFactory = new DatabaseFactory("/databases/mydb");
try( Database db = databaseFactory.open(); ){
  // YOUR CODE
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default a database is open in <code>READ_WRITE</code> mode, but you can open it in <code>READ_ONLY</code> in this way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">databaseFactory.open(PaginatedFile.MODE.READ_ONLY);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using <code>READ_ONLY</code> denys any changes to the database.
This is the suggested method if you&#8217;re going to execute reads and queries only.
Or if you are opening a database from a read-only file system like a DVD or a shared read-only directory.
By letting know to ArcadeDB that you&#8217;re not changing the database, a lot of optimizations will be used, like in a distributed high-available configuration a REPLICA server could be used instead of the busy MASTER.</p>
</div>
<div class="paragraph">
<p>If you open a database in READ_ONLY mode, no lock file is created, so the same database could be opened in READ_ONLY mode by another process at the same time.</p>
</div>
</div>
<div class="sect4">
<h5 id="_write_your_first_transaction">Write your first transaction</h5>
<div class="paragraph">
<p>Either if you create or open a database, in order to use it, you have to execute your code inside a transaction, in this way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( (tx) -&gt; {
    // YOUR CODE HERE
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the database&#8217;s auto-close and the <code>transaction()</code> method allows to forget to manage begin/commit/rollback/close operations like you would do with a normal DBMS.
Anyway, you can control the transaction with explicit methods if you prefer.
This code block is equivalent to the previous one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Database db = databaseFactory.open();
try {
  db.begin();

  // YOUR CHANGES HERE

  db.commit();

} catch (Exception e) {
  db.rollback();
} finally {
  db.close();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Remember that every change in the database must be executed inside a transaction.
ArcadeDB is a fully transactional DBMS, ACID compliant.
The usage of transactions is like with a Relational DBMS: <code>.begin()</code> starts a new transaction and <code>.commit()</code> commits all the changes in the database unless there is an error (like a conflict on updating the same record), then the entire transaction will be automatically rollbacked and none of your changes will be in the database.
In case you want to manually rollback the transaction at a certain point (like when you have an error in your application code), you can call <code>.rollback()</code>.</p>
</div>
<div class="paragraph">
<p>Once you have your database instance (in this tutorial the variable <code>db</code> is used), you can create/update/delete records and execute queries.</p>
</div>
</div>
<div class="sect4">
<h5 id="_write_your_first_document_object">Write your first document object</h5>
<div class="paragraph">
<p>Let&#8217;s start now populating the database by creating our first document of type "Customer".
What is a document?
A Document is like a map of entries.
They can be nested and entries can have different types of values, such as Strings, Integers, Floats, etc.
You can think to a document like a JSON Document but it&#8217;s stored in a binary form in the database.
By the way, if you use JSON in your application, ArcadeDB provides easy API to convert a document to and from JSON.</p>
</div>
<div class="paragraph">
<p>In ArcadeDB it&#8217;s mandatory to specify a type when you want tot create a document, a vertex or an edge.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s create the new document type "Customer" without any properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    // CREATE THE CUSTOMER TYPE
    db.getSchema().createDocumentType("Customer");
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the "Customer" type has been created, we can create our first document:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    // CREATE A CUSTOMER INSTANCE
    MutableDocument customer = db.newDocument("Customer");
    customer.set("name", "Jay");
    customer.set("surname", "Miner");
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can create types and records in the same transaction.</p>
</div>
</div>
<div class="sect4">
<h5 id="_execute_a_query">Execute a Query</h5>
<div class="paragraph">
<p>Once we have our database populated, how to extract data from it?
Simple, with a query.
Example of executing a prepared query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    ResultSet result = db.query("SQL", "select from V where age &gt; ? and city = ?", 18, "Melbourne");
    while (result.hasNext()) {
      Result record = result.next();
      System.out.println( "Found record, name = " + record.getProperty("name"));
    }
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first parameter of the query method is the language to be used.
In this case the common "SQL" is used.
You can also use Gremlin or other language that will be supported in the future.</p>
</div>
<div class="paragraph">
<p>The prepared statement is cached in the database, so further executions will be faster than the first one.
With prepared statements, the parameters can be passed in positional way, like in this case, or with a <code>Map&lt;String,Object&gt;</code> where the keys are the parameter names and the values the parameter values.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    Map&lt;String,Object&gt; parameters = new HashMap&lt;&gt;();
    parameters.put( "age", 18 );
    parameters.put( "city", "Melbourne" );

    ResultSet result = db.query("SQL", "select from V where age &gt; :age and city = :city", parameters);
    while (result.hasNext()) {
      Result record = result.next();
      System.out.println( "Found record, name = " + record.getProperty("name"));
    }
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By using a map, parameters are referenced by name (<code>:age</code> and <code>:city</code> in this example).</p>
</div>
</div>
<div class="sect4">
<h5 id="_create_a_graph">Create a Graph</h5>
<div class="paragraph">
<p>Now that we&#8217;re familiar with the most basic operations, let&#8217;s see how to work with graphs.
Before creating our vertices and edges, we have to create both vertex and edge types beforehand.
In our example, we&#8217;re going to create a minimal social network with "User" type for vertices and "IsFriendOf" to map the friendship relationship:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    // CREATE THE ACCOUNT TYPE
    db.getSchema().createVertexType("User");
    db.getSchema().createEdgeType("IsFriendOf");
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s create two "Profile" vertices and let&#8217;s connect them with the friendship relationship "IsFriendOf", like in the chart below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>graph g {
    Elon -- Steve [label = "IsFriendOf" dir = "both"]
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    MutableVertex elon = db.newVertex("User", "name", "Elon", "lastName", "Musk");
    MutableVertex steve = db.newVertex("User", "name", "Steve", "lastName", "Jobs");
    elon.newEdge("IsFriendOf", steve, true, "since", 2010);
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the code snipped above, we have just created our first graph, made of 2 vertices and one edge that connects them.
Note the 3rd parameter in the <code>newEdge()</code> method.
It&#8217;s telling to the Graph engine that we want a bidirectional edge.
In this way, even if the direction is still from the "Elon" vertex to the "Steve" vertex, we can traverse the edge from both sides.
Use always bidirectional unless you want to avoid creating super-nodes when it&#8217;s necessary to traverse only from one side.
Note also that we stored a property "since = 2010" in the edge.
That&#8217;s right, edges can have properties like vertices.</p>
</div>
</div>
<div class="sect4">
<h5 id="_traverse_the_graph">Traverse the Graph</h5>
<div class="paragraph">
<p>What do you do with a brand new graph?
Traversing, of course!</p>
</div>
<div class="paragraph">
<p>You have basically three ways to do that (<a href="#Java-API">Java API</a>, <a href="#SQL">SQL</a>, <a href="https://tinkerpop.apache.org/">Apache Gremlin</a> and <a href="https://opencypher.org/">Open Cypher</a>) each one with its pros/cons:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Java-API">JVM Embedded API</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL">SQL</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Gremlin-API">Apache Gremlin</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Open-Cypher">Cypher</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Speed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* * *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flexibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* * *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* *</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embedded mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes (through the <a href="#Gremlin-Server">Gremlin Server</a> plugin)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes (through the <a href="#Gremlin-Server">Gremlin Server</a> plugin)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When using the API, when the SQL and Apache Gremlin?
The API is the very code based.
You have total control on the query/traversal.
With the SQL, you can combine the SELECT with the MATCH statement to create powerful traversals in a just few lines.
You could use Apache Gremlin if you&#8217;re coming from another GraphDB that supports this language.</p>
</div>
<div class="sect5">
<h6 id="_traverse_via_api">Traverse via API</h6>
<div class="paragraph">
<p>In order to start traversing a graph, you need your root vertex (in some cases you want to start from multiple root vertices).
You can load your root vertex by its RID (Record ID), via the indexes properties or via a SQL query.</p>
</div>
<div class="paragraph">
<p>Loading a record by its RID it&#8217;s the fastest way and the execution time remains constants with the growing of the database (algorithm complexity: <code>O(1)</code>).
Example of lookup by RID:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    // #10:232 in our example is Elon Musk's RID
    Vertex elon = db.lookupByRID( new RID(db, "#10:232"), true );
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to have a quick lookup, it&#8217;s always suggested to create an index against one or multiple properties.
In our case, we could index the properties "name" and "lastName" with 2 separate indexes, or indeed, creating a composite index with both properties.
In this case the algorithm complexity is <code>O(LogN)</code>).
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    db.getSchema().createTypeIndex(SchemaImpl.INDEX_TYPE.LSM_TREE, false, "Profile", new String[] { "name", "lastName" });
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we&#8217;re able to load Steve&#8217;s vertex in a flash by using this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    Vertex steve = db.lookupByKey( "Profile", new String[]{"name", "lastName"}, new String[]{"Steve", "Jobs"} );
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Remember that loading a record by its RID is always faster than looking up from an index.
What about the query approach?
ArcadeDB supports SQL, so try this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    ResultSet result = db.query( "SQL", "select from Profile where name = ? and lastName = ?", "Steve", "Jobs" );
    Vertex steve = result.next();
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the query approach, if an existent index is available, then it&#8217;s automatically used, otherwise a scan is executed.</p>
</div>
<div class="paragraph">
<p>Now that we have loaded the root vertex in memory, we&#8217;re ready to do some traversal.
Before looking at the API, it&#8217;s important to understand every edge has a direction: from vertex A to vertex B.
In the example above, the direction of the friendship is from "Elon" to "Steve".
While in most of the cases the direction is important, sometimes, like with the friendship, it doesn&#8217;t really matter the direction because if A is friend with B, it&#8217;s true also the opposite.</p>
</div>
<div class="paragraph">
<p>In our example, the relationship is <code>Elon ---Friend--&#8594; Steve</code>.
This means that if I want to retrieve all Elon&#8217;s friends, I could start from the vertex "Elon" and traverse all the <strong>outgoing</strong> edges of type "IsFriendOf".</p>
</div>
<div class="paragraph">
<p>Instead, if I want to retrieve all Steve&#8217;s friends, I could start from Steve as root vertex and traverse all the <strong>incoming</strong> edges.</p>
</div>
<div class="paragraph">
<p>In case the direction doesn&#8217;t really matters (like with friendship), I could consider <strong>both</strong> outgoing and incoming.</p>
</div>
<div class="paragraph">
<p>So the basic traversal operations from one or more vertices, are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>outgoing, expressed as <code>OUT</code></p>
</li>
<li>
<p>incoming, expressed as <code>IN</code></p>
</li>
<li>
<p>both, expressed as <code>BOTH</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to load Steve&#8217;s friends, this is the example by using API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    Vertex steve; // ALREADY LOADED VIA RID, KEYS OR SQL
    Iterable&lt;Vertex&gt; friends = steve.getVertices(DIRECTION.IN, "IsFriendOf" );
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead, if I start from Elon&#8217;s vertex, it would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    Vertex elon; // ALREADY LOADED VIA RID, KEYS OR SQL
    Iterable&lt;Vertex&gt; friends = elon.getVertices(DIRECTION.OUT, "IsFriendOf");
  });
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_traverse_via_sql">Traverse via SQL</h6>
<div class="paragraph">
<p>By using SQL, you can do the traversal by using SELECT:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    ResultSet friends = db.query( "SQL", "SELECT expand( out('IsFriendOf') ) FROM Profile WHERE name = ? AND lastName = ?", "Steve", "Jobs" );
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or with the more powerful MATCH statement:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = databaseFactory.open(); ){
  db.transaction( () -&gt; {
    ResultSet friends = db.query( "SQL", "MATCH {type: Profile, as: Profile, where: (name = ? and lastName = ?)}.out('IsFriendOf') {as: Friend} RETURN Friend", "Steve", "Jobs" );
  });
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_traverse_via_apache_gremlin">Traverse via Apache Gremlin</h6>
<div class="paragraph">
<p>Since ArcadeDB is 100% compliant with Gremlin 3.6.x, you can run this query against the Apache <a href="#Gremlin-Server">Gremlin Server</a> configured with ArcadeDB:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gremlin" data-lang="gremlin">g.V().has('name','Steve').has('lastName','Jobs').out('IsFriendOf');</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about Apache Gremlin see: <a href="#Gremlin-API">Gremlin API</a> support</p>
</div>
</div>
<div class="sect5">
<h6 id="_traverse_via_open_cypher">Traverse via Open Cypher</h6>
<div class="paragraph">
<p>ArcadeDB supports also Open Cypher.
The same query would be the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (me)-[:IsFriendOf]-(friend)
WHERE me.name = 'Steve' and me.lastName = 'Jobs'
RETURN friend.name, friend.lastName</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about Cypher see: <a href="#Open-Cypher">Cypher</a> support</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_schema">7.2.2. Schema</h4>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/java-schema.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB can work in schema-less mode (like most of NoSQL DBMS), schema-full (like with RDBMS) or hybrid.
The main API to manage the schema is the Schema interface you can obtain by calling the API <a href="#_getschema"><code>db.getSchema()</code></a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Schema schema = db.getSchema();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before creating any record it&#8217;s mandatory to define a type.
If you&#8217;re going to create a new Document, then you need a Document Type.
The same applies for Vertex &#8594; Vertex Type and Edge &#8594; Edge Type.</p>
</div>
<div class="paragraph">
<p>The specific API to manage document types in the Schema interface are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DocumentType createDocumentType(String typeName);
DocumentType createDocumentType(String typeName, int buckets);
DocumentType createDocumentType(String typeName, int buckets, int pageSize);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>typeName</code> is the name of the type</p>
</li>
<li>
<p><code>buckets</code> is the number of buckets to create.
A bucket is like a file.
If not specified, the number of available cores is used</p>
</li>
<li>
<p><code>pageSize</code> is the page size for the file.
If not specified is 65K.
Pay attention to this value.
In case of large objects to store, you need to increase the page size or the record won&#8217;t be stored, throwing an exception.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To manage vertex types, the API are similar as for the document types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">VertexType createVertexType(String typeName);
VertexType createVertexType(String typeName, int buckets);
VertexType createVertexType(String typeName, int buckets, int pageSize);</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the same for edge types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">EdgeType createEdgeType(String typeName);
EdgeType createEdgeType(String typeName, int buckets);
EdgeType createEdgeType(String typeName, int buckets, int pageSize);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to retrieve and removing a type, API common to any record type are provided:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Collection&lt;DocumentType&gt; getTypes();
DocumentType             getType(String typeName);
void                     dropType(String typeName);
String                   getTypeNameByBucketId(int bucketId);
DocumentType             getTypeByBucketId(int bucketId);
boolean                  existsType(String typeName);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_working_with_buckets">7.2.3. Working with buckets</h4>
<div class="paragraph">
<p>A bucket is like a file.
A type can rely on one or multiple buckets.
Why using multiple buckets?
Because ArcadeDB could lock a bucket for certain operations.
Having multiple buckets allows to go in parallel with a multi-cpus and multi-cores architecture.</p>
</div>
<div class="paragraph">
<p>The specific API to manage buckets are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Bucket             createBucket(String bucketName);
boolean            existsBucket(String bucketName);
Bucket             getBucketById(int id);
Bucket             getBucketByName(String name);
Collection&lt;Bucket&gt; getBuckets();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Java-Indexes">7.2.4. Working with indexes</h4>
<div class="paragraph">
<p>Like any other DBMS, ArcadeDB has indexes.
Even if indexes are not used to manage relationships (because ArcadeDB has a native GraphDB engine based on links), indexes are fundamental for a quick lookup of records by one or multiple properties.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
By default null values are not indexed, so any query that is looking for null values will not use the index but instead result in a full scan.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ArcadeDB provides automatic and manual indexes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>automatic</code> that are updated automatically when you work with records</p>
</li>
<li>
<p><code>manual</code> are detached from a type and the user is totally responsible to insert and remove entries into and from the index</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>Schema</code> API to manage indexes are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TypeIndex createTypeIndex(SchemaImpl.INDEX_TYPE indexType, boolean unique, String typeName, String[] propertyNames);

TypeIndex createTypeIndex(SchemaImpl.INDEX_TYPE indexType, boolean unique, String typeName, String[] propertyNames, int pageSize);

TypeIndex createTypeIndex(EmbeddedSchema.INDEX_TYPE indexType, boolean unique, String typeName, String[] propertyNames, int pageSize, Index.BuildIndexCallback callback);

TypeIndex createTypeIndex(EmbeddedSchema.INDEX_TYPE indexType, boolean unique, String typeName, String[] propertyNames, int pageSize, LSMTreeIndexAbstract.NULL_STRATEGY nullStrategy, Index.BuildIndexCallback callback);

boolean existsIndex(String indexName);

Index[] getIndexes();

Index   getIndexByName(String indexName);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>indexName</code> is the name of the index</p>
</li>
<li>
<p><code>indexType</code> can be:</p>
<div class="ulist">
<ul>
<li>
<p><code>LSM_TREE</code>, implemented as a <a href="https://en.wikipedia.org/wiki/Log-structured_merge-tree">Log Structured Merge tree</a></p>
</li>
<li>
<p><code>FULL_TEXT</code>, that uses <a href="https://lucene.apache.org/solr/guide/6_6/understanding-analyzers-tokenizers-and-filters.html">Lucene&#8217;s Analyzers</a> for tokenizing, stemming and categorize words inside a text.
Internally it&#8217;s managed as a LSM_TREE</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>unique</code> tells if the entries in the index must be unique or they can be repeated</p>
</li>
<li>
<p><code>typeName</code> is the name of the type (document, vertex or edge) where the index must be applied</p>
</li>
<li>
<p><code>propertyNames</code> is the array of property names to index. In case of more than one property is used, the index is composed. Property names may also reference a document type&#8217;s <a href="#Inheritance">polymorphic properties</a></p>
</li>
<li>
<p><code>pageSize</code> is the page size.
If not specified, the default of 2MB is used</p>
</li>
<li>
<p><code>nullStrategy</code> can be:</p>
<div class="ulist">
<ul>
<li>
<p><code>SKIP</code> ignores all null values when creating and reading an index, this is the default.</p>
</li>
<li>
<p><code>ERROR</code> throws an exception when creating or reading a null value indexed property.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>callback</code> is a 2 argument Functional interface called when each <code>Document</code> is added to this index. <em>This is most likely only useful for internal use cases</em>. The callback receives the <code>Document</code> just indexed, and a running count of the total number of documents indexed in the bucket.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The API above sometimes returns <code>TypeIndex</code> vs <code>Index</code>. The more general <code>getIndexes</code> and <code>getIndexByName</code> methods return <code>Index</code> because the index migh be a bucket index or a type index. The <code>TypeIndex</code> should be useful in most cases, but sometimes it may be useful to work at the bucket level.</p>
</div>
<div class="paragraph">
<p>In addition to the <code>createTypeIndex</code> methods above, for each overload there is a matching <code>getOrCreateTypeIndex</code> method which returns an existing index rather than thowing an exception if a matching index is found. There are also matching index API creation methods available via the <code>DocumentType</code> for creating an index directly from a document type, rather than against the general <code>Schema</code> object. When using the <code>DocumentType</code> convenience variants <code>typeName</code> is provided automatically.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
An index is unique to a set of property names per document type. Any attempt to create a second index on a non-unique set of [<code>typeName</code>, <code>propertyNames</code>] will throw an exception using the <code>createTypeIndex</code> method variants.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A special mention goes for the method <code>createManualIndex()</code> that creates indexes not attached to any type (manual):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Index createManualIndex(SchemaImpl.INDEX_TYPE indexType, boolean unique, String indexName, com.arcadedb.schema.Type[] keyTypes, int pageSize);</code></pre>
</div>
</div>
<div class="paragraph">
<p>While by default indexes are updated automatically when you work with records, in this case, the user is totally responsible to insert and remove entries into and from the index.</p>
</div>
<div class="sect4">
<h5 id="_indexing_edges">Indexing Edges</h5>
<div class="paragraph">
<p>Like any other document type, indexes may be defined for <code>Edge</code> types as well. If the property name for the index is either <code>@out</code> or <code>@in</code>, the index property will be a <code>LINK</code> type on the adjacently referenced <code>Vertex</code>.</p>
</div>
<div class="paragraph">
<p>The <code>LINK</code> type represents @RIDs (like #13:222). Usually creating <code>LINK</code> indexes is meant for indexing incoming/outgoing edges in order to prevent <a href="https://en.wikipedia.org/wiki/Multigraph">multigraphs</a> (i.e. duplicates edges between the same vertex pairs).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_database_configuration">7.2.5. Database Configuration</h4>
<div class="paragraph">
<p>ArcadeDB stores the database configuration into the schema and allows to change things like the timezone, the format of dates and the encoding:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TimeZone getTimeZone();
void     setTimeZone(TimeZone timeZone);
String   getDateFormat();
void     setDateFormat(String dateFormat);
String   getDateTimeFormat();
void     setDateTimeFormat(String dateTimeFormat);
String   getEncoding();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_embedded_documents">7.2.6. Embedded Documents</h4>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/java-embeddeddoc.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB is a Multi-Model database with a full support for documents.
The nice thing about documents (and Document Databases) is that they can have embedded documents.
This feature is very powerful.
In some cases is preferable to embed documents instead of connect them by using a graph.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "firstName": "Jay",
  "lastName": "Miner",
  "worksAt": {
    "companyName": "Commodore",
    "since": "1982"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Below you can find the code to create such document by using the Java API.
Note the creation of the types at the beginning:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.transaction( (tx) -&gt; {
  // CREATE THE SCHEMA (NEED ONLY ONCE BEFORE CREATING RECORDS)
  DocumentType employee = db.getSchema().createDocumentType("Employee");
  DocumentType company = db.getSchema().createDocumentType("Company");

  // CREATE DOCUMENTS
  MutableDocument jay = db.newDocument("Employee", "firstName", "Jay", "lastName", "Miner");

  EmbeddedDocument commodore = jay.newEmbeddedDocument("Company", "worksAt").set("compamyName", "Commodore", "since", 2010);

  commodore.save();
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Modeling with a graph it would be something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>graph g {
    "Jay Miner" -- "Commodore" [label = "WorksAt(since: 1982)"]
}</pre>
</div>
</div>
<div class="paragraph">
<p>And this woud be the code to create the types and the graph.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.transaction( (tx) -&gt; {
  // CREATE THE SCHEMA (NEED ONLY ONCE BEFORE CREATING RECORDS)
  VertexType employee = db.getSchema().createVertexType("Employee");
  VertexType company = db.getSchema().createVertexType("Company");
  EdgeType worksAt = db.getSchema().createEdgeType("WorksAt");

  // CREATE THE GRAPH
  MutableVertex jay = db.newVertex("Employee", "firstName", "Jay", "lastName", "Miner").save();
  MutableVertex commodore = db.newVertex("Company", "name", "Commodore").save();
  jay.newEdge("WorksAt", commodore, "since", 2010);
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>With ArcadeDB Multi-Model DBMS you can have vertices with embedded documents linked to other vertices through edges.
Check out this example that uses a graph to connect Employee with Company, but keeps the addresses as embedded documents.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.transaction( (tx) -&gt; {
  // CREATE THE SCHEMA (NEED ONLY ONCE BEFORE CREATING RECORDS)
  VertexType employee = db.getSchema().createVertexType("Employee");
  VertexType company = db.getSchema().createVertexType("Company");
  EdgeType worksAt = db.getSchema().createEdgeType("WorksAt");
  DocumentType address = db.getSchema().createDocumentType("Address");

  // CREATE THE GRAPH + EMBEDDED DOCUMENTS
  MutableVertex jay = db.newVertex("Employee", "firstName", "Jay", "lastName", "Miner").save();
  jay.newEmbeddedDocument("Address", "residenceAddress", "city", "San Francisco", "state": "CA", "country": "USA");

  MutableVertex commodore = db.newVertex("Company", "name", "Commodore").save();
  commodore.newEmbeddedDocument("Address", "hqAddress", "city", "Palo Alto", "state": "CA", "country": "USA");
  commodore.newEmbeddedDocument("Address", "ukAddress", "city", "London", "state": "London", "country": "UK");

  jay.newEdge("WorksAt", commodore, "since", 2010);
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>To retrieve embedded documents, you can retrieve as any other properties.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.transaction( (tx) -&gt; {
  ResultSet result = db.query( "SQL", "select from Employee where firstName = ? and lastName = ?", "Jay", "Miner" );
  Vertex jay = result.next();

  EmbeddedDocument residenceAddress = (EmbeddedDocument) jay.get("residenceAddress");
  System.out.println( "Jay's lives in " + residenceAddress.getString("city") );
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Java-Events">7.2.7. Events</h4>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/java-events.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB allows hooking listener to the following events on records (vertices, edges, documents):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>before</strong> is <strong>created</strong>, by registering the interface <code>BeforeRecordCreateListener</code></p>
</li>
<li>
<p><strong>after</strong> is <strong>created</strong>, by registering the interface <code>AfterRecordCreateListener</code></p>
</li>
<li>
<p><strong>before</strong> is <strong>updates</strong>, by registering the interface <code>BeforeRecordUpdateListener</code></p>
</li>
<li>
<p><strong>after</strong> is <strong>updated</strong>, by registering the interface <code>AfterRecordUpdateListener</code></p>
</li>
<li>
<p><strong>before</strong> is <strong>deleted</strong>, by registering the interface <code>BeforeRecordDeleteListener</code></p>
</li>
<li>
<p><strong>after</strong> is <strong>deleted</strong>, by registering the interface <code>AfterRecordDeleteListener</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The listeners above can be installed and removed at database by using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.getEvents().registerListener()</code></pre>
</div>
</div>
<div class="paragraph">
<p>And at specific type level by using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.getSchema().getType(&lt;type-name&gt;).registerListener()</code></pre>
</div>
</div>
<div class="paragraph">
<p>All the interface listeners that work <strong>before</strong> a record is created, updated or deleted, require to return a boolean value.
If the callback returns <code>true</code>, the listener chain continues and all the following listeners are invoked.
If <code>false</code>, the chain of calls is interrupted and the operation is skipped with no errors.
In case an error is requested, the callback can throw an exception instead of returning false.</p>
</div>
<div class="paragraph">
<p>The typical use cases for the listeners are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>listen before a create or update to enhance the record with additional properties</p>
</li>
<li>
<p>listen before a create or update to validate properties and in case the record is not valid, returning false or an exception to avoid the operation is executed</p>
</li>
<li>
<p>execute cascade operations.
This is the typical use case for <code>AfterRecordDeleteListener</code> where a cascade deletion of multiple connected records can be executed</p>
</li>
<li>
<p>listen to after create, update and delete operations to propagate changes to the external or the webapp via web-socket.
This allows to have a reactive application that doesn&#8217;t poll the database for changes, but rather listens and receives updates as soon as they occur</p>
</li>
<li>
<p>implement custom profiling on changes to the database (by implementing "before" listeners)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example of <code>before-record-create</code> listener where vertices with "validated" field equal to false cannot be saved (callback returns false):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.getEvents().registerListener((BeforeRecordCreateListener)
  record -&gt; record instanceof Vertex &amp;&amp; record.asVertex().getBoolean("validated"));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same by only for vertex type "Client":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.getSchema().getType("Client").getEvents().registerListener((BeforeRecordCreateListener)
  record -&gt; record.asVertex().getBoolean("validated"));</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_java_reference">7.3. Java Reference</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/java-reference.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="sect3">
<h4 id="DatabaseFactory">7.3.1. <code>DatabaseFactory</code> Class</h4>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/java-ref-database-factory.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>It&#8217;s the entry point class that allows to create and open a database.
A <code>DatabaseFactory</code> object doesn&#8217;t keep any state and its only goal is creating a <a href="#Database">Database</a> instance.</p>
</div>
<div class="sect4">
<h5 id="_methods">Methods</h5>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DatabaseFactory factory = new DatabaseFactory("/databases/mydb");</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_close">close()</h6>
<div class="paragraph">
<p>Close a database factory.
This method frees some resources, but it&#8217;s not necessary to call it to unlock te databases.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void close()</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_exists">exists()</h6>
<div class="paragraph">
<p>Returns <code>true</code> if the database already exists, otherwise <code>false</code>.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">boolean exists()</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_database_create">Database create()</h6>
<div class="paragraph">
<p>Creates a new database.
If the database already exists, an exception is thrown.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DatabaseFactory arcade = new DatabaseFactory("/databases/mydb");
Database db = arcade.create();</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_database_open">Database open()</h6>
<div class="paragraph">
<p>Opens an existent database in READ_WRITE mode.
If the database does not exist, an exception is thrown.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>DatabaseFactory arcade = new DatabaseFactory("/databases/mydb");
try( Database db = arcade.open(); ) {
  // YOUR CODE
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_database_openmode_mode">Database open(MODE mode)</h6>
<div class="paragraph">
<p>Opens an existent database by specifying a mode between READ_WRITE and READ_ONLY mode.
If the database does not exist, an exception is thrown.
In READ_ONLY mode, any attempt to modify the database throws an exception.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>DatabaseFactory arcade = new DatabaseFactory("/databases/mydb");
Database db = arcade.open(MODE.READ_ONLY);
try {
  // YOUR CODE
} finally {
  db.close();
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Database">7.3.2. <code>Database</code> Interface</h4>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/java-ref-database.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>It&#8217;s the main class to operate with ArcadeDB.
To obtain an instance of Database, use the class <code><a href="#DatabaseFactory">DatabaseFactory</a></code>.</p>
</div>
<div class="sect4">
<h5 id="_methods_alphabetic_order">Methods (Alphabetic order)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_async">async()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_begin">begin()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_close">close()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_commit">commit()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_deleterecord-record">deleteRecord()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_drop">drop()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_getschema">getSchema()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_isopen">isOpen()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_iteratebucket-bucketname">iterateBucket()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_iteratetype-classname-polymorphic">iterateType()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_query-language-command-positionalparameters">query() positional parameters</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_query-language-command-parametermap">query() (parameter map)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_command-language-command-positionalparameters">command() positional parameters</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_command-language-command-parametermap">command() (parameter map)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_lookupbykey-type-properties-keys">lookupByKey()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_lookupbyrid-rid-loadcontent">lookupByRID()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_newdocument-typename">newDocument()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_newedgebykeys-sourcevertextype-sourcevertexkey-sourcevertexvalue-destinationvertextype-destinationvertexkey-destinationvertexvalue-createvertexifnotexist-edgetype-bidirectional-properties">newEdgeByKeys()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_newvertex-typename">newVertex()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_rollback">rollback()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_scanbucket-bucketname-callback">scanBucket()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_scantype-classname-polymorphic-callback">scanType()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_transaction-txblock">transaction() default</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_transaction-txblock-retries">transaction() with retries</a></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_methods_by_category">Methods (By category)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Transaction</th>
<th class="tableblock halign-left valign-top">Lifecycle</th>
<th class="tableblock halign-left valign-top">Query</th>
<th class="tableblock halign-left valign-top">Records</th>
<th class="tableblock halign-left valign-top">Misc</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_transaction-txblock">transaction() default</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_close">close()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_query-language-command-positionalparameters">query() positional parameters</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_newdocument-typename">newDocument()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_async">async()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_transaction-txblock-retries">transaction() with retries</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_drop">drop()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_query-language-command-parametermap">query() (parameter map)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_newvertex-typename">newVertex()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_command-language-command-positionalparameters">command() positional parameters</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_begin">begin()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_isopen">isOpen()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_lookupbykey-type-properties-keys">lookupByKey()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_newedgebykeys-sourcevertextype-sourcevertexkey-sourcevertexvalue-destinationvertextype-destinationvertexkey-destinationvertexvalue-createvertexifnotexist-edgetype-bidirectional-properties">newEdgeByKeys()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_command-language-command-parametermap">command() (parameter map)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_commit">commit()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_lookupbyrid-rid-loadcontent">lookupByRID()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_deleterecord-record">deleteRecord()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_getschema">getSchema()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_rollback">rollback()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_iteratetype-classname-polymorphic">iterateType()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_iteratebucket-bucketname">iterateBucket()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_scanbucket-bucketname-callback">scanBucket()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_scantype-classname-polymorphic-callback">scanType()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_async">async()</h6>
<div class="paragraph">
<p>It returns an instance of <code><a href="#DatabaseAsyncExecutor">DatabaseAsyncExecutor</a></code> to execute asynchronous calls.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DatabaseAsyncExecutor async()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>Execute an asynchronous query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.async().query("sql", "select from User", new AsyncResultsetCallback() {
  @Override
  public boolean onNext(Result result) {
    System.out.println( "Name = " + result.getProperty("name"));
    return true;
  }

  @Override
  public void onError(Exception exception) {
    System.err.println("Error on executing the query: " + exception );
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_begin">begin()</h6>
<div class="paragraph">
<p>Starts a transaction on the current thread.
Each thread can have only one active transaction.
All the modification to the database become persistent only at pending changes in the transaction are made persistent only when the <code><a href="#_commit">commit()</a></code> method is called.
ArcadeDB supports ACID transactions.
Before the commit, no other thread/client can see any of the changes contained in the current transaction.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">begin()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.begin();  // &lt;--- AT THIS POINT THE TRANSACTION IS STARTED AND ALL THE CHANGES ARE COLLECTED TILL THE COMMIT (SEE BELOW)
try{
  // YOUR CODE HERE
  db.commit();
} catch( Exception e ){
  db.rollback();
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_close_2">close()</h6>
<div class="paragraph">
<p>Closes a database.
This method should be called at the end of the application.
By using Java7+ AutoClosed statement, the <code>close()</code> method is executed automatically at the end of the scope of the database variable.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void close()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Database db = new DatabaseFactory("/temp/mydb").open();
try{
  // YOUR CODE HERE
} finally {
  db.close();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The suggested method is using Java7+ AutoClosed statement, to avoid the explicit <code>close()</code> calling:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try( Database db = new DatabaseFactory("/temp/mydb").open(); ) {
  // YOUR CODE
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_drop">drop()</h6>
<div class="paragraph">
<p>Drops a database.
The database will be completely removed from the filesystem.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void drop()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">new DatabaseFactory("/temp/mydb").open().drop();</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_getschema">getSchema()</h6>
<div class="paragraph">
<p>Returns the Schema instance for the database.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Schema getSchema()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.getSchema().createVertexType("Song");</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_isopen">isOpen()</h6>
<div class="paragraph">
<p>Returns <code>true</code> if the database is open, otherwise <code>false</code>.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">boolean isOpen()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">if( db.isOpen() ){
  // YOUR CODE HERE
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_query_language_command_positionalparameters">query( language, command, positionalParameters )</h6>
<div class="paragraph">
<p>Executes a query, with optional positional parameters.
This method only executes idempotent statements, namely <code>SELECT</code> and <code>MATCH</code>, that cannot change the database.
The execution of any other commands will throw a <code>IllegalArgumentException</code> exception.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Resultset query( String language, String command, Object... positionalParameters )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>language</code>             is the language to use.
Only "SQL" language is supported for now, but in the future multiple languages could be used</p>
</li>
<li>
<p><code>command</code>              is the command to execute.
If the language supports prepared statements (SQL does), you can specify parameters by using <code>?</code> for positional replacement</p>
</li>
<li>
<p><code>positionalParameters</code> optional variable array of parameters to execute with the query</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns a <code>Resultset</code> object where the result can be iterated.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Simple query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ResultSet resultset = db.query("sql", "select from V");
while (resultset.hasNext()) {
  Result record = resultset.next();
  System.out.println( "Found record, name = " + record.getProperty("name"));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Query passing positional parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ResultSet resultset = db.query("sql", "select from V where age &gt; ? and city = ?", 18, "Melbourne");
while (resultset.hasNext()) {
  Result record = resultset.next();
  System.out.println( "Found record, name = " + record.getProperty("name"));
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_query_language_command_parametermap">query( language, command, parameterMap )</h6>
<div class="paragraph">
<p>Executes a query taking a map for parameters.
This method only executes idempotent statements, namely <code>SELECT</code> and <code>MATCH</code>, that cannot change the database.
The execution of any other commands will throw a <code>IllegalArgumentException</code> exception.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Resultset query( String language, String command, Map&lt;String,Object&gt; parameterMap )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>language</code>     is the language to use.
Only "SQL" language is supported for now, but in the future multiple languages could be used</p>
</li>
<li>
<p><code>command</code>      is the command to execute.
If the language supports prepared statements (SQL does), you can specify parameters by name by using <code>:&lt;arg-name&gt;</code></p>
</li>
<li>
<p><code>parameterMap</code> this map is used to extract the named parameters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns a <code>Resultset</code> object where the result can be iterated.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Map&lt;String,Object&gt; parameters = new HashMap&lt;&gt;();
parameters.put("age", 18);
parameters.put("city", "Melbourne");

ResultSet resultset = db.query("sql", "select from V where age &gt; :age and city = :city", parameters);
while (resultset.hasNext()) {
  Result record = resultset.next();
  System.out.println( "Found record, name = " + record.getProperty("name"));
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_command_language_command_positionalparameters">command( language, command, positionalParameters )</h6>
<div class="paragraph">
<p>Executes a command that could change the database.
This is the equivalent to <code>query()</code>, but allows the command to modify the database.
Only "SQL" language is supported, but in the future multiple languages could be used.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Resultset command( String language, String command, Object... positionalParameters )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>language</code>             is the language to use.
Only "SQL" is supported</p>
</li>
<li>
<p><code>command</code>              is the command to execute.
If the language supports prepared statements (SQL does), you can specify parameters by using <code>?</code> for positional replacement or by name by using <code>:&lt;arg-name&gt;</code></p>
</li>
<li>
<p><code>positionalParameters</code> optional variable array of parameters to execute with the query</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns a <code>Resultset</code> object where the result can be iterated.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Create a new record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.command("sql", insert into V set name = 'Jay', surname = 'Miner'");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a new record by passing position parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.command("sql", insert into V set name = ?, surname = ?", "Jay", "Miner");</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_command_language_command_parametermap">command( language, command, parameterMap )</h6>
<div class="paragraph">
<p>Executes a command that could change the database.
This is the equivalent to <code>query()</code>, but allows the command to modify the database.
Only "SQL" language is supported, but in the future multiple languages could be used.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Resultset command( String language, String command, Map&lt;String,Object&gt; parameterMap )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>language</code>     is the language to use.
Only "SQL" is supported</p>
</li>
<li>
<p><code>command</code>      is the command to execute.
If the language supports prepared statements (SQL does), you can specify parameters by using <code>?</code> for positional replacement or by name by using <code>:&lt;arg-name&gt;</code></p>
</li>
<li>
<p><code>parameterMap</code> this map is used to extract the named parameters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns a <code>Resultset</code> object where the result can be iterated.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Create a new record by passing a map of parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Map&lt;String,Object&gt; parameters = new HashMap&lt;&gt;();
parameters.put("name", "Jay");
parameters.put("surname", "Miner");

db.command("sql", insert into V set name = :name, surname = :surname", parameters);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_commit">commit()</h6>
<div class="paragraph">
<p>Commits the thread&#8217;s active transaction.
All the pending changes in the transaction are made persistent.
A transaction must be begun by calling the <code><a href="#_begin">begin()</a></code> method.
Rolled back transactions cannot be committed.
ArcadeDB supports ACID transactions.
Before the commit, no other thread/client can see any of the changes contained in the current transaction.
ArcadeDB uses a WAL (Write Ahead Log) as journal in case a crash happens at commit time.
In this way, at the next restart, the database can be rollbacked at the previous state.
If the commit operation succeed, the changes are immediately visible to the other threads/clients and further transactions of the current thread.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">commit()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.begin();
try{
  // YOUR CODE HERE
  db.commit();  // &lt;--- COMMIT ALL THE CHANGES "ALL OR NOTHING" IN PERSISTENT WAY
} catch( Exception e ){
  db.rollback();
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_deleterecord_record">deleteRecord( record )</h6>
<div class="paragraph">
<p>Deleted a record.
The record will be persistently deleted only at commit time.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void deleteRecord( Record record )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.deleteRecord( customer );</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_iteratebucket_bucketname">iterateBucket( bucketName )</h6>
<div class="paragraph">
<p>Iterates all the records contained in a bucket.
To scan a type (with all its buckets), use the method <a href="#_iteratetype_classname_polymorphic">iterateType()</a> instead.
The result are not accumulated in RAM, but tather this method returns an <code>Iterator&lt;Record&gt;</code> that fetches the records only when <code>.next()</code> is called.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Iterator&lt;Record&gt; iterateBucket( String bucketName )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>Aggregate the records by age.
This is equivalent to a SQL query with a "group by age":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Map&lt;String, AtomicInteger&gt; aggregate = new HashMap&lt;&gt;();

Iterator&lt;Record&gt; result = db.iterateType("V", true );
while( result.hasNext() ){
  Record record = result.next();

  String age = (String) record.get("age");
  AtomicInteger counter = aggregate.get(age);
  if (counter == null) {
    counter = new AtomicInteger(1);
    aggregate.put(age, counter);
  } else
    counter.incrementAndGet();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>Prints all the records in the bucket "Customer" with age major or equals to 21.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Iterator&lt;Record&gt; result = db.iterateBucket("Customer");
while( result.hasNext() ){
  Record record = result.next();

  Integer age = (Integer) record.get("age");
  if (age =! null &amp;&amp; age &gt;= 21 )
    System.out.println("Found customer: " + record.get("name") );
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_iteratetype_classname_polymorphic">iterateType( className, polymorphic )</h6>
<div class="paragraph">
<p>Iterates all the records contained in the buckets relative to a type.
If <code>polymorphic</code> is <code>true</code>, then also the sub-types buckets are considered.
To iterate one bucket only check out the <a href="#_iteratebucket_bucketname">iterateBucket()</a> method.
The result are not accumulated in RAM, but tather this method returns an <code>Iterator&lt;Record&gt;</code> that fetches the records only when <code>.next()</code> is called.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Iterator&lt;Record&gt; iterateType( String typeName, boolean polymorphic )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>Aggregate the records by age.
This is equivalent to a SQL query with a "group by age":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Map&lt;String, AtomicInteger&gt; aggregate = new HashMap&lt;&gt;();

Iterator&lt;Record&gt; result = db.iterateType("V", true );
while( result.hasNext() ){
  Record record = result.next();

  String age = (String) record.get("age");
  AtomicInteger counter = aggregate.get(age);
  if (counter == null) {
    counter = new AtomicInteger(1);
    aggregate.put(age, counter);
  } else
    counter.incrementAndGet();
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_lookupbykey_type_properties_keys">lookupByKey( type, properties, keys )</h6>
<div class="paragraph">
<p>Look ups for one or more records (document, vertex or edge) that match one or more indexed keys.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Cursor&lt;RID&gt; lookupByKey( String type, String[] properties, Object[] keys )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>type</code>       type name</p>
</li>
<li>
<p><code>properties</code> array of property names to match</p>
</li>
<li>
<p><code>keys</code>       array of keys</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns a <code>Cursor&lt;RID&gt;</code> (like an iterator).</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Look up for an author with name "Jay" and surname "Miner".
This requires an index on the type "Author", properties "name" and "surname".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Cursor&lt;RID&gt; jayMiner = database.lookupByKey("Author", new String[] { "name", "surname" }, new Object[] { "Jay", "Miner" });
while( jayMiner.hasNext() ){
  System.out.println( "Found Jay! " + jayMiner.next().getProperty("name"));
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_lookupbyrid_rid_loadcontent">lookupByRID( rid, loadContent )</h6>
<div class="paragraph">
<p>Look ups for a record (document, vertex or edge) by its RID (Record Identifier).</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Record lookupByRID( RID rid, boolean loadContent )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>rid</code>         is the record identifier</p>
</li>
<li>
<p><code>loadContent</code> forces the load of the content too.
If the content is not loaded will be lazy loaded at the first access.
Use <code>true</code> if you are going to access to the record content for sure, otherwise, use <code>false</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns a <code>Record</code> implementation (document, vertex or edge).</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Load the vertex by RID and its content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Vertex v = (Vertex) db.lookupByRID(new RID(db, "#3:47"));</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_newdocument_typename">newDocument( typeName )</h6>
<div class="paragraph">
<p>Creates a new document of a certain type.
The type must be of type "document" and must be created beforehand.
In order to be saved, the method <code>MutableDocument.save()</code> must be called.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MutableDocument newDocument( typeName )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>typeName</code>    type name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns a <code>MutableDocument</code> instance.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Create a new document of type "Customer":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MutableDocument doc = db.newDocument("Customer");
doc.set("name", "Jay");
doc.set("surname", "Miner");
doc.save();</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_newvertex_typename">newVertex( typeName )</h6>
<div class="paragraph">
<p>Creates a new vertex of a certain type.
The type must be of type "vertex" and must be created beforehand.
In order to be saved, the method <code>MutableVertex.save()</code> must be called.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MutableVertex newVertex( typeName )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>typeName</code>    type name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns a <code>MutableVertex</code> instance.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Create a new document of type "Customer":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MutableVertex v = db.newVertex("Customer");
v.set("name", "Jay");
v.set("surname", "Miner");
v.save();</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_newedgebykeys_sourcevertextype_sourcevertexkey_sourcevertexvalue_destinationvertextype_destinationvertexkey_destinationvertexvalue_createvertexifnotexist_edgetype_bidirectional_properties">newEdgeByKeys( sourceVertexType, sourceVertexKey, sourceVertexValue, destinationVertexType, destinationVertexKey, destinationVertexValue, createVertexIfNotExist, edgeType, bidirectional, properties )</h6>
<div class="paragraph">
<p>Creates a new edge between two vertices found by their keys.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Edge newEdgeByKeys( String sourceVertexType, String[] sourceVertexKey,
                    Object[] sourceVertexValue,
                    String destinationVertexType, String[] destinationVertexKey,
                    Object[] destinationVertexValue,
                    boolean createVertexIfNotExist, String edgeType, boolean bidirectional,
                    Object... properties )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sourceVertexType</code>       source vertex type name</p>
</li>
<li>
<p><code>sourceVertexKey</code>        source vertex key properties</p>
</li>
<li>
<p><code>sourceVertexValue</code>      source vertex key values</p>
</li>
<li>
<p><code>destinationVertexType</code>  destination vertex type name</p>
</li>
<li>
<p><code>destinationVertexKey</code>   destination vertex key properties</p>
</li>
<li>
<p><code>destinationVertexValue</code> destination vertex key values</p>
</li>
<li>
<p><code>createVertexIfNotExist</code> creates source and/or destination vertices if not exist</p>
</li>
<li>
<p><code>edgeType</code>               edge type name</p>
</li>
<li>
<p><code>bidirectional</code>          <code>true</code> if the edge must be bidirectional, otherwise <code>false</code></p>
</li>
<li>
<p><code>properties</code>             optional property array with pairs of name (as string) and value</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns a <code>MutableEdge</code> instance.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Create a new document of type "Customer":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Edge likes = db.newEdgeByKeys( "Account",
                                new String[] {"id"}, new Object[] {322323},
                               "Song",
                                new String[] {"title"},
                                new Object[] {"Chasing Cars"},
                               false, "Likes", true);
likes.save();</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_rollback">rollback()</h6>
<div class="paragraph">
<p>Aborts the thread&#8217;s active transaction by rolling back all the pending changes.
Usually the transaction rollback is executed in case of errors.
If an exception happens during the call <code><a href="#_commit">commit()</a></code>, the transaction is roll backed automatically.
Once rolled backed, the transaction cannot be committed anymore but it has to be re-started by calling the <code><a href="#_begin">begin()</a></code> method.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">rollback()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.begin();
try{
  // YOUR CODE HERE
  db.commit();
} catch( Exception e ){
  db.rollback(); // &lt;--- ROLLBACK IN CASE OF EXCEPTION
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_scanbucket_bucketname_callback">scanBucket( bucketName, callback )</h6>
<div class="paragraph">
<p>Scans all the records contained in a buckets.
For each record found, the callback is called passing the current record.
To scan a type (with all its buckets), use the method <a href="#_scantype_classname_polymorphic_callback">scanType()</a> instead.
The callback method must return <code>true</code> to continue the scan, otherwise <code>false</code>.
Look also at the <a href="#_iteratebucket_bucketname">iterateBucket()</a> method if you want to use an iterator approach instead of callback.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void scanBucket(String bucketName, RecordCallback callback);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>Prints all the records in the bucket "Customer" with age major or equals to 21.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.scanBucket("Customer", (record) -&gt; {
  Integer age = (Integer) record.get("age");
  if (age =! null &amp;&amp; age &gt;= 21 )
    System.out.println("Found customer: " + record.get("name") );
  return true;
});</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_scantype_classname_polymorphic_callback">scanType( className, polymorphic, callback )</h6>
<div class="paragraph">
<p>Scans all the records contained in all the buckets relative to a type.
If <code>polymorphic</code> is <code>true</code>, then also the sub-types buckets are considered.
For each record found, the callback is called passing the current record.
To scan one bucket only check out the <a href="#_scanbucket_bucketname_callback">scanBucket()</a> method.
The callback method must return <code>true</code> to continue the scan, otherwise <code>false</code>.
Look also at the <a href="#_iteratetype_classname_polymorphic">iterateType()</a> method if you want to use an iterator approach instead of callback.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">scanType( String className, boolean polymorphic, DocumentCallback callback )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>Aggregate the records by age.
This is equivalent to a SQL query with a "group by age":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Map&lt;String, AtomicInteger&gt; aggregate = new HashMap&lt;&gt;();

db.scanType("V", true, (record) -&gt; {
  String age = (String) record.get("age");
  AtomicInteger counter = aggregate.get(age);
  if (counter == null) {
    counter = new AtomicInteger(1);
    aggregate.put(age, counter);
  } else
    counter.incrementAndGet();

  return true;
});</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_transaction_txblock">transaction( txBlock )</h6>
<div class="paragraph">
<p>This methods wraps a call to the method <a href="#_transaction_txblock_retries">transaction with retries</a> by using the default retries specified in the database setting <code>arcadedb.mvccRetries</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_transaction_txblock_retries">transaction( txBlock, retries )</h6>
<div class="paragraph">
<p>Executes a transaction block as a callback or a clojure.
Before calling the callback in <code>TransactionScope</code>, the transaction is begun and after the end of the callback, the transaction is committed.
In case of any exceptions, the transaction is rolled back.
In case a <code>NeedRetryException</code> exceptions is thrown, the transaction is repeated up to <code>retries</code> times</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void transaction( TransactionScope txBlock )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Example by using Java8+ syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.transaction( () -&gt; {
  final MutableVertex v = database.newVertex("Author");
  v.set("name", "Jay");
  v.set("surname", "Miner");
  v.save();
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example by using Java7 syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.transaction( new Database.TransactionScope() {
  @Override
  public void execute(Database database) {
    final MutableVertex v = database.newVertex("Author");
    v.set("name", "Jay");
    v.set("surname", "Miner");
    v.save();
  }
});</code></pre>
</div>
</div>
<h4 id="DatabaseAsyncExecutor" class="discrete"><code>DatabaseAsyncExecutor</code> Interface</h4>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/java-ref-database-async.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>This is the class to manage asynchronous operations.
To obtain an instance of DatabaseAsyncExecutor, use the method <code>.async()</code> in <code><a href="#_-code-database-code-interface">Database</a></code>.</p>
</div>
<div class="paragraph">
<p>The Asynchronous API schedule the operation to be executed as soon as possible, but by a different thread.
ArcadeDB optimizes the usage of asynchronous threads to be equals to the number of cores found in the machine (but it is still configurable).
Use Asynchronous API if the response of the operation can be managed in asynchronous way and if you want to avoid developing Multi-Threads application by yourself.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_methods_2">Methods</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#asyncCommandPos"><strong>command(&#8230;&#8203;)</strong> positional parameters</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#asyncCommandMap"><strong>command(Map&lt;K,V&gt;)</strong> parameter map</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#asyncQueryPos"><strong>query(&#8230;&#8203;)</strong> positional parameters</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#asyncQueryMap"><strong>query(Map&lt;K,V&gt;)</strong> parameter map</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#asyncTransaction"><strong>transaction()</strong></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#asyncTransaction"><strong>transaction(retries)</strong></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#asyncTransaction"><strong>transaction(retries, callbacks)</strong></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#asyncCreate"><strong>createRecord()</strong></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#asyncUpdate"><strong>updateRecord()</strong></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#asyncDelete"><strong>deleteRecord()</strong></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<h6 id="asyncQueryPos" class="discrete">query( language, command, callback, positionalParameters )</h6>
<div class="paragraph">
<p>Executes a query in asynchronous way, with optional positional parameters.
This method returns immediately.
This method only executes idempotent statements, namely <code>SELECT</code> and <code>MATCH</code>, that cannot change the database.
The execution of any other commands will throw a <code>IllegalArgumentException</code> exception.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void query( String language, String command, AsyncResultsetCallback callback,
            Object... positionalParameters )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>language</code>             is the language to use</p>
</li>
<li>
<p><code>command</code>              is the command to execute If the language supports prepared statements (SQL does), you can specify parameters by using <code>?</code> for positional replacement If the language supports prepared statements (SQL does), you can specify parameters by name by using <code>:&lt;arg-name&gt;</code></p>
</li>
<li>
<p><code>callback</code>     optional, is the callback that will be used for the whole lifecycle of the result set:</p>
<div class="ulist">
<ul>
<li>
<p><code>onStart()</code> executed when the query is parsed and the first result ready</p>
</li>
<li>
<p><code>onNext()</code> executed foreach result in the result set Return <code>true</code> to continue browsing the result set, otherwise <code>false</code> to interrupt fetching the result set</p>
</li>
<li>
<p><code>onComplete()</code> executed when the entire result set is browsed, or the <code>onNext()</code> returned false to interrupt the browsing</p>
</li>
<li>
<p><code>onError()</code> in case of any exception while executing the query</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>positionalParameters</code> optional variable array of parameters to execute with the query</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To iterate the result, use the callback.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Simple query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.async().query("sql", "select from V", new AsyncResultsetCallback() {
  @Override
  public boolean onNext(Result result) {
    System.out.println( "Found record, name = " + result.getProperty("name"));
    return true;
  }

  @Override
  public void onError(Exception exception) {
    System.err.println("Error on executing query: " + exception );
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Query passing positional parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.async().query("sql", "select from V where age &gt; ? and city = ?", new AsyncResultsetCallback(){
  @Override
  public boolean onNext(Result result) {
    System.out.println( "Found record, name = " + result.getProperty("name"));
    return true;
  }
}, 18, "Melbourne");</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you have multiple independent queries that could be executed in parallel, you could use the asynchronous interface and a <code>CountDownLatch</code>. The following example
executes 3 queries in parallel and wait for all of them to have finished.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">CountDownLatch counter = new CountDownLatch(3);

final ResultSet[] resultSets = new ResultSet[3];
database.async().query("sql", "select from X", resultset -&gt; { resultSets[0] = resultset; counter.countDown(); });
database.async().query("sql", "select from Y", resultset -&gt; { resultSets[1] = resultset; counter.countDown(); });
database.async().query("sql", "select from Z", resultset -&gt; { resultSets[2] = resultset; counter.countDown(); });

// WAIT INDEFINITELY
counter.await();

// OR YOU CAN SPECIFY A TIMEOUT, LIKE 10 SECONDS TOP
// counter.await(10, TimeUnit.SECONDS);</code></pre>
</div>
</div>
<h6 id="asyncQueryMap" class="discrete">query( language, command, callback, parameterMap )</h6>
<div class="paragraph">
<p>Executes a query taking a map for parameters.
This method returns immediately.
This method only executes idempotent statements, namely <code>SELECT</code> and <code>MATCH</code>, that cannot change the database.
The execution of any other commands will throw a <code>IllegalArgumentException</code> exception.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void query( String language, String command, AsyncResultsetCallback callback,
            Map&lt;String,Object&gt; parameterMap )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>language</code>     is the language to use</p>
</li>
<li>
<p><code>command</code>      is the command to execute If the language supports prepared statements (SQL does), you can specify parameters by name by using <code>:&lt;arg-name&gt;</code></p>
</li>
<li>
<p><code>callback</code>     optional, is the callback that will be used for the whole lifecycle of the result set:</p>
<div class="ulist">
<ul>
<li>
<p><code>onStart()</code> executed when the query is parsed and the first result ready</p>
</li>
<li>
<p><code>onNext()</code> executed foreach result in the result set Return <code>true</code> to continue browsing the result set, otherwise <code>false</code> to interrupt fetching the result set</p>
</li>
<li>
<p><code>onComplete()</code> executed when the entire result set is browsed, or the <code>onNext()</code> returned false to interrupt the browsing</p>
</li>
<li>
<p><code>onError()</code> in case of any exception while executing the query</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>parameterMap</code> this map is used to extract the named parameters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To iterate the result, use the callback.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Map&lt;String,Object&gt; parameters = Map.of("age", 18, "city", "Melbourne");

db.async().query("sql", "select from V where age &gt; :age and city = :city", new AsyncResultsetCallback(){
  @Override
  public boolean onNext(Result result) {
    System.out.println( "Found record, name = " + result.getProperty("name"));
    return true;
  }
}, parameters);</code></pre>
</div>
</div>
<h6 id="asyncCommandPos" class="discrete">command( language, command, callback, positionalParameters )</h6>
<div class="paragraph">
<p>Executes a command that could change the database.
This method returns immediately.
This is the equivalent to <code>query()</code>, but allows the command to modify the database.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void command( String language, String command, AsyncResultsetCallback callback,
              Object... positionalParameters )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>language</code>             is the language to use</p>
</li>
<li>
<p><code>command</code>              is the command to execute If the language supports prepared statements (SQL does), you can specify parameters by using <code>?</code> for positional replacement or by name by using <code>:&lt;arg-name&gt;</code>
If the language supports prepared statements (SQL does), you can specify parameters by name by using <code>:&lt;arg-name&gt;</code></p>
</li>
<li>
<p><code>callback</code>     optional, is the callback that will be used for the whole lifecycle of the result set:</p>
<div class="ulist">
<ul>
<li>
<p><code>onStart()</code> executed when the query is parsed and the first result ready</p>
</li>
<li>
<p><code>onNext()</code> executed foreach result in the result set Return <code>true</code> to continue browsing the result set, otherwise <code>false</code> to interrupt fetching the result set</p>
</li>
<li>
<p><code>onComplete()</code> executed when the entire result set is browsed, or the <code>onNext()</code> returned false to interrupt the browsing</p>
</li>
<li>
<p><code>onError()</code> in case of any exception while executing the query</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>positionalParameters</code> optional variable array of parameters to execute with the query</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To iterate the result, use the callback.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Create a new record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.async().command("sql", "insert into V set name = 'Jay', surname = 'Miner'", new AsyncResultsetCallback() {
  @Override
  public boolean onNext(Result result) {
    System.out.println("Created new record: " + result.toJSON() );
    return true;
  }

  @Override
  public void onError(Exception exception) {
    System.err.println("Error on creating new record: " + exception );
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a new record by passing position parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">db.async().command("sql", "insert into V set name = ? surname = ?", new AsyncResultsetCallback() {
  @Override
  public boolean onNext(Result result) {
    System.out.println("Created new record: " + result.toJSON() );
    return true;
  }
}, "Jay", "Miner");</code></pre>
</div>
</div>
<h6 id="asyncCommandMap" class="discrete">command( language, command, callback, parameterMap )</h6>
<div class="paragraph">
<p>Executes a command that could change the database.
This method returns immediately.
This is the equivalent to <code>query()</code>, but allows non-idempotent commands to modify the database.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void command( String language, String command, AsyncResultsetCallback callback,
              Map&lt;String,Object&gt; parameterMap )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>language</code>     is the language to use</p>
</li>
<li>
<p><code>command</code>      is the command to execute If the language supports prepared statements (SQL does), you can specify parameters by using <code>?</code> for positional replacement or by name by using <code>:&lt;arg-name&gt;</code>
If the language supports prepared statements (SQL does), you can specify parameters by name by using <code>:&lt;arg-name&gt;</code></p>
</li>
<li>
<p><code>callback</code>     optional, is the callback that will be used for the whole lifecycle of the result set:</p>
<div class="ulist">
<ul>
<li>
<p><code>onStart()</code> executed when the query is parsed and the first result ready</p>
</li>
<li>
<p><code>onNext()</code> executed foreach result in the result set Return <code>true</code> to continue browsing the result set, otherwise <code>false</code> to interrupt fetching the result set</p>
</li>
<li>
<p><code>onComplete()</code> executed when the entire result set is browsed, or the <code>onNext()</code> returned false to interrupt the browsing</p>
</li>
<li>
<p><code>onError()</code> in case of any exception while executing the query</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>parameterMap</code> this map is used to extract the named parameters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To iterate the result, use the callback.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p>Create a new record by passing a map of parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Map&lt;String,Object&gt; parameters = Map.of("name", "Jay", "surname", "Miner");

db.async().command("sql", "insert into V set name = :name, surname = :surname", new AsyncResultsetCallback() {
  @Override
  public boolean onNext(Result result) {
    System.out.println("Created new record: " + result.toJSON() );
    return true;
  }

  @Override
  public void onError(Exception exception) {
    System.err.println("Error on creating new record: " + exception );
  }
}, parameters);</code></pre>
</div>
</div>
<h6 id="asyncCreate" class="discrete">createRecord(record, newRecordCallback [,errorCallback])</h6>
<div class="paragraph">
<p>Creates a record (document or vertex) asynchronously.
This method returns immediately.
The result can be managed in the NewRecordCallback callback and errors in ErrorCallback callback.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void createRecord(final MutableDocument record, final NewRecordCallback newRecordCallback,
                  final ErrorCallback errorCallback)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>record</code> is the mutable record to insert</p>
</li>
<li>
<p><code>newRecordCallback</code> is the callback to handle the result after the record has been inserted</p>
</li>
<li>
<p><code>errorCallback</code> (optional) is the callback to handle any error raised during insertion</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example on inserting a vertex asynchronously.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final MutableVertex vertex = database.newVertex("Customer").set("name", "Elon");
database.async().createRecord(vertex,
                              v -&gt; { System.out.println("Record " + v.toJSON() + " created") });</code></pre>
</div>
</div>
<h6 id="asyncUpdate" class="discrete">updateRecord(record, updateRecordCallback [,errorCallback])</h6>
<div class="paragraph">
<p>Updates a record (document or vertex) asynchronously.
This method returns immediately.
The result can be managed in the UpdatedRecordCallback callback and errors in ErrorCallback callback.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void updateRecord(final MutableDocument record, final UpdatedRecordCallback updateRecordCallback,
                  final ErrorCallback errorCallback)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>record</code> is the mutable record to update</p>
</li>
<li>
<p><code>updateRecordCallback</code> is the callback to handle the result after the record has been updated</p>
</li>
<li>
<p><code>errorCallback</code> (optional) is the callback to handle any error raised during update]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example on inserting a vertex asynchronously.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.async().updateRecord(vertex,
                              v -&gt; { System.out.println("Record " + v.toJSON() + " updated") });</code></pre>
</div>
</div>
<h6 id="asyncDelete" class="discrete">deleteRecord(record, deleteRecordCallback [,errorCallback])</h6>
<div class="paragraph">
<p>Deletes a record (document or vertex) asynchronously.
This method returns immediately.
The result can be managed in the DeletedRecordCallback callback and errors in ErrorCallback callback.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void deleteRecord(final Record record, final DeletedRecordCallback deleteRecordCallback,
                  final ErrorCallback errorCallback)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>record</code> is the record to delete</p>
</li>
<li>
<p><code>updateRecordCallback</code> is the callback to handle the result after the record has been deleted</p>
</li>
<li>
<p><code>errorCallback</code> (optional) is the callback to handle any error raised during deletion</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example on inserting a vertex asynchronously.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.async().deleteRecord(vertex,
                              v -&gt; { System.out.println("Record " + v.toJSON() + " updated") });</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Java-API-Remote">7.4. Java API (Remote)</h3>
<div class="paragraph">
<p>ArcadeDB comes with a convenient Java library to work with a remote database.</p>
</div>
<div class="paragraph">
<p>Add the following dependencies in your Maven pom.xml file under the tag <code>&lt;dependencies&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.arcadedb&lt;/groupId&gt;
    &lt;artifactId&gt;arcadedb-engine&lt;/artifactId&gt;
    &lt;version&gt;23.1.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.arcadedb&lt;/groupId&gt;
    &lt;artifactId&gt;arcadedb-network&lt;/artifactId&gt;
    &lt;version&gt;23.1.2&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_10_minute_tutorial">7.4.1. 10-Minute Tutorial</h4>
<div class="sect4">
<h5 id="_connect_to_a_remote_database">Connect to a remote database</h5>
<div class="paragraph">
<p>The central class that handles the connection to the remote database and translates the Java API to http-calls is the <code><a href="#RemoteDatabase">RemoteDatabase</a></code>. Let&#8217;s get an instance of it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">RemoteDatabase database = new RemoteDatabase("localhost", 5432, "mydb", "root", "playwithdata");</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>RemoteDatabase</code> is not thread-safe. It holds a backend session. If a thread closes a transaction, it also closes the session, so that any request performed by a concurrent thread using the same RemoteDatabase instance leads to unexpected behavior. To avoid concurrency problems you should not hold RemoteDatabase instances as fields on the heap, but rather create a new instance in method scope as a variable on the stack.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The database, which name you have given as the third parameter in the constructor is not automatically created nor is it checked whether it exists. Before you use the <code>RemoteDatabase</code> make sure that the database exists, or, if it doesn&#8217;t, create it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">if (!database.exists()) {
    database.create();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a list of all databases hosted by the server use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">List&lt;String&gt; databases = database.databases();
assert(databases.contains("mydb"));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that we have the database created we may create the schema (but we may also work without):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String schema =
"""
    create vertex type Customer if not exists;
    create property Customer.name if not exists string;
    create property Customer.surname if not exists string;
    create index if not exists on Customer (name, surname) unique;
""";
database.command("sqlscript", schema);</code></pre>
</div>
</div>
<div class="paragraph">
<p>As language we have used <code>sqlscript</code>, which has the advantage that all the statements in the script are executed within one single transaction. Of course you can also send these requests line by line with <code>sql</code> as language. If you go line by line it is important to enclose the requests in a common transaction:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.begin();
database.command("sql", "create vertex type Customer if not exists");
database.command("sql", "create property Customer.name if not exists string");
database.command("sql", "create property Customer.surname if not exists string");
database.command("sql", "create index if not exists on Customer (name, surname) unique");
database.commit();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.transaction(() -&gt; {
    ...
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>transaction</code> method encloses the lambda function with a <code>begin</code> - <code>commit</code>, or a <code>rollback</code> in case of any exception.</p>
</div>
<div class="paragraph">
<p>Now that the schema is in place, we will insert some data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.command("sql", "insert into Customer(name, surname) values(?, ?)", "Jay", "Miner");
database.command("sql",
        "update Customer set lastcall = :lastcall where name = :name and surname = :surname",
        Map.of("lastcall", Date.from(Instant.now()), "name", "Jay", "surname", "Miner"));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first command creates a new vertex of type 'Customer'. The second command updates this vertex by adding a new value for the property 'lastcall'. The first command uses unnamed parameters where the values are mapped by their order in the parameter list. Whereas the second command uses named parameters, which are mapped by the parameter names.</p>
</div>
<div class="paragraph">
<p>We can now query some customer data from our database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ResultSet resultSet = database.query("sql", "select from Customer where name = :name",
        Map.of("name", "Jay"));
Map&lt;String, Object&gt; customer = resultSet.stream().findFirst().map(Result::toMap).orElse(Map.of());</code></pre>
</div>
</div>
<div class="paragraph">
<p>The query returns a <code>ResultSet</code>, which holds an arry of objects of type <code>Result</code>, which can be read as Map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{name=Jay, @cat=d, @rid=#1:0, lastcall=1675961747290, surname=Miner, @type=Customer}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="HTTP-API">7.5. HTTP/JSON Protocol</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/http.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p><strong>Overview Endpoints</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 10%;">
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Action</strong></th>
<th class="tableblock halign-left valign-top"><strong>Method</strong></th>
<th class="tableblock halign-left valign-top"><strong>Endpoint</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#HTTP-CheckReady">Get server status</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/api/v1/ready</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#HTTP-ServerInfo">Get server information</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/api/v1/server</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#HTTP-ServerCommand">Send server command</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/api/v1/server</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#HTTP-DatabaseExists">Does database exist</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/api/v1/exists/{database}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#HTTP-ExecuteQuery">Execute a query</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/api/v1/query/{database}/{language}/{query}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#HTTP-ExecuteCommand">Execute database command</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/api/v1/command/{database}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#HTTP-Begin">Begin a new transaction</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/api/v1/begin/{database}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#HTTP-Commit">Commit a transaction</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/api/v1/commit/{database}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#HTTP-Rollback">Rollback a transaction</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/api/v1/rollback/{database}</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Overview Parameters</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 10%;">
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Parameters</strong></th>
<th class="tableblock halign-left valign-top"><strong>Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Values</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"sql", "sqlscript", "graphql", "cypher", "gremlin", "mongo", and others</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">encoded command string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">maximum number of results</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">params</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">map of parameters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">serializer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"graph", "record"</p></td>
</tr>
</tbody>
</table>
<h4 id="_introduction" class="discrete">Introduction</h4>
<div class="paragraph">
<p>The ArcadeDB Server is accessible from the remote through the HTTP/JSON protocol.
The protocol is very simple.
For this reason, you don&#8217;t need a driver, because every modern programming language provides an easy way to execute HTTP requests and parse JSON.</p>
</div>
<div class="paragraph">
<p>For the examples in this chapter we&#8217;re going to use <a href="https://curl.se/"><code>curl</code></a>.
Every request must be authenticated by passing user and password as HTTP basic authentication (in HTTP Headers).
In the examples below we&#8217;re going to always use "root" user with password "arcadedb-password".</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Under Windows (Powershell) single and double quotes inside a single or double quoted string
      need to be replaced with their Unicode entity representations <code>\u0022</code> (double quote) and
      <code>\u0027</code> (single quote). This is for example the case in the data argument (<code>-d</code>) of POST requests.
</td>
</tr>
</table>
</div>
<h4 id="_server_side_transactions" class="discrete">Server-Side Transactions</h4>
<div class="paragraph">
<p>ArcadeDB implements server-side transaction over HTTP stateless protocol by using sessions.
A session is created with the <a href="#HTTP-Begin">/begin</a> command and returns a session id in the response header (example <code>arcadedb-session-id: AS-ee056170-dc9b-4956-8d71-d7cfa01900d4</code>).
Use the session id in the request header of further commands you want to execute in the same transaction and execute <a href="#HTTP-Commit">/commit</a> to commit the server side transaction or <a href="#HTTP-Rollback">/rollback</a> to rollback the changes.
After a period of inactivity (default is 30 seconds, see <a href="#Settings"><code>server.httpTxExpireTimeout</code></a>), the server automatically rolls back and purges expired transactions.</p>
</div>
<h4 id="_transaction_scripts" class="discrete">Transaction Scripts</h4>
<div class="paragraph">
<p>In case <a href="#SQL">SQL</a> (<code>sql</code>) is supposed to be used as language for a transactions,
the language variant "SQL script" (<code>sqlscript</code>) is also available.
A <code>sqlscript</code> can consist of one or multiple SQL statements,
which is collectively treated as a transaction.
Hence, for such a batch of SQL statements, no <code>begin</code> and <code>commit</code> commands are necessary,
since <code>begin</code> and <code>commit</code> implicitly enclose any <code>sqlscript</code> command.</p>
</div>
<h4 id="WebSocket-Streaming" class="discrete">Streaming Change Events</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This feature presently only supports single server deployments.
Cluster support is coming soon.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Java API supports real-time change notifications, which the HTTP API implements via a websocket.
You can opt into notifications for all changes that occur on a database, or filter by the operation (i.e. create, update, delete) or underlying entity type.</p>
</div>
<div class="paragraph">
<p>To connect, point your favorite WebSocket client to the <code>ws://SERVER:PORT/ws</code> endpoint.
You will need to authenticate with HTTP Basic, which for some clients (like most browsers) is only possible via the URI, like this: <code>ws://USERNAME:PASSWORD@SERVER:PORT/ws</code>.
Others will require that you set the Authorization header directly.
Check the documentation for your client of choice for details.</p>
</div>
<div class="paragraph">
<p>To subscribe/unsubscribe to change events, send JSON messages using the following structure:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 10%;">
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">action</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Required</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subscribe</code> or <code>unsubscribe</code>.</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">database</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Required</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">The database name.</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">type</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">The entity type to filter by.</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">changeTypes</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array of change types you&#8217;d like to receive. Must be <code>create</code>, <code>update</code>, or <code>delete</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example: to subscribe to all changes (create, update, delete) for the type <code>Movie</code> in the database <code>movies</code>, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{"action": "subscribe", "database": "movies", "type": "Movie"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If instead, you only want updates, send:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{"action": "subscribe", "database": "movies", "type": "Movie", "changeTypes": ["update"]}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want every change on the database (use with caution!):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{"action": "subscribe", "database": "movies"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once subscribed, you will get JSON messages for any matching changes with the following properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">database</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">The source database.</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">changeType</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">create, update or delete.</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">record</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">The full record that generated the change event.</p></td>
</tr>
</tbody>
</table>
<h4 id="_tutorial" class="discrete">Tutorial</h4>
<div class="paragraph">
<p>Let&#8217;s first create an empty database "school" on the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/server
     -d '{ "command": "create database school" }'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s create the type "Class":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/command/school
     -d '{ "language": "sql", "command": "create document type Class"}'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>We could insert our first Class by using SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/command/school
     -d '{ "language": "sql", "command": "insert into Class set name = '\''English'\'', location = '\''3rd floor'\''"}'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or better, using parameters with SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/command/school
     -d '{ "language": "sql", "command": "insert into Class set name = :name, location = :location", "params": { "name": "English", "location": "3rd floor" }}'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or by using the <code>api/v1/document</code> API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/document/school
     -d '{"@type": "Class", "name": "English", "location": "3rd floor"}'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<h4 id="_reference" class="discrete">Reference</h4>
<h5 id="HTTP-CheckReady" class="discrete">Check if server is ready (GET)</h5>
<div class="paragraph">
<p>Returns a header-only status 204 (no content) if the ArcadeDB server is ready.</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/ready</code></p>
</div>
<div class="paragraph">
<p>This endpoint accepts (GET) requests without authentication,
and is useful for remote monitoring of server readiness.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X GET http://localhost:2480/api/v1/ready</code></pre>
</div>
</div>
<div class="paragraph">
<p>Return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>HTTP/1.1 204 OK</code></pre>
</div>
</div>
<h5 id="HTTP-ServerInfo" class="discrete">Get server information (GET)</h5>
<div class="paragraph">
<p>Returns the current configuration.</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/server</code></p>
</div>
<div class="paragraph">
<p>The following <code>mode</code> query parameter values are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>basic</code> returns minimal server information.</p>
</li>
<li>
<p><code>default</code> returns full server configuration (default value when no parameter is given).</p>
</li>
<li>
<p><code>cluster</code> returns cluster layout.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X GET http://localhost:2480/api/v1/server?mode=basic
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{"user":"root", "version":"23.1.2", "serverName":"ArcadeDB_0"}</code></pre>
</div>
</div>
<h5 id="HTTP-ServerCommand" class="discrete">Send server command (POST)</h5>
<div class="paragraph">
<p>Sends control commands to server.</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/server</code></p>
</div>
<div class="paragraph">
<p>The following commands are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>list databases</code> returns the list of databases installed in the server</p>
</li>
<li>
<p><code>create database &lt;dbname&gt;</code> creates database with name <code>dbname</code></p>
</li>
<li>
<p><code>drop database &lt;dbname&gt;</code> deletes database with name <code>dbname</code></p>
</li>
<li>
<p><code>open database &lt;dbname&gt;</code> opens database with name <code>dbname</code></p>
</li>
<li>
<p><code>close database &lt;dbname&gt;</code> closes database with name <code>dbname</code></p>
</li>
<li>
<p><code>create user { "name": "&lt;username&gt;", "password": "&lt;password&gt;", "databases": { "&lt;dbname&gt;": "admin", "&lt;dbname&gt;": "admin" } }</code> creates user credentials <code>username</code> and <code>password</code> and admin access to databases <code>dbname</code>.</p>
</li>
<li>
<p><code>drop user &lt;username&gt;</code> deletes user <code>username</code></p>
</li>
<li>
<p><code>shutdown</code> kills the server gracefully.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Only <strong>root</strong> users can run these command, except the <code>list databases</code> command,
      which every user can run, and this user&#8217;s accessible databases are listed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<h6 id="_list_databases" class="discrete">List databases</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/server
     -d '{ "command": "list databases" }'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "result" : ["school","mydatabase"]}</code></pre>
</div>
</div>
<h6 id="_create_database" class="discrete">Create database</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/server
     -d '{ "command": "create database mydatabase" }'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "result": "ok"}</code></pre>
</div>
</div>
<h6 id="_drop_database" class="discrete">Drop database</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/server
     -d '{ "command": "drop database mydatabase" }'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "result": "ok"}</code></pre>
</div>
</div>
<h6 id="_open_database" class="discrete">Open database</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/server
     -d '{ "command": "open database mydatabase" }'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "result": "ok"}</code></pre>
</div>
</div>
<h6 id="_close_database" class="discrete">Close database</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/server
     -d '{ "command": "close database mydatabase" }'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "result": "ok"}</code></pre>
</div>
</div>
<h6 id="_create_user" class="discrete">Create user</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/server
     -d '{ "command": "create user { \"name\": \"myuser\", \"password\": \"mypassword\", \"databases\": { \"mydatabase\": \"admin\" } }" }'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "result": "ok"}</code></pre>
</div>
</div>
<h6 id="_drop_user" class="discrete">Drop user</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/server
     -d '{ "command": "drop user myuser" }'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "result": "ok"}</code></pre>
</div>
</div>
<h6 id="_shutdown_server" class="discrete">Shutdown server</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/server
     -d '{ "command": "shutdown" }'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "result": "ok"}</code></pre>
</div>
</div>
<h5 id="HTTP-DatabaseExists" class="discrete">Does database exist (GET)</h5>
<div class="paragraph">
<p>Returns boolean answering if database exists.</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/exists/{database}</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X GET http://localhost:2480/api/v1/exists/school
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response is a simple boolean result.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{"result": true}</code></pre>
</div>
</div>
<h5 id="HTTP-OpenDatabase" class="discrete">Open a database (POST)</h5>
<div class="paragraph">
<p>Opens a database on the server.
By default, all the databases under the <code>databases/</code> directory on the server are loaded at startup.
You can manually load the databases by setting <code>arcadedb.server.databaseLoadAtStartup=false</code> and invoking the open command on the databases you are going to use.
Also, you can open a database previously closed because of a restore database command.</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/open/{database}</code></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>database</code> is the database name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example of opening the database "school":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/open/school
     --user root:arcadedb-password</code></pre>
</div>
</div>
<h5 id="HTTP-CloseDatabase" class="discrete">Close a database (POST)</h5>
<div class="paragraph">
<p>Closes a database on the server.
Use this command to free resources in case there are many databases managed by the server.
Also, close the database before a restore of the database.</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/close/{database}</code></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>database</code> is the database name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example of closing the database "school":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/close/school
     --user root:arcadedb-password</code></pre>
</div>
</div>
<h5 id="HTTP-ExecuteQuery" class="discrete">Execute a query (GET)</h5>
<div class="paragraph">
<p>This command allows executing idempotent commands, like <code>SELECT</code> and <code>MATCH</code>:</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/query/{database}/{language}/{command}</code></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>database</code> is the database name</p>
</li>
<li>
<p><code>language</code> is the query language used.
is the query language used, between "sql", "sqlscript", "graphql", "cypher", "gremlin", "mongo" and any other language supported by ArcadeDB and available at runtime.</p>
</li>
<li>
<p><code>command</code> the command to execute in encoded format</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You might need to encode the URL if contains special characters and spaces.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Due to security reasons (encoded) slashes <code>/</code> (<code>%2F</code>) which are used for divisions or block
      comments, cannot be used in queries via the <code>query/</code> endpoint.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X GET http://localhost:2480/api/v1/query/school/sql/select%20from%20Class
     --user root:arcadedb-password</code></pre>
</div>
</div>
<h5 id="HTTP-ExecuteCommand" class="discrete">Execute database command (POST)</h5>
<div class="paragraph">
<p>Executes a non-idempotent command.</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/command/{database}</code></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>database</code> is the database name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example to create the new document type "Class":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/command/school
     -d '{ "language": "sql", "command": "create document type Class"}'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<div class="paragraph">
<p>The payload, as a JSON, accepts the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>language</code> is the query language used, between "sql", "sqlscript", "graphql", "cypher", "gremlin", "mongo" and any other language supported by ArcadeDB and available at runtime.</p>
</li>
<li>
<p><code>command</code> the command to execute in encoded format</p>
</li>
<li>
<p><code>limit</code> (optional) is the maximum number of results to return</p>
</li>
<li>
<p><code>params</code> (optional), is the map of parameters to pass to the query engine</p>
</li>
<li>
<p><code>serializer</code> (optional) specify the serializer used for the result:</p>
<div class="ulist">
<ul>
<li>
<p><code>graph</code>: returns as a graph separating vertices from edges</p>
</li>
<li>
<p><code>record</code>: returns everything as records</p>
</li>
<li>
<p>by default it&#8217;s like record but with additional metadata for vertex records, such as the number of outgoing edges in <code>@out</code> property and total incoming edges in <code>@in</code> property.
This serialzier is used by Studio</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example of insertion of a new Client by using parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/command/company
     -d '{ "language": "sql", "command": "create vertex Client set firstName = :firstName, lastName = :lastName", params: { "firstName": "Jay", "lastName", "Miner" } }'
     -H "Content-Type: application/json"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<h5 id="HTTP-Begin" class="discrete">Begin a transaction (POST)</h5>
<div class="paragraph">
<p>Begins a transaction on the server managed as a session.
The response header contains the session id.
Set this id in the following requests to execute them in the same transaction scope.
See also <a href="#HTTP-Commit">/commit</a> and <a href="#HTTP-Rollback">/rollback</a>.</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/begin/{database}</code></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>database</code> is the database name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The payload, optional as a JSON, accepts the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>isolationLevel</code> is isolation level for the current transaction between <code>READ_COMMITTED</code> (default) and <code>REPEATABLE_READ</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:2480/api/v1/begin/school
     --user root:arcadedb-password -I</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns the Session Id in the response header, example:</p>
</div>
<div class="paragraph">
<p><code>arcadedb-session-id: AS-ee056170-dc9b-4956-8d71-d7cfa01900d4</code></p>
</div>
<div class="paragraph">
<p>Use the session id in the request header of further commands you want to execute in the same transaction and execute <a href="#HTTP-Commit">/commit</a> to commit the server side transaction or <a href="#HTTP-Rollback">/rollback</a> to rollback the changes.
After a period of inactivity (default is 30 seconds), the server automatically rollback and purge expired transactions.</p>
</div>
<h5 id="HTTP-Commit" class="discrete">Commit a transaction (POST)</h5>
<div class="paragraph">
<p>Commits a transaction on the server.
Set the session id obtained with the <a href="#HTTP-Begin">/begin</a> command as a header of the request.
See also <a href="#HTTP-Begin">/begin</a> and <a href="#HTTP-Rollback">/rollback</a>.</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/commit/{database}</code></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>database</code> is the database name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Set the session id returned from the <a href="#HTTP-Begin">/begin</a> command in the request header.
If the session (and therefore the server side transaction) is expired, then a 500 Internal server error is returned.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/commit/school
     -H "arcadedb-session-id: AS-ee056170-dc9b-4956-8d71-d7cfa01900d4"
     --user root:arcadedb-password</code></pre>
</div>
</div>
<h5 id="HTTP-Rollback" class="discrete">Rollback a transaction (POST)</h5>
<div class="paragraph">
<p>Rollbacks a transaction on the server.
Set the session id obtained with the <a href="#HTTP-Begin">/begin</a> command as a header of the request.
See also <a href="#HTTP-Begin">/begin</a> and <a href="#HTTP-Commit">/commit</a>.</p>
</div>
<div class="paragraph">
<p>URL Syntax: <code>/api/v1/rollback/{database}</code></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>database</code> is the database name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Set the session id returned from the <a href="#HTTP-Begin">/begin</a> command in the request header.
If the session (and therefore the server side transaction) is expired, then a 500 Internal server error is returned.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:2480/api/v1/rollback/school
     -H "arcadedb-session-id: AS-ee056170-dc9b-4956-8d71-d7cfa01900d4"
     --user root:arcadedb-password</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Postgres-Driver">7.6. Postgres Protocol Plugin</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/postgres.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB Server supports a subset of the <a href="https://postgres.com">Postgres</a> wire protocol, such as connection and queries.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using ArcadeDB as embedded, please add the dependency to the <code>arcadedb-postgresw</code> library.
If you&#8217;re using Maven include this dependency in your <code>pom.xml</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.arcadedb&lt;/groupId&gt;
    &lt;artifactId&gt;arcadedb-postgresw&lt;/artifactId&gt;
    &lt;version&gt;23.3.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To start the Postgres plugin, enlist it in the <a href="#_settings"><code>server.plugins</code></a> settings.
To specify multiple plugins, use the comma <code>,</code> as separator.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ bin/server.sh -Darcadedb.server.plugins="Postgres:com.arcadedb.postgres.PostgresProtocolPlugin"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re using MS Windows OS, replace <code>server.sh</code> with <code>server.bat</code>.</p>
</div>
<div class="paragraph">
<p>In case you&#8217;re running ArcadeDB with Docker, use <code>-e</code> to pass settings and open the Postgres default port <code>5432</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">docker run --rm -p 2480:2480 -p 2424:2424 -p 5432:5432 \
       --env JAVA_OPTS="-Darcadedb.server.rootPassword=playwithdata \
          -Darcadedb.server.plugins=Postgres:com.arcadedb.postgres.PostgresProtocolPlugin " \
          arcadedata/arcadedb:latest</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Server output will contain this line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">2021-07-08 19:05:06.081 INFO  [ArcadeDBServer] &lt;ArcadeDB_0&gt; - Postgres Protocol plugin started</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you have enabled the Postgres Protocol, you can interact with ArcadeDB server by using any Postgres drivers.
The driver sends the queries to the ArcadeDB server without parsing or checking the syntax.
For this reason, even if ArcadeDB SQL is different from Postgres SQL, you&#8217;re still able to execute any ArcadeDB SQL command through the Postgres driver.
Check out the following list with the official drivers for the most popular programming languages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.postgresql.org/docs/current/libpq.html">C</a></p>
</li>
<li>
<p><a href="https://www.npgsql.org/">C#</a></p>
</li>
<li>
<p><a href="http://pqxx.org/development/libpqxx/">C++</a></p>
</li>
<li>
<p><a href="https://github.com/lib/pq">Go</a></p>
</li>
<li>
<p><a href="https://github.com/brianc/node-postgres">Javascript - Node.js</a></p>
</li>
<li>
<p><a href="https://www.php.net/manual/en/book.pgsql.php">PHP</a></p>
</li>
<li>
<p><a href="https://github.com/MagicStack/asyncpg">Python</a></p>
</li>
<li>
<p><a href="https://cran.r-project.org/web/packages/RPostgreSQL/index.html">R</a></p>
</li>
<li>
<p><a href="https://github.com/ged/ruby-pg">Ruby</a></p>
</li>
<li>
<p><a href="https://github.com/sfackler/rust-postgres">Rust</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the complete list, please check <a href="https://wiki.postgresql.org/wiki/List_of_drivers">Postgres website</a>.</p>
</div>
<div class="sect3">
<h4 id="_other_query_languages">7.6.1. Other query languages</h4>
<div class="paragraph">
<p>By default the Postgres driver interprets all the commands as <a href="#SQL">SQL</a>.
To use another supported language, like <a href="#Open-Cypher">Cypher</a>, <a href="#Gremlin-API">Gremlin</a>, <a href="#GraphQL">GraphQL</a> or <a href="#MongoDB-API">MongoDB</a>, prefix the command with the language to use between curly brackets.</p>
</div>
<div class="paragraph">
<p>Example to execute a query by using GraphQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-graphql" data-lang="graphql">{graphql}{ bookById(id: "book-1"){ id name authors { firstName, lastName } }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example to use Cypher:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">{cypher}MATCH (m:Movie)&lt;-[a:ACTED_IN]-(p:Person) WHERE id(m) = '#1:0' RETURN *</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example of using Gremlin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">{gremlin}g.V()</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_current_limitations">7.6.2. Current limitations</h4>
<div class="paragraph">
<p>The documentation about Postgres wire protocol is not exhaustive to build a bullet proof protocol.
In particular the state machine.
For this reason this plugin was created by reading the available documentation online (official and not official) and looking into Postgres drivers or implementations.</p>
</div>
</div>
<div class="sect3">
<h4 id="_transactions">7.6.3. Transactions</h4>
<div class="paragraph">
<p>Enabling auto commit to false is not 100% supported.
With JDBC, leave the default settings or set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">conn.setAutoCommit(true);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_postgres_tools_known_to_work">7.6.4. Postgres Tools Known to Work</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Some tools compatible with Postgres may execute queries on internal Postgres tables to retrieve the schema.
Those tables are not present in ArcadeDB, so it may return errors at startup.
If the tool that you use to work with Postgres is not compatible with ArcadeDB, please <a href="https://github.com/ArcadeData/arcadedb/issues">open an issue</a>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_jetbrains_datagripdatabase_plugin">JetBrains DataGrip/Database Plugin</h5>
<div class="paragraph">
<p>Connecting via JetBrains' database plugin is relatively straightforward.
The introspection features aren&#8217;t working yet, but the basics seem to work well.</p>
</div>
<div class="paragraph">
<p>To connect, create a new Postgres datasource and point it to the IP/port of your ArcadeDb server. (0.0.0.0:5432 by default) You will need to fill out the database field, or you&#8217;ll get an error on connection.
At present, changing the current database requires editing the datasource.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jetbrains-connection.png" alt="jetbrains connection">
</div>
</div>
<div class="paragraph">
<p>Next, you&#8217;ll need to set <code>preferQueryMode</code> to <strong>simple</strong> on the Advanced tab, like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jetbrains-querymode.png" alt="jetbrains querymode">
</div>
</div>
<div class="paragraph">
<p>You can then run queries via a console.
Even non-SQL queries will work, though expect squigglies!</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jetbrains-queries.png" alt="jetbrains queries">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_psql">psql</h5>
<div class="paragraph">
<p>Postgres&#8217;s psql tool works out of the box, just like with a "real" Postgres server.</p>
</div>
<div class="paragraph">
<p>Connect like this:
<code>psql -h localhost -U root movies</code></p>
</div>
<div class="paragraph">
<p>After authenticating, you can run queries as normal.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="JDBC">7.7. Connect with JDBC Driver</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/jdbc.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>If you&#8217;re using Java you can use the Postgres JDBC driver.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Class.forName("org.postgresql.Driver");

Properties props = new Properties();
props.setProperty("user", "user");
props.setProperty("password", "password");
props.setProperty("ssl", "false");

try (Connection conn = DriverManager.getConnection("jdbc:postgresql://localhost/mydb", props) ) {
  try (Statement st = conn.createStatement()) {
    st.executeQuery("create vertex type Hero");
    st.executeQuery("create vertex Hero set name = 'Jay', lastName = 'Miner'");

    PreparedStatement pst = conn.prepareStatement("create vertex Hero set name = ?, lastName = ?");
    pst.setString(1, "Rocky");
    pst.setString(2, "Balboa");
    pst.execute();
    pst.close();

    try( ResultSet rs = st.executeQuery("SELECT * FROM Hero") ) { // Type and property names are case sensitive!
      while (rs.next()) {
        System.out.println("First Name: " + rs.getString(1) + " - Last Name: " + rs.getString(2));
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Open-Cypher">7.8. Open Cypher</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/cypher.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB partially supports Open Cypher as query engine.
It uses <a href="https://github.com/opencypher/cypher-for-gremlin">Cypher for Gremlin</a> under-the-hood which has stopped being supported a few years ago.
There are a lot of things that work and a lot of nuances which don&#8217;t.</p>
</div>
<div class="paragraph">
<p>ArcadeDB also doesn&#8217;t support Neo4j&#8217;s BOLT protocol.
This means you can&#8217;t use a Neo4J driver with ArcadeDB server.</p>
</div>
<div class="paragraph">
<p>To use Cypher queries you can do directly from the <a href="#Java-API">Java API</a>, by using <a href="#HTTP-API">HTTP Api</a> or the <a href="#Postgres-Driver">Postgres driver</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Consider that Cypher queries are translated into Gremlin.
As much as ArcadeDB&#8217;s Gremlin implementation is optimized, queries run slower than using native SQL or Java API.
Based on some internal benchmarks, ArcadeDB&#8217;s native SQL (SELECT or MATCH) is much faster than Cypher (even 2,000% faster!).
The difference is larger with complex queries that work on many records.
A simple Cypher MATCH with a lookup with a simple condition will be closer to native SQL performance, but a scan or huge traversal will be much slower with Cypher, because of the underlying usage of Gremlin is not optimized for extreme performance.
</td>
</tr>
</table>
</div>
<h6 id="_cypher_from_java_api" class="discrete">Cypher from Java API</h6>
<div class="paragraph">
<p>In order to execute a Cypher query, you need to include the relevant jars in your class path.
To execute a Cypher query, use "cypher" as first parameter in the query method.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ResultSet result = database.query("cypher", "MATCH (p:Person) WHERE p.age &gt;= $p1 RETURN p.name, p.age ORDER BY p.age", "p1", 25);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use ArcadeDB&#8217;s <a href="#RID">RecordIDs (RID)</a> in a cypher query to start from a specific vertex.
RIDs in Cypher are always strings, therefore they must always be contained between single or double quotes.
Example of returning the graph connected to the vertex with RID <code>#1:0</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (m:Movie)&lt;-[a:ACTED_IN]-(p:Person) WHERE id(m) = '#1:0' RETURN *</code></pre>
</div>
</div>
<h6 id="_cypher_through_postgres_driver" class="discrete">Cypher through Postgres Driver</h6>
<div class="paragraph">
<p>You can execute a Cypher query against ArcadeDB server by using the <a href="#Postgres-Driver">Postgres driver</a> and prefixing the query with <code>{cypher}</code>.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">"{cypher} MATCH (p:Person) WHERE p.age &gt;= 25 RETURN p.name, p.age ORDER BY p.age"</code></pre>
</div>
</div>
<div class="paragraph">
<p>ArcadeDB server will execute the query <code>MATCH (p:Person) WHERE p.age &gt;= 25 RETURN p.name, p.age ORDER BY p.age</code> using the Cypher query language.</p>
</div>
<h6 id="_cypher_through_httpjson" class="discrete">Cypher through HTTP/JSON</h6>
<div class="paragraph">
<p>You can execute a Cypher query against ArcadeDB server by using <a href="#HTTP-API">HTTP/JSON</a> API.
Example of executing an idempotent query with HTTP GET command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl "http://localhost:2480/query/graph/cypher/MATCH (p:Person) WHERE p.age &gt;= 25 RETURN p.name, p.age ORDER BY p.age"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example of executing a non-idempotent query (updates the database):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST "http://localhost:2480/command/graph" -d "{'language': 'cypher', 'command': 'MATCH (p:Person) WHERE p.age &gt;= 25 RETURN p.name, p.age ORDER BY p.age'}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about Cypher:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://opencypher.org/">Open Cypher</a></p>
</li>
<li>
<p><a href="https://neo4j.com/docs/cypher-manual/current/">The Neo4j Cypher Manual</a></p>
</li>
<li>
<p><a href="https://learnxinyminutes.com/docs/cypher/">Learn Cypher in Y Minutes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Gremlin-API">7.9. Gremlin API</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/gremlin.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB supports Gremlin 3.6.x as query engine and in the <a href="#Gremlin-Server">Gremlin Server</a>.
You can execute a gremlin query from pretty much everywhere.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using ArcadeDB as embedded, please add the dependency to the <code>arcadedb-gremlin</code> library.
If you&#8217;re using Maven include this dependency in your <code>pom.xml</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.arcadedb&lt;/groupId&gt;
    &lt;artifactId&gt;arcadedb-gremlin&lt;/artifactId&gt;
    &lt;version&gt;23.3.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<h4 id="_gremlin_from_java_api" class="discrete">Gremlin from Java API</h4>
<div class="paragraph">
<p>In order to execute a Gremlin query, you need to include the relevant jars, i.e. the apache-tinkerpop-gremlin-server libraries, plus gremlin-groovy, plus opencypher-util-9.0, in your class path.
To execute a Gremlin query, use "gremlin" as first parameter in the query method.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ResultSet result = database.query("gremlin", "g.V().has('name','Steve').has('lastName','Jobs').out('IsFriendOf')");</code></pre>
</div>
</div>
<h4 id="_gremlin_through_postgres_driver" class="discrete">Gremlin through Postgres Driver</h4>
<div class="paragraph">
<p>You can execute a Gremlin query against ArcadeDB server by using the <a href="#Postgres-Driver">Postgres driver</a> and prefixing the query with <code>{gremlin}</code>.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Gremlin" data-lang="Gremlin">"{gremlin} g.V().has('name','Steve').has('lastName','Jobs').out('IsFriendOf')"</code></pre>
</div>
</div>
<div class="paragraph">
<p>ArcadeDB server will execute the query <code>g.V().has('name','Steve').has('lastName','Jobs').out('IsFriendOf')</code> using the Gremlin query language.</p>
</div>
<h4 id="_gremlin_through_httpjson" class="discrete">Gremlin through HTTP/JSON</h4>
<div class="paragraph">
<p>You can execute a Gremlin query against ArcadeDB server by using <a href="#HTTP-API">HTTP/JSON</a> API.
Example of executing an idempotent query with HTTP GET command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl "http://localhost:2480/query/graph/gremlin/g.V().has('name','Steve').has('lastName','Jobs').out('IsFriendOf')"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example of executing a non-idempotent query (updates the database):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST "http://localhost:2480/command/graph" -d "{'language': 'gremlin', 'command': 'g.V().has(\"name\",\"Steve\").has(\"lastName\",\"Jobs\").out(\"IsFriendOf\")'}"</code></pre>
</div>
</div>
<h4 id="Gremlin-Server" class="discrete">Use the Gremlin Server</h4>
<div class="paragraph">
<p>Apache TinkerPop Gremlin provides a standalone server to allow remote access with a Gremlin client.
In order to use the Gremlin Server with ArcadeDB, you have to enable it from ArcadeDB&#8217;s server plugin system:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ bin/server.sh -Darcadedb.server.plugins="GremlinServer:com.arcadedb.server.gremlin.GremlinServerPlugin"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re using MS Windows OS, replace <code>server.sh</code> with <code>server.bat</code>.</p>
</div>
<div class="paragraph">
<p>At startup, the Gremlin Server plugin looks for the file <code>config/gremlin-server.yaml</code> under ArcadeDB path.
If the file is present, the Gremlin Server will be configured with the settings contained in the YAML file, otherwise the default configuration will be used.</p>
</div>
<div class="paragraph">
<p>You can also override single configuration settings by using <a href="#Settings">ArcadeDB&#8217;s settings</a> and prefixing the configuration key with <code>gremlin.</code>.
All the configuration settings with such a prefix will be passed to the Gremlin Server plugin.</p>
</div>
<div class="paragraph">
<p>By default, the database "graph" will be available through the Gremlin Server.
You can edit the database name or add more databases under the Gremlin Server by editing the file <code>config/gremlin-server.groovy</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you&#8217;re importing a database, use "graph" as the name of the database to be available through the <a href="#Gremlin-Server">Gremlin Server</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Start the Gremlin Server with <code>OpenBeer</code> as imported database with name <code>graph</code>, so it can be used through the Gremlin Server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">docker run -d --name arcadeDb -p 2424:2424 -p 2480:2480 -p 8182:8182
       --env JAVA_OPTS="-Darcadedb.server.rootPassword=playwithdata \
          -Darcadedb.server.defaultDatabases=Imported[root]{import:https://github.com/ArcadeData/arcadedb-datasets/raw/main/orientdb/OpenBeer.gz} \
          -Darcadedb.server.plugins=GremlinServer:com.arcadedb.server.gremlin.GremlinServerPlugin " \
          arcadedata/arcadedb:latest</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In case you&#8217;re running ArcadeDB with Docker, open the port <code>8182</code> and use <code>-e</code> to pass the settings
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information about Gremlin:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://tinkerpop.apache.org/gremlin.html">Introduction to Gremlin</a></p>
</li>
<li>
<p><a href="http://tinkerpop.apache.org/docs/current/tutorials/getting-started/">Getting Started with Gremlin</a></p>
</li>
<li>
<p><a href="http://tinkerpop.apache.org/docs/current/tutorials/the-gremlin-console/">The Gremlin Console</a></p>
</li>
<li>
<p><a href="http://tinkerpop.apache.org/docs/current/recipes/">Gremlin Recipes</a></p>
</li>
<li>
<p><a href="https://kelvinlawrence.net/book/PracticalGremlin.html">PRACTICAL GREMLIN: An Apache TinkerPop Tutorial</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="GraphQL">7.10. GraphQL</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/graphql.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB Server supports a subset of the <a href="https://graphql.org/">GraphQL</a> specification.
Please open an issue or a discussion on GitHub to increase the support for GraphQL.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using ArcadeDB as embedded, please add the dependency to the <code>arcadedb-graphql</code> library.
If you&#8217;re using Maven include this dependency in your <code>pom.xml</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.arcadedb&lt;/groupId&gt;
    &lt;artifactId&gt;arcadedb-graphql&lt;/artifactId&gt;
    &lt;version&gt;23.3.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>GraphQL is supported in ArcadeDB as a query language engine.
This means you can execute a GraphQL command from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java API by using the non-idempotent <code>.command()</code> and the idempotent <code>.query()</code> API by using <code>"graphql"</code> as language.
Example: <code>Resultset resultset = db.query("graphql", "{ bookById(id: "book-1"){ id name authors { firstName, lastName } }");</code></p>
</li>
<li>
<p>HTTP API by using <a href="#HTTP-Command"><code>/command</code></a> and <a href="#HTTP-ExecuteQuery"><code>/query</code></a> commands and <code>"graphql"</code> as language</p>
</li>
<li>
<p><a href="#Postgres-Driver">Postgres Driver</a> by prefixing with <code>{graphql}</code> your query to execute.
Example: <code>{graphql}{ bookById(id: "book-1"){ id name authors { firstName, lastName } }</code></p>
</li>
</ul>
</div>
<h4 id="_type_definition" class="discrete">Type definition</h4>
<div class="paragraph">
<p>GraphQL requires to define the types used.
If you&#8217;re using the <a href="#Document-Model">Document Model</a> and links to connect documents, then you can map 1-1 the GraphQL type to ArcadeDB type.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-graphql" data-lang="graphql">type Book {
  id: ID
  name: String
  pageCount: Int
  authors: [Author]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re using a <a href="#Graph-Model">Graph Model</a> for your domain, then you need to declare with a GraphQL directive how the relationship is translated on the graph model.</p>
</div>
<div class="paragraph">
<p>In the example below, the <code>authors</code> is a collection of Author retrieved by looking at the incoming (<code>direction: IN</code>) edges of type "IS_AUTHOR_OF" (<code>type: "IS_AUTHOR_OF"</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-graphql" data-lang="graphql">type Book {
  id: ID
  name: String
  pageCount: Int
  authors: [Author] @relationship(type: "IS_AUTHOR_OF", direction: IN)
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Directives can be defined on both types and queries.
Directives defined in queries override any directives defined in types, only for the query execution context.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can define your model incrementally and apply it to the current database instance by executing a command containing the type definition.
Example by using Java API (but the same by using <a href="#HTTP-Command">HTTP Command</a> API):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String types = "type Query {" +
              "  bookById(id: ID): Book" +
              "}" +
              "type Book {" +
              "  id: ID" +
              "  name: String" +
              "  pageCount: Int" +
              "  authors: [Author] @relationship(type: \"IS_AUTHOR_OF\", direction: IN)" +
              "}" +
              "type Author {" +
              "  id: ID" +
              "  firstName: String" +
              "  lastName: String" +
              "}";

database.command("graphql", types);</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this example the types <code>Book</code> and <code>Author</code> are defined together with the query <code>bookById</code>.
You can add new types or replace existing types by just submitting the type(s) again.
The GraphQL module will update the current definition of types.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This definition is not saved in the database and must be declared after the database is open, before executing any GraphQL queries.
</td>
</tr>
</table>
</div>
<h4 id="_supported_directives" class="discrete">Supported directives</h4>
<div class="paragraph">
<p>Directives can be defined on both types and queries.
Directives defined in queries override any directives defined in types, only for the query execution context.</p>
</div>
<h5 id="_relationship" class="discrete">@relationship</h5>
<div class="paragraph">
<p>Applies to: <code>Query Field</code> and <code>Field Definition</code></p>
</div>
<div class="paragraph">
<p>Syntax: <code>@relationship([type: "&lt;type-name&gt;"] [, direction: &lt;OUT|IN|BOTH&gt;])</code></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>type</code> is the edge type, optional.
If not specified, then all the types are considered</p>
</li>
<li>
<p><code>direction</code> is the direction of the edge, optional.
If not specified, then BOTH is used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-graphql" data-lang="graphql">friends: [Account] @relationship(type: "FRIEND", direction: BOTH)</code></pre>
</div>
</div>
<h5 id="Graphql-sql" class="discrete">@sql</h5>
<div class="paragraph">
<p>Applies to: <code>Query Field</code> and <code>Field Definition</code></p>
</div>
<div class="paragraph">
<p>Syntax: <code>@sql( statement: &lt;sql-statement&gt; )</code></p>
</div>
<div class="paragraph">
<p>Executes a <a href="#SQL">SQL</a> query.
The query can use parameters passed at invocation time.</p>
</div>
<div class="paragraph">
<p>Example of definition of a query using <a href="#SQL">SQL</a> in GraphQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-graphql" data-lang="graphql">bookByName(bookNameParameter: String): Book @sql(statement: "select from Book where name = :bookNameParameter")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Invoke the query defined above passing the book name as parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ResultSet resultSet = database.query("graphql", "{ bookByName(bookNameParameter: \"Harry Potter and the Philosopher's Stone\")}"));</code></pre>
</div>
</div>
<h5 id="_gremlin" class="discrete">@gremlin</h5>
<div class="paragraph">
<p>Applies to: <code>Query Field</code> and <code>Field Definition</code></p>
</div>
<div class="paragraph">
<p>Syntax: <code>@gremlin( statement: &lt;gremlin-statement&gt; )</code></p>
</div>
<div class="paragraph">
<p>Executes a <a href="#Gremlin-API">Gremlin</a> query.
The query can use parameters passed at invocation time.</p>
</div>
<div class="paragraph">
<p>Example of definition of a query using <a href="#Gremlin-API">Gremlin</a> in GraphQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-graphql" data-lang="graphql">bookByName(bookNameParameter: String): Book @gremlin(statement: "g.V().has('name', bookNameParameter)")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Invoke the query defined above passing the book name as parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ResultSet resultSet = database.query("graphql", "{ bookByName(bookNameParameter: \"Harry Potter and the Philosopher's Stone\")}"));</code></pre>
</div>
</div>
<h5 id="_cypher" class="discrete">@cypher</h5>
<div class="paragraph">
<p>Applies to: <code>Query Field</code> and <code>Field Definition</code></p>
</div>
<div class="paragraph">
<p>Syntax: <code>@cypher( statement: &lt;cypher-statement&gt; )</code></p>
</div>
<div class="paragraph">
<p>Executes a <a href="#Open-Cypher">Cypher</a> query.
The query can use parameters passed at invocation time.</p>
</div>
<div class="paragraph">
<p>Example of definition of a query using <a href="#Open-Cypher">Cypher</a> in GraphQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-graphql" data-lang="graphql">bookByName(bookNameParameter: String): Book @cypher(statement: "MATCH (b:Book {name: $bookNameParameter}) RETURN b")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Invoke the query defined above passing the book name as parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ResultSet resultSet = database.query("graphql", "{ bookByName(bookNameParameter: \"Harry Potter and the Philosopher's Stone\")}"));</code></pre>
</div>
</div>
<h5 id="_rid" class="discrete">@rid</h5>
<div class="paragraph">
<p>Applies to: <code>Query Field</code> and <code>Field Definition</code></p>
</div>
<div class="paragraph">
<p>Syntax: <code>@rid</code></p>
</div>
<div class="paragraph">
<p>Mark the field as the record identity or <a href="#RID">Record ID</a>.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-graphql" data-lang="graphql">{ bookById(id: "book-1")
  {
    rid @rid
    id
    name
    authors {
      firstName
      lastName
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="MongoDB-API">7.11. MongoDB API</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/mongo.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB provides support for both MongoDB Query Language and MongoDB protocol.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using ArcadeDB as embedded, please add the dependency to the <code>arcadedb-mongodbw</code> library.
If you&#8217;re using Maven include this dependency in your <code>pom.xml</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.arcadedb&lt;/groupId&gt;
    &lt;artifactId&gt;arcadedb-mongodbw&lt;/artifactId&gt;
    &lt;version&gt;23.3.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_mongodb_query_language">7.11.1. MongoDB Query Language</h4>
<div class="paragraph">
<p>If you want to use MongoDB Query Language from <a href="#Java-API">Java API</a>, you can simply keep the relevant jars in your classpath and execute a query or a command with "mongo" as language.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// CREATE A NEW DATABASE
Database database = new DatabaseFactory("heroes").create();

// CREATE THE DOCUMENT TYPE 'HEROES'
database.getSchema().createDocumentType("Heros");

// CREATE A NEW DOCUMENT
database.transaction((tx) -&gt; {
  database.newDocument("Heros").set("name", "Jay").set("lastName", "Miner").set("id", i).save();
});

// EXECUTE A QUERY USING MONGO AS QUERY LANGUAGE
for (ResultSet resultset = database.query("mongo", // &lt;-- USE 'mongo' INSTEAD OF 'sql'
    "{ collection: 'Heros', query: { $and: [ { name: { $eq: 'Jay' } }, { lastName: { $exists: true } }, { lastName: { $eq: 'Miner' } }, { lastName: { $ne: 'Miner22' } } ], $orderBy: { id: 1 } } }"); resultset.hasNext(); ++i) {
  Result doc = resultset.next();
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on the MongoDB query language see: <a href="https://www.mongodb.com/docs/current/crud/">MongoDB CRUD Operations</a></p>
</div>
<div class="sect4">
<h5 id="_mongo_queries_through_postgres_driver">Mongo queries through Postgres Driver</h5>
<div class="paragraph">
<p>You can execute a Mongo query against ArcadeDB server by using the <a href="#Postgres-Driver">Postgres driver</a> and prefixing the query with <code>{mongo}</code>.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"{mongo} { collection: 'Heros', query: { $and: [ { name: { $eq: 'Jay' } }, { lastName: { $exists: true } }, { lastName: { $eq: 'Miner' } } ] } }"</code></pre>
</div>
</div>
<div class="paragraph">
<p>ArcadeDB server will execute the query <code>{ collection: 'Heros', query: { $and: [ { name: { $eq: 'Jay' } }, { lastName: { $exists: true } }, { lastName: { $eq: 'Miner' } } ] } }</code> using the Mongo query language.</p>
</div>
</div>
<div class="sect4">
<h5 id="_mongo_queries_through_httpjson">Mongo queries through HTTP/JSON</h5>
<div class="paragraph">
<p>You can execute a Mongo query against ArcadeDB server by using <a href="#HTTP-API">HTTP/JSON</a> API.
Example of executing an idempotent query with HTTP GET command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl "http://localhost:2480/query/graph/mongo/{ collection: 'Heros', query: { $and: [ { name: { $eq: 'Jay' } }, { lastName: { $exists: true } }, { lastName: { $eq: 'Miner' } } ]} }"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also execute the same query in HTTP POST, passing the language and query in payload:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">curl -X POST "http://localhost:2480/query/graph" -d "{'language': 'mongo', 'command': '{ collection: \"Heros\", query: { $and: [ { name: { $eq: \"Jay\" } }, { lastName: { $exists: true } }, { lastName: { $eq: \"Miner\" } } ] } }\"}"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="MongoDB-Protocol">7.11.2. MongoDB Protocol Plugin</h4>
<div class="paragraph">
<p>If your application is written for <a href="https://mongodb.com">MongoDB</a> and you&#8217;d like to run it with ArcadeDB instead, you can simply replace the MongoDB server with ArcadeDB server with the MongoDB Plugin installed.
This plugin supports MongoDB BSON Network protocol.
In this way you can use any MongoDB driver for any supported programming language.</p>
</div>
<div class="paragraph">
<p>ArcadeDB Server supports a subset of the <a href="https://mongodb.com">MongoDB</a> protocol, like CRUD operations and queries.</p>
</div>
<div class="paragraph">
<p>To start the MongoDB plugin, enlist it in the <a href="#Settings"><code>server.plugins</code></a> settings.
To specify multiple plugins, use the comma <code>,</code> as separator.</p>
</div>
<div class="paragraph">
<p>Example to start ArcadeDB with the MongoDB Plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ bin/server.sh -Darcadedb.server.plugins="MongoDB:com.arcadedb.mongo.MongoDBProtocolPlugin"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re using MS Windows OS, replace <code>server.sh</code> with <code>server.bat</code>.</p>
</div>
<div class="paragraph">
<p>In case you&#8217;re running ArcadeDB with Docker, use <code>-e</code> to pass settings (Port 27017 is the default MongoDB binary port):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">docker run --rm -p 2480:2480 -p 2424:2424 -p27017:27017 \
       --env JAVA_OPTS="-Darcadedb.server.rootPassword=playwithdata \
          -Darcadedb.server.plugins=MongoDB:com.arcadedb.mongo.MongoDBProtocolPlugin " \
          arcadedata/arcadedb:latest</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Server output will contain this line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">2018-10-09 18:47:01:692 INFO  &lt;ArcadeDB_0&gt; - MongoDB Protocol plugin started [ArcadeDBServer]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Redis-API">7.12. Redis API</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/api/redis.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB Server supports a subset of the <a href="https://redis.io">Redis</a> protocol.
Please open an issue or a discussion on GitHub to support more commands.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using ArcadeDB as embedded, please add the dependency to the <code>arcadedb-redisw</code> library.
If you&#8217;re using Maven include this dependency in your <code>pom.xml</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.arcadedb&lt;/groupId&gt;
    &lt;artifactId&gt;arcadedb-redisw&lt;/artifactId&gt;
    &lt;version&gt;23.3.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>ArcadeDB Redis plugin works in 2 ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Manage <strong>transient</strong> (non-persistent) entries in the server.
This is useful to manage user sessions and other records you don&#8217;t need to store in the database.</p>
</li>
<li>
<p>Manage <strong>persistent</strong> entries in the database.
You can save and read any documents, vertices and edges from the underlying database.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="Redis-Protocol">7.12.1. Installation</h4>
<div class="paragraph">
<p>To start the Redis plugin, enlist it in the <a href="#Settings"><code>server.plugins</code></a> settings.
To specify multiple plugins, use the comma <code>,</code> as separator.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">~/arcadedb $ bin/server.sh -Darcadedb.server.plugins="Redis:com.arcadedb.redis.RedisProtocolPlugin"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re using MS Windows OS, replace <code>server.sh</code> with <code>server.bat</code>.</p>
</div>
<div class="paragraph">
<p>In case you&#8217;re running ArcadeDB with Docker, open the port <code>6379</code> and use <code>-e</code> to pass settings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">docker run --rm -p 2480:2480 -p 2424:2424 -p 6379:6379 \
        --env JAVA_OPTS="-Darcadedb.server.rootPassword=playwithdata \
           -Darcadedb.server.plugins=Redis:com.arcadedb.redis.RedisProtocolPlugin " \
           arcadedata/arcadedb:latest</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Server output will contain this line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">2018-10-09 18:47:58:395 INFO  &lt;ArcadeDB_0&gt; - Redis Protocol plugin started [ArcadeDBServer]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Redis-HowWorks">7.12.2. How it works</h4>
<div class="paragraph">
<p>ArcadeDB works in 2 ways with the Redis protocol:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Transient commands</strong>, key/value pairs saved will be not saved in the database.
This is perfect to store transient data, like user sessions.</p>
</li>
<li>
<p><strong>Persistent commands</strong>, key/value pairs allows to store and retrieve ArcadeDB documents, vertices and edges</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/redis-api.png" alt="redis api">
</div>
</div>
<h4 id="_transient_ram_only_commands" class="discrete">Transient (RAM Only) Commands</h4>
<div class="paragraph">
<p>Below you can find the supported commands.
The link takes you to the official Redis documentation.
Please open an issue or a discussion on GitHub to support more commands.</p>
</div>
<div class="paragraph">
<p>The following commands do not take the bucket as a parameter because they work only in RAM on a shared (thread-safe) hashmap.
This means all the stored values are reset when the server restarts.</p>
</div>
<div class="paragraph">
<p><strong>Available transient commands (in alphabetic order)</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://redis.io/commands/decr">DECR</a>, Decrement a value by 1</p>
</li>
<li>
<p><a href="https://redis.io/commands/decrby">DECRBY</a>, Decrement a value by a specific amount (64-bit precision)</p>
</li>
<li>
<p><a href="https://redis.io/commands/exists">EXISTS</a>, Check if key exists</p>
</li>
<li>
<p><a href="https://redis.io/commands/get">GET</a>, Return the value associated with a key</p>
</li>
<li>
<p><a href="https://redis.io/commands/getdel">GETDEL</a>, Remove and return the value associated with a key</p>
</li>
<li>
<p><a href="https://redis.io/commands/incr">INCR</a>, Increment a value by 1</p>
</li>
<li>
<p><a href="https://redis.io/commands/incrby">INCRBY</a>, Increment a value by a specific amount (64-bit precision)</p>
</li>
<li>
<p><a href="https://redis.io/commands/incrbyfloat">INCRBYFLOAT</a>, Increment a value by a specific amount expresses as a float (64-bit precision)</p>
</li>
<li>
<p><a href="https://redis.io/commands/set">SET</a>, Set a value associated with a key</p>
</li>
</ul>
</div>
<h4 id="_persistent_commands" class="discrete">Persistent Commands</h4>
<div class="paragraph">
<p>The following commands act on persistent buckets in the database.
Records (documents, vertices and edges) are always in form of JSON embedded in strings.
The bucket name is mapped as the database name first, then type, the index or the record&#8217;s <a href="#RID"><code>RID</code></a> based on the use case.
An index must exist on the property you used to retrieve the document, otherwise an error is returned.</p>
</div>
<div class="paragraph">
<p>For the sake of this tutorial, we&#8217;re going to create the account document type totally schemaless but for some indexed properties: <code>id</code> as a unique long, <code>email</code> as a unique string and the pair <code>firstName</code> and <code>lastName</code> both strings and indexed with a composite key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE DOCUMENT TYPE Account

CREATE PROPERTY Account.id LONG
CREATE INDEX `Account[id]` ON Account (id) UNIQUE

CREATE PROPERTY Account.email STRING
CREATE INDEX `Account[email]` ON Account (email) UNIQUE

CREATE PROPERTY Account.firstName STRING
CREATE PROPERTY Account.lastName STRING
CREATE INDEX `Account[firstName,lastName]` ON Account (firstName,lastName) UNIQUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can create a new document with Redis protocol and the <a href="https://redis.io/commands/hset">HSET</a> Redis command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-redis" data-lang="redis">HSET MyDatabase.Account "{'id':123,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>To retrieve the document inserted above by <code>id</code> (O(logN) complexity), you can use the <a href="https://redis.io/commands/hget">HGET</a> Redis command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-redis" data-lang="redis">HGET MyDatabase.Account[id] 123
"{'@rid':'#1:0','@type':'Account','id':123,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>To retrieve the same document by <code>email</code> (O(logN) complexity), you can use the <a href="https://redis.io/commands/hget">HGET</a> Redis command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-redis" data-lang="redis">HGET MyDatabase.Account[email] "jay.miner@commodore.com"
"{'@rid':'#1:0','@type':'Account','id':123,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>To retrieve the same document by the pair <code>firstName</code> and <code>lastName</code> (O(logN) complexity), we are going to use the composite key we created before:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-redis" data-lang="redis">HGET MyDatabase.Account[firstName,lastName] "[\"Jay\",\"Miner\"]"
"{'@rid':'#1:0','@type':'Account','id':123,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>To retrieve the document inserted above by it <a href="#RID"><code>RID</code></a> (O(1) complexity), you can use the <a href="https://redis.io/commands/hget">HGET</a> Redis command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-redis" data-lang="redis">HGET MyDatabase "#1:0"
"{'@rid':'#1:0','@type':'Account','id':123,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also get multiple record in one call by using the <a href="https://redis.io/commands/hmget">HMGET</a> Redis command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-redis" data-lang="redis">HMGET MyDatabase "#1:0" "#1:1" "#1:2"
"{'@rid':'#1:0','@type':'Account','id':123,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"
"{'@rid':'#1:1','@type':'Account','id':232,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"
"{'@rid':'#1:2','@type':'Account','id':12,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or the same, but by a key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-redis" data-lang="redis">HMGET MyDatabase.Account[id] 123 232 12
"{'@rid':'#1:0','@type':'Account','id':123,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"
"{'@rid':'#1:1','@type':'Account','id':232,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"
"{'@rid':'#1:2','@type':'Account','id':12,'email':'jay.miner@commodore.com','firstName':'Jay','lastName':'Miner'}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>To delete the document inserted above by <code>email</code>, you can use the <a href="https://redis.io/commands/hdel">HDEL</a> Redis command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-redis" data-lang="redis">HDEL MyDatabase.Account[email] "jay.miner@commodore.com"
:1</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The returning JSON could have a different ordering of the properties from the one you have inserted.
This is because JSON doesn&#8217;t maintain the order of properties, but only of arrays (<code>[]</code>).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Available persistent commands (in alphabetic order)</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://redis.io/commands/hdel">HDEL</a>, Delete one or more records by a key, a composite key or record&#8217;s id</p>
</li>
<li>
<p><a href="https://redis.io/commands/hexists">HEXISTS</a>, Check if a key exists</p>
</li>
<li>
<p><a href="https://redis.io/commands/hget">HGET</a>, Retrieve a record by a key, a composite key or record&#8217;s id</p>
</li>
<li>
<p><a href="https://redis.io/commands/hmget">HMGET</a>, Retrieve multiple records by a key, a composite key or record&#8217;s id</p>
</li>
<li>
<p><a href="https://redis.io/commands/hset">HSET</a>, Create and update one or more records by a key, a composite key or record&#8217;s id</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Available miscellaneous commands</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://redis.io/commands/ping">PING</a>, Returns its argument (for testing server readiness or latency)</p>
</li>
</ul>
</div>
<h5 id="_settings" class="discrete">Settings</h5>
<div class="paragraph">
<p>To change the host where the Redis protocol is listening, set the setting <code>arcadedb.redis.host</code>.
By default, is <code>0.0.0.0</code> which means listen to all the configured network interfaces.
To change the default port (6379) set <code>arcadedb.redis.port</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="SQL">8. SQL</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/chapter.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p><strong>Overview Commands</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">CRUD &amp; Graph</th>
<th class="tableblock halign-left valign-top">Schema &amp; Buckets</th>
<th class="tableblock halign-left valign-top">Database &amp; Indexes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Select">SELECT</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Create-Type">CREATE TYPE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Console">CREATE DATABASE (<em>console only</em>)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Insert">INSERT</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Alter-Type">ALTER TYPE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Alter-Database">ALTER DATABASE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Update">UPDATE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Drop-Type">DROP TYPE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Console">DROP DATABASE (<em>console only</em>)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Delete">DELETE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Truncate-Type">TRUNCATE TYPE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Backup-Database">BACKUP DATABASE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Create-Vertex">CREATE VERTEX</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Create-Bucket">CREATE BUCKET</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Import-Database">IMPORT DATABASE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Create-Edge">CREATE EDGE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALTER BUCKET (<em>not implemented</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_sql-export-database">EXPORT DATABASE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Match">MATCH</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Drop-Bucket">DROP BUCKET</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_sql-check-database">CHECK DATABASE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Traverse">TRAVERSE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Truncate-Bucket">TRUNCATE BUCKET</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_sql-align-database">ALIGN DATABASE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Planning</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Create-Property">CREATE PROPERTY</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Create-Index">CREATE INDEX</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Explain">EXPLAIN</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Alter-Property">ALTER PROPERTY</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_sql-rebuild-index">REBUILD INDEX</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Profile">PROFILE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Drop-Property">DROP PROPERTY</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Drop-Index">DROP INDEX</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Overview Functions</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Graph</th>
<th class="tableblock halign-left valign-top">Math</th>
<th class="tableblock halign-left valign-top">Collections</th>
<th class="tableblock halign-left valign-top">Geometric</th>
<th class="tableblock halign-left valign-top">Misc</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_out">out()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_count">count()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_set">set()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_point">point()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_date">date()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_in">in()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_min">min()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_map">map()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_circle">circle()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_sysdate">sysdate()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_both">both()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_max">max()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_list">list()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_rectangle">rectangle()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_format">format()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_oute">outE()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_sum">sum()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_first">first()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_linestring">lineString()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_strcmpci">strcmpci()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_ine">inE()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_avg">avg()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_last">last()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_polygon">polygon()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_if">if()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_bothe">bothE()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_sqrt">sqrt()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_intersect">intersect()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_ifnull">ifnull()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_outv">outV()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_abs">abs()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_unionall">unionall()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_coalesce">coalesce()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_inv">inV()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_variance">variance()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_distinct">distinct()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_uuid">uuid()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_bothv">bothV()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_stddev">stddev()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_difference">difference()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_encode">encode()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_traversedelement">traversedElement()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_mode">mode()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#symmetricDifference">symmetricDifference()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_decode">decode()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_traversedvertex">traversedVertex()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_median">median()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_expand">expand()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_traversededge">traversedEdge()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_decimal">decimal()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_shortestpath">shortestPath()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_percentile">percentile()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_dijkstra">dijkstra()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_distance">distance()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_astar">astar()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Overview Methods</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Conversions</th>
<th class="tableblock halign-left valign-top">String manipulation</th>
<th class="tableblock halign-left valign-top">Collections</th>
<th class="tableblock halign-left valign-top">Geometric</th>
<th class="tableblock halign-left valign-top">Misc</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_convert">convert()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_append">append()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Methods-squares">[]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_iswithin">isWithin()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_exclude">exclude()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asboolean">asBoolean()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_charat">charAt()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_size">size()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_intersectswith">intersectsWith()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_include">include()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asdate">asDate()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_indexof">indexOf()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_remove">remove()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_javatype">javaType()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asdatetime">asDateTime()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_left">left()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_removeall">removeAll()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_tojson">toJSON()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asdecimal">asDecimal()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_right">right()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_keys">keys()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_type">type()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asfloat">asFloat()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_prefix">prefix()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_values">values()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_hash">hash()</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asinteger">asInteger()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_trim">trim()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_aslist">asList()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_replace">replace()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_aslong">asLong()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_length">length()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asmap">asMap()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_substring">subString()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asrid">asRID()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_tolowercase">toLowerCase()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asset">asSet()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_touppercase">toUpperCase()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asstring">asString()</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_normalize">normalize()</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<h3 id="_introduction_2" class="discrete">Introduction</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Introduction.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>When it comes to query languages, <a href="https://en.wikipedia.org/wiki/SQL">SQL</a> is the most widely recognized standard. The majority of developers have experience and are
comfortable with SQL. For this reason ArcadeDB uses SQL as its query language and adds some extensions to enable graph
functionality. There are a few differences between the standard SQL syntax and that supported by ArcadeDB, but for the most part, it
should feel very natural. The differences are covered in the <a href="#ArcadeDB-SQL-Dialect">ArcadeDB SQL dialect</a> section of this page.</p>
</div>
<div class="paragraph">
<p>If you are looking for the most efficient way to traverse a graph, we suggest using <a href="#SQL-Match">MATCH</a> instead.</p>
</div>
<div class="paragraph">
<p>Many SQL commands share the <a href="#Filtering">WHERE condition</a>. Keywords are case insensitive, but type names, property names and values
are case sensitive. In the following examples keywords are in uppercase but this is not strictly required.</p>
</div>
<div class="paragraph">
<p>For example, if you have a type <code>MyType</code> with a field named <code>id</code>, then the following SQL statements are equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM MyType WHERE id = 1
select from MyType where id = 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following is NOT equivalent. Notice that the field name 'ID' is not the same as 'id'.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM MyType WHERE ID = 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also the following query is NOT equivalent because of the type 'mytype ' is not the same as 'MyType'.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM mytype WHERE id = 1</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Automatic usage of indexes</strong></p>
</div>
<div class="paragraph">
<p>ArcadeDB allows you to execute queries against any field, indexed or not-indexed. The SQL engine automatically recognizes if any
indexes can be used to speed up execution. You can also query any indexes directly by using <code>INDEX:&lt;index-name&gt;</code> as a target.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM INDEX:myIndex WHERE key = 'Jay'</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Extra resources</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Syntax">Syntax</a></p>
</li>
<li>
<p><a href="#SQL-Projections">Projections</a></p>
</li>
<li>
<p><a href="#Filtering">Where clause</a></p>
</li>
<li>
<p><a href="#_filtering-operators">Operators</a></p>
</li>
<li>
<p><a href="#SQL-Pagination">Pagination</a></p>
</li>
<li>
<p><a href="#SQL-BATCH">Batch</a></p>
</li>
<li>
<p><a href="#SQL-Match">Match</a> for traversing graphs</p>
</li>
</ul>
</div>
<div id="ArcadeDB-SQL-Dialect" class="paragraph">
<p><strong>ArcadeDB SQL dialect</strong></p>
</div>
<div class="paragraph">
<p>ArcadeDB supports SQL as a query language with some differences compared with SQL.
The ArcadeDB team decided to avoid creating Yet-Another-Query-Language.
Instead we started from familiar SQL with extensions to work with graphs.
We prefer to focus on standards.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/sql.png" alt="SQL command categorization"></span></p>
</div>
<div class="paragraph">
<p><strong>Learning SQL</strong></p>
</div>
<div class="paragraph">
<p>If you want to learn SQL, there are many online courses such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cs-blog.khanacademy.org/2015/05/just-released-full-introductory-sql.html">KhanAcademy</a></p>
</li>
<li>
<p><a href="https://www.w3schools.com/sql/sql_intro.asp">Introduction to SQL at W3 Schools</a></p>
</li>
<li>
<p><a href="https://blog.udemy.com/beginners-guide-to-sql/">Beginner guide to SQL</a></p>
</li>
<li>
<p><a href="https://www.sqlcourse2.com/intro2.html">SQLCourse.com</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/playlist?list=PLD20298E653A970F8">YouTube channel Basic SQL Training by Joey Blue</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>alternatively, order a book such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.amazon.com/SQL-Minutes-Sams-Teach-Yourself/dp/0135182794">SQL in 10 Minutes a Day</a></p>
</li>
<li>
<p>or any of <a href="https://www.amazon.com/s/ref=nb_sb_noss/189-0251150-4407173?url=search-alias%3Daps&amp;field-keywords=sql">these</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For details on ArcadeDB&#8217;s dialect, see <a href="#SQL-Syntax">ArcadeDB SQL Syntax</a>.</p>
</div>
<div class="paragraph">
<p><strong>No JOINs</strong>
The most important difference between ArcadeDB and a Relational Database is that relationships are represented by <code>LINKS</code> instead of
JOINs.</p>
</div>
<div class="paragraph">
<p>For this reason, the typical JOIN syntax of relational databases is not supported. ArcadeDB uses the "dot (<code>.</code>) notation" to
navigate <code>LINKS</code>. Example 1 :
In SQL you might create a join such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT *
FROM Employee A, City B
WHERE A.city = B.id
AND B.name = 'Rome'</code></pre>
</div>
</div>
<div class="paragraph">
<p>In ArcadeDB, an equivalent operation would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT * FROM Employee WHERE city.name = 'Rome'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is much more straight forward and powerful! If you use multiple JOINs, the ArcadeDB SQL equivalent will be an even larger
benefit. Example 2: In SQL you might create a join such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT *
FROM Employee A, City B, Country C,
WHERE A.city = B.id
AND B.country = C.id
AND C.name = 'Italy'</code></pre>
</div>
</div>
<div class="paragraph">
<p>In ArcadeDB, an equivalent operation would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT * FROM Employee WHERE city.country.name = 'Italy'</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Projections</strong></p>
</div>
<div class="paragraph">
<p>In SQL, projections are mandatory and you can use the star character <code>*</code> to include all of the fields. With ArcadeDB this type of
projection is optional. Example: In SQL to select all of the columns of Customer you would write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT * FROM Customer</code></pre>
</div>
</div>
<div class="paragraph">
<p>In ArcadeDB, the <code>*</code> is optional:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Customer</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#SQL-Projections">Projections</a>.</p>
</div>
<div class="paragraph">
<p><strong>DISTINCT</strong></p>
</div>
<div class="paragraph">
<p>You can use DISTINCT keyword exactly as in a relational database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT DISTINCT name FROM City</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>HAVING</strong></p>
</div>
<div class="paragraph">
<p>ArcadeDB does not support the <code>HAVING</code> keyword, but with a nested query it&#8217;s easy to obtain the same result. Example in SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT city, sum(salary) AS salary
FROM Employee
GROUP BY city
HAVING salary &gt; 1000</code></pre>
</div>
</div>
<div class="paragraph">
<p>This groups all of the salaries by city and extracts the result of aggregates with the total salary greater than 1,000 dollars. In
ArcadeDB the <code>HAVING</code> conditions go in a select statement in the predicate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT FROM ( SELECT city, SUM(salary) AS salary FROM Employee GROUP BY city ) WHERE salary &gt; 1000</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Multiple targets</strong></p>
</div>
<div class="paragraph">
<p>ArcadeDB allows only one type (types are equivalent to tables in this discussion) as opposed to SQL, which allows for many tables
as the target. If you want to select from 2 types, you have to execute 2 sub queries and join them with the <code>UNIONALL</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM E, V</code></pre>
</div>
</div>
<div class="paragraph">
<p>In ArcadeDB, you can accomplish this with a few variable definitions and by using the <code>expand</code> function to the union:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT EXPAND( $c ) LET $a = ( SELECT FROM E ), $b = ( SELECT FROM V ), $c = UNIONALL( $a, $b )</code></pre>
</div>
</div>
<h3 id="SQL-Projections" class="discrete">Projections</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Projections.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>A projection is a value that is returned by a query statement (SELECT, MATCH).</p>
</div>
<div class="paragraph">
<p>Eg. the following query</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name as firstName, age * 12 as ageInMonths, out("Friend") from Person where surname = 'Smith'</code></pre>
</div>
</div>
<div class="paragraph">
<p>has three projections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name as firstName</code></p>
</li>
<li>
<p><code>age * 12 as ageInMonths</code></p>
</li>
<li>
<p><code>out(&quot;Friend&quot;)</code></p>
</li>
</ul>
</div>
<h5 id="_syntax" class="discrete">Syntax</h5>
<div class="paragraph">
<p><strong>A projection</strong> has the following syntax:</p>
</div>
<div class="paragraph">
<p><code>&lt;expression&gt; [&lt;nestedProjection&gt;] [ AS &lt;alias&gt; ]</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;expression&gt;</code> is an expression (see <a href="#SQL-Syntax">SQL Syntax</a>) that represents the way to calculate the value of the single projection</p>
</li>
<li>
<p><code>&lt;alias&gt;</code> is the Identifier (see <a href="#SQL-Syntax">SQL Syntax</a>) representing the field name used to return the value in the result set</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A projection block has the following syntax:</p>
</div>
<div class="paragraph">
<p><code>[DISTINCT] &lt;projection&gt; [, &lt;projection&gt; ]*</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DISTINCT</code>: removes duplicates from the result-set</p>
</li>
</ul>
</div>
<h5 id="_query_result" class="discrete">Query result</h5>
<div class="paragraph">
<p>By default, a query returns a different result-set based on the projections it has:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>*</code> <strong>alone</strong>: The result set is made of records as they arrive from the target, with the original <code>@rid</code> and <code>@type</code> attributes (if any)</p>
</li>
<li>
<p><code>*</code> <strong>plus other projections</strong>: records of the original target, merged with the other projection values, with <code>@rid</code> and <code>@type</code> of the original record.</p>
</li>
<li>
<p><strong>no projections</strong>: same behavior as <code>*</code></p>
</li>
<li>
<p><code>expand(&lt;projection&gt;)</code>: The result set is made of the records returned by the projection, expanded (if the projection result is a link or a collection of links) and unwinded (if the projection result is a collection). Nothing in all the other cases.</p>
</li>
<li>
<p><strong>one or more projections</strong>: temporary records (with temporary <code>@rid</code> and no <code>@type</code>). Projections that represent links are returned as simple @rid values, unless differently specified in the fetch plan.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
projection values can be overwritten in the final result, the overwrite happens from left to right
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT 1 as a, 2 as a</code></pre>
</div>
</div>
<div class="paragraph">
<p>will return <code>[{&quot;a&quot;:2}]</code></p>
</div>
<div class="paragraph">
<p>eg.</p>
</div>
<div class="paragraph">
<p>Having the record <code>{&quot;@type&quot;:&quot;Foo&quot;, &quot;name&quot;:&quot;bar&quot;, &quot;@rid&quot;:&quot;#12:0&quot;}</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT *, "hey" as name from Foo</code></pre>
</div>
</div>
<div class="paragraph">
<p>will return <code>[{&quot;@type&quot;:&quot;Foo&quot;, &quot;@rid&quot;:&quot;#12:0&quot;, &quot;name&quot;:&quot;hey&quot;}]</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT  "hey" as name, * from Foo</code></pre>
</div>
</div>
<div class="paragraph">
<p>will return <code>[{&quot;@type&quot;:&quot;Foo&quot;, &quot;@rid&quot;:&quot;#12:0&quot;, &quot;name&quot;:&quot;bar&quot;}]</code></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
when saving back a record with a valid rid, you will overwrite the existing record! So pay attention
when using <code>*</code> together with other projections.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
the result of the query can be further unwound using the <a href="#SQL-Select-Unwind"><code>UNWIND</code></a> operator.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<code>expand()</code> cannot be used together with <code>GROUP BY</code>.
</td>
</tr>
</table>
</div>
<h5 id="_aliases" class="discrete">Aliases</h5>
<div class="paragraph">
<p>The alias is the field name that a projection will have in the result-set.</p>
</div>
<div class="paragraph">
<p>An alias can be implicit, if declared with the <code>AS</code> keyword, eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name + " " + surname as full_name from Person

result:
[{"full_name":"John Smith"}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>An alias can be implicit, when no <code>AS</code> is defined, eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name from Person

result:
[{"name":"John"}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>An implicit alias is calculated based on how the projection is written. By default, ArcadeDB uses the plain String representation of the projection as alias.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SELECT 1+2 as sum

result:
[{"sum": 3}]</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>SELECT parent.name+" "+parent.surname as full_name from Node

result:
[{"full_name": "John Smith"}]</pre>
</div>
</div>
<div class="paragraph">
<p>The String representation of a projection is the exact representation of the projection string, without spaces before and after dots and brackets, no spaces before commands, a single space before and after operators.</p>
</div>
<div class="paragraph">
<p>eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SELECT 1+2

result:
[{"1 + 2": 3}] /* see the space before and after the + sign */</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>SELECT parent.name+" "+parent.surname from Node

result:
[{"parent.name + \" \" + parent.nurname": "John Smith"}]</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>SELECT items[4] from Node

result:
[{"items[4]": "John Smith"}]</pre>
</div>
</div>
<h5 id="_nested_projections" class="discrete">Nested projections</h5>
<div class="paragraph">
<p><strong>Syntax</strong>:</p>
</div>
<div class="paragraph">
<p><code>&quot;:{&quot; ( * | ([&quot;!&quot;] &lt;identifier&gt; [&quot;*&quot;] (&lt;comma&gt; [&quot;!&quot;] &lt;identifier&gt; [&quot;*&quot;])* ) ) &quot;}&quot;</code></p>
</div>
<div class="paragraph">
<p>A projection can refer to a link or to a collection of links, eg. a LIST or MAP.
In some cases you can be interested in the expanded object instead of the RID.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s clarify this with an example. This is our dataset:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">@rid</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">surname</th>
<th class="tableblock halign-left valign-top">parent</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#12:0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fooz</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#12:1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">barz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#12:0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#12:2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">baz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bazz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#12:1</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Given this query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT name, parent FROM TheType WHERE name = 'baz'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "baz",
   "parent": #12:1
}</pre>
</div>
</div>
<div class="paragraph">
<p>Now suppose you want to expand the link and retrieve some properties of the linked object.
You can do it explicitly do it with other projections:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT name, parent.name FROM TheType WHERE name = 'baz'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "baz",
   "parent.name": "bar"
}</pre>
</div>
</div>
<div class="paragraph">
<p>but this will force you to list them one by one, and it&#8217;s not always possible, especially when you don&#8217;t know all their names.</p>
</div>
<div class="paragraph">
<p>Another alternative is to use nested projections, eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT name, parent:{name} FROM TheType WHERE name = 'baz'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "baz",
   "parent": {
      "name": "bar"
   }
}</pre>
</div>
</div>
<div class="paragraph">
<p>or with multiple attributes</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT name, parent:{name, surname} FROM TheType WHERE name = 'baz'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "baz",
   "parent": {
      "name": "bar"
      "surname": "barz"
   }
}</pre>
</div>
</div>
<div class="paragraph">
<p>or using a wildcard</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT name, parent:{*} FROM TheType WHERE name = 'baz'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "baz",
   "parent": {
      "name": "bar"
      "surname": "barz"
      "parent": #12:0
   }
}</pre>
</div>
</div>
<div class="paragraph">
<p>You can also use the <code>!</code> exclude syntax to define which attributes you want to <em>exclude</em> from the nested projection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT name, parent:{!surname} FROM TheType WHERE name = 'baz'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "baz",
   "parent": {
      "name": "bar"
      "parent": #12:0
   }
}</pre>
</div>
</div>
<div class="paragraph">
<p>You can also use a wildcard on the right of property names, to specify the inclusion of attributes that start with a prefix, eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT name, parent:{surna*} FROM TheType WHERE name = 'baz'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "baz",
   "parent": {
      "surname": "barz"
   }
}</pre>
</div>
</div>
<div class="paragraph">
<p>or their exclusion</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT name, parent:{!surna*} FROM TheType WHERE name = 'baz'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "baz",
   "parent": {
      "name": "bar",
      "parent": #12:0
   }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Nested projection syntax allows for multiple level depth expressions, eg. you can go three levels deep as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SELECT name, parent:{name, surname, parent:{name, surname}} FROM TheType WHERE name = 'baz'</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "baz",
   "parent": {
      "name": "bar"
      "surname": "barz"
      "parent": {
         "name": "foo"
         "surname": "fooz"
      }
   }
}</pre>
</div>
</div>
<div class="paragraph">
<p>You can also use expressions and aliases in nested projections:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SELECT name, parent.parent:{name, surname} as grandparent FROM TheType WHERE name = 'baz'</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "baz",
   "grandparent": {
      "name": "foo"
      "surname": "fooz"
   }
}</pre>
</div>
</div>
<div class="sect2">
<h3 id="SQL-Functions">8.1. Functions</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Functions.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>SQL Functions are all the functions bundled with ArcadeDB SQL engine. Look also to <a href="#SQL-Methods">SQL Methods</a>.</p>
</div>
<div class="paragraph">
<p>SQL Functions can work in 2 ways based on the fact that they can receive one or more parameters:</p>
</div>
<h4 id="_aggregated_mode" class="discrete">Aggregated mode</h4>
<div class="paragraph">
<p>When only one parameter is passed, the function aggregates the result in only one record.
The classic example is the <code>sum()</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT SUM(salary) FROM employee</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will always return one record: the sum of salary fields across every employee record.</p>
</div>
<h4 id="_inline_mode" class="discrete">Inline mode</h4>
<div class="paragraph">
<p>When two or more parameters are passed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT SUM(salary, extra, benefits) AS total FROM employee</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will return the sum of the field "salary", "extra" and "benefits" as "total".</p>
</div>
<div class="paragraph">
<p>In case you need to use a function inline, when you only have one parameter, then add "null" as the second parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT first( out('friends').name, null ) AS firstFriend FROM Profiles</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the <code>first()</code> function doesn&#8217;t aggregate everything in only one record, but rather returns one record per <code>Profile</code>, where the <code>firstFriend</code> is the first item of the collection received as the parameter.</p>
</div>
<h4 id="_function_reference" class="discrete">Function Reference</h4>
<h5 id="_out" class="discrete">out()</h5>
<div class="paragraph">
<p>Get the adjacent outgoing vertices starting from the current record as vertex.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>out([&lt;label-1&gt;][,&lt;label-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get all the outgoing vertices from all the "Vehicle" vertices:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT out() FROM Vehicle</code></pre>
</div>
</div>
<div class="paragraph">
<p>Get all the incoming vertices connected with edges with label (class) "Eats" and "Favorited" from all the "Restaurant" vertices in "Rome":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT out('Eats','Favorited') FROM Restaurant WHERE city = 'Rome'</code></pre>
</div>
</div>
<hr>
<h5 id="_in" class="discrete">in()</h5>
<div class="paragraph">
<p>Get the adjacent incoming vertices starting from the current record as vertex.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>in([&lt;label-1&gt;][,&lt;label-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get all the incoming vertices from all the "Vehicle" vertices:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT in() FROM Vehicle</code></pre>
</div>
</div>
<div class="paragraph">
<p>Get all the incoming vertices connected with edges with label (class) "Trucks" and "Cars":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT in('Trucks','Cars') FROM Vehicle</code></pre>
</div>
</div>
<hr>
<h5 id="_both" class="discrete">both()</h5>
<div class="paragraph">
<p>Get the adjacent outgoing and incoming vertices starting from the current record as vertex.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>both([&lt;label1&gt;][,&lt;label-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get all the incoming and outgoing vertices from vertex with RID <code>#13:33</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT both() FROM #13:33</code></pre>
</div>
</div>
<div class="paragraph">
<p>Get all the incoming and outgoing "Vehicle" vertices connected by edges with label (class) "Trucks" and "Cars":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT both('Trucks','Cars') FROM Vehicle</code></pre>
</div>
</div>
<hr>
<h5 id="_oute" class="discrete">outE()</h5>
<div class="paragraph">
<p>Get the adjacent outgoing edges starting from the current record as vertex.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>outE([&lt;label1&gt;][,&lt;label-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get all the outgoing edges from all the "Vehicle" vertices:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT outE() FROM Vehicle</code></pre>
</div>
</div>
<div class="paragraph">
<p>Get all the outgoing edges of type "Eats" from all the "SocialNetworkProfile" vertices:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT outE('Eats') FROM SocialNetworkProfile</code></pre>
</div>
</div>
<hr>
<h5 id="_ine" class="discrete">inE()</h5>
<div class="paragraph">
<p>Get the adjacent incoming edges starting from the current record as Vertex.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>inE([&lt;label1&gt;][,&lt;label-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get all the incoming edges from all the "Vehicle" vertices:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT inE() FROM Vehicle</code></pre>
</div>
</div>
<div class="paragraph">
<p>Get all the incoming edges of type "Eats" from the "Restaurant" "Bella Napoli":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT inE('Eats') FROM Restaurant WHERE name = 'Bella Napoli'</code></pre>
</div>
</div>
<hr>
<h5 id="_bothe" class="discrete">bothE()</h5>
<div class="paragraph">
<p>Get the adjacent outgoing and incoming edges starting from the current record as vertex.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>bothE([&lt;label1&gt;][,&lt;label-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get both incoming and outgoing edges from all the "Vehicle" vertices:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT bothE() FROM Vehicle</code></pre>
</div>
</div>
<div class="paragraph">
<p>Get all the incoming and outgoing edges of type "Friend" from the profiles with "nickname" "Jay"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT bothE('Friend') FROM Profile WHERE nickname = 'Jay'</code></pre>
</div>
</div>
<hr>
<h5 id="_bothv" class="discrete">bothV()</h5>
<div class="paragraph">
<p>Get the adjacent outgoing and incoming vertices starting from the current record as edge.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>bothV()</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get both incoming and outgoing vertices from the "Friend" edges:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT bothV() FROM Friend</code></pre>
</div>
</div>
<hr>
<h5 id="_outv" class="discrete">outV()</h5>
<div class="paragraph">
<p>Get outgoing vertices starting from the current record as edge.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>outV()</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get outgoing vertices from the "Friend" edges</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT outV() FROM Friend</code></pre>
</div>
</div>
<hr>
<h5 id="_inv" class="discrete">inV()</h5>
<div class="paragraph">
<p>Get incoming vertices starting from the current record as edge.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>inV()</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get incoming vertices from the "Friend" edges</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT inV() FROM Friend</code></pre>
</div>
</div>
<hr>
<h5 id="_coalesce" class="discrete">coalesce()</h5>
<div class="paragraph">
<p>Returns the first field/value argument not being null parameter.
If no field/value is not null, null is returns.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>coalesce(&lt;field|value&gt; [, &lt;field-n|value-n&gt;]*)</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT coalesce(amount, amount2, amount3) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_if" class="discrete">if()</h5>
<div class="paragraph">
<p>Syntax: <code>if(&lt;expression&gt;, &lt;result-if-true&gt;, &lt;result-if-false&gt;)</code></p>
</div>
<div class="paragraph">
<p>Evaluates a condition (first parameters) and returns the second parameter if the condition is true, and the third parameter otherwise.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT if( (name = 'John'), "My name is John", "My name is not John") FROM Person</code></pre>
</div>
</div>
<hr>
<h5 id="_ifnull" class="discrete">ifnull()</h5>
<div class="paragraph">
<p>Returns the passed field/value, or optional parameter <em>return_value_if_not_null</em>.
If field/value is null, <em>return_value_if_null</em> is returned.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>ifnull( &lt;field/value&gt;, &lt;return_value_if_null&gt;[,&lt;return_value_if_not_null&gt;])</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT ifnull(salary, 0) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_expand" class="discrete">expand()</h5>
<div class="paragraph">
<p>This function has two meanings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When used on a collection field, it unwinds the collection in the field &lt;field&gt; and use it as result.</p>
</li>
<li>
<p>When used on a link (RID) field, it expands the document pointed by that link.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Syntax: <code>expand(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p>You can also use the SQL operator <a href="#SQL-Select-Unwind"><code>UNWIND</code></a> in select to obtain the same result.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As <code>expand()</code> may change its return type based on the argument,
      no modifiers (method calls, suffix identifiers or array indexing) are permitted on the return value of <code>expand()</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>on collections:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT EXPAND( addresses ) FROM Account</code></pre>
</div>
</div>
<div class="paragraph">
<p>on RIDs</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT EXPAND( addresses ) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_first" class="discrete">first()</h5>
<div class="paragraph">
<p>Retrieves only the first item of multi-value fields (arrays, collections and maps).
For non multi-value types just returns the value.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>first(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">select first( addresses ) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_last" class="discrete">last()</h5>
<div class="paragraph">
<p>Retrieves only the last item of multi-value fields (arrays, collections and maps).
For non multi-value types just returns the value.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>last(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT last( addresses ) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_count" class="discrete">count()</h5>
<div class="paragraph">
<p>Counts the records that match the query condition.
If * is used as field, then all record will be counted, otherwise only records with field content that is not null.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>count(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT COUNT(*) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_min" class="discrete">min()</h5>
<div class="paragraph">
<p>Returns the minimum value.
If invoked with more than one parameter, the function doesn&#8217;t aggregate but returns the minimum value between all the arguments.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>min(&lt;field&gt; [, &lt;field-n&gt;]* )</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Returns the minimum salary of all the "Account" records:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT min(salary) FROM Account</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns the minimum value between "salary1", "salary2" and "salary3" fields.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT min(salary1, salary2, salary3) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_max" class="discrete">max()</h5>
<div class="paragraph">
<p>Returns the maximum value.
If invoked with more than one parameter, the function doesn&#8217;t aggregate, but returns the maximum value between all the arguments.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>max(&lt;field&gt; [, &lt;field-n&gt;]* )</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Returns the maximum salary of all the "Account" records:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT max(salary) FROM Account.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns the maximum value between "salary1", "salary2" and "salary3" fields.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT max(salary1, salary2, salary3) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_avg" class="discrete">avg()</h5>
<div class="paragraph">
<p>Returns the average value.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>avg(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT avg(salary) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_sum" class="discrete">sum()</h5>
<div class="paragraph">
<p>Syntax: <code>sum(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p>Returns the sum of all the values returned.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT sum(salary) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_abs" class="discrete">abs()</h5>
<div class="paragraph">
<p>Returns the absolute value.
It works with Integer, Long, Short, Double, Float, BigInteger, BigDecimal, and null.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>abs(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT abs(score) FROM Account
SELECT abs(-2332) FROM Account
SELECT abs(999) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_sqrt" class="discrete">sqrt()</h5>
<div class="paragraph">
<p>Returns the absolute value.
It works with Integer, Long, Short, Double, Float, BigInteger, BigDecimal, and null.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Integer arguments are rounded down and negative arguments result in null.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Syntax: <code>sqrt(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT sqrt(score) FROM Account
SELECT sqrt(2.0)
SELECT sqrt(63)</code></pre>
</div>
</div>
<hr>
<h5 id="_date" class="discrete">date()</h5>
<div class="paragraph">
<p>Returns a date formatting a string.
&lt;date-as-string&gt; is the date in string format, and &lt;format&gt; is the date format following these <a href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">rules</a>.
If no format is specified, then the default database format is used.
To know more about it, look at <a href="#Managing-Dates">Managing Dates</a>.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>date( &lt;date-as-string&gt; [&lt;format&gt;] [,&lt;timezone&gt;] )</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Account WHERE created &lt;= date('2012-07-02', 'yyyy-MM-dd')</code></pre>
</div>
</div>
<hr>
<h5 id="_sysdate" class="discrete">sysdate()</h5>
<div class="paragraph">
<p>Returns the current date time.
If executed with no parameters, it returns a Date object, otherwise a string with the requested format/timezone.
To know more about it, look at <a href="#Managing-Dates">Managing Dates</a>.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>sysdate( [&lt;format&gt;] [,&lt;timezone&gt;] )</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT sysdate('dd-MM-yyyy') FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_format" class="discrete">format()</h5>
<div class="paragraph">
<p>Formats a value using the <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/String.html">String.format()</a> conventions.
Look <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html#syntax">here for more information</a>.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>format( &lt;format&gt; [,&lt;arg1&gt; ] [,&lt;arg-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT format("%d - Mr. %s %s (%s)", id, name, surname, address) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_decimal" class="discrete">decimal()</h5>
<div class="paragraph">
<p>Converts a number or a String in an absolute precision, decimal number.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>decimal( &lt;number&gt; | &lt;string&gt; )</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT decimal('99.999999999999999999') FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_astar" class="discrete">astar()</h5>
<div class="paragraph">
<p>The <a href="https://en.wikipedia.org/wiki/A*_search_algorithm">A* algorithm</a> describes how to find the cheapest path from one node to another node in a directed weighted graph with a heuristic function.</p>
</div>
<div class="paragraph">
<p>The first parameter is source record.
The second parameter is destination record.
The third parameter is a name of property that represents weight and fourth represents the map of options.</p>
</div>
<div class="paragraph">
<p>If property is not defined in edge or is null, distance between vertexes are 0.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>astar(&lt;sourceVertex&gt;, &lt;destinationVertex&gt;, &lt;weightEdgeFieldName&gt;, [&lt;options&gt;])</code></p>
</div>
<div class="paragraph">
<p>options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  direction:"OUT", //the edge direction (OUT, IN, BOTH)
  edgeTypeNames:[],
  vertexAxisNames:[],
  parallel : false,
  tieBreaker:true,
  maxDepth:99999,
  dFactor:1.0,
  customHeuristicFormula:'custom_Function_Name_here'  // (MANHATAN, MAXAXIS, DIAGONAL, EUCLIDEAN, EUCLIDEANNOSQR, CUSTOM)
}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT astar($current, #8:10, 'weight') FROM Vehicle</code></pre>
</div>
</div>
<hr>
<h5 id="_dijkstra" class="discrete">dijkstra()</h5>
<div class="paragraph">
<p>Returns the cheapest path between two vertices using the <a href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm">Dijkstra&#8217;s algorithm</a> where the <strong>weightEdgeFieldName</strong> parameter is the field containing the weight.
Direction can be OUT (default), IN or BOTH.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>dijkstra(&lt;sourceVertex&gt;, &lt;destinationVertex&gt;, &lt;weightEdgeFieldName&gt; [, &lt;direction&gt;])</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT dijkstra($current, #8:10, 'weight') FROM Vehicle</code></pre>
</div>
</div>
<hr>
<h5 id="_shortestpath" class="discrete">shortestPath()</h5>
<div class="paragraph">
<p>Returns the shortest path between two vertices.
Direction can be OUT (default), IN or BOTH.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>shortestPath( &lt;sourceVertex&gt;, &lt;destinationVertex&gt; [, &lt;direction&gt; [, &lt;edgeClassName&gt; [, &lt;additionalParams&gt;]]])</code></p>
</div>
<div class="paragraph">
<p>Where:
- <code>sourceVertex</code> is the source vertex where to start the path
- <code>destinationVertex</code> is the destination vertex where the path ends
- <code>direction</code>, optional, is the direction of traversing. By default is "BOTH" (in+out). Supported values are "BOTH" (incoming and outgoing), "OUT" (outgoing) and "IN" (incoming)
- <code>edgeClassName</code>, optional, is the edge class to traverse. By default all edges are crossed. This can also be a list of edge class names (eg. <code>[&quot;edgeType1&quot;, &quot;edgeType2&quot;]</code>)
- <code>additionalParams</code>, optional, here you can pass a map of additional parametes (Map&lt;String, Object&gt; in Java, JSON from SQL). Currently allowed parameters are
 - 'maxDepth': integer, maximum depth for paths (ignore path longer that 'maxDepth')</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>on finding the shortest path between vertices <code>#8:32</code> and <code>#8:10</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT shortestPath(#8:32, #8:10)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>on finding the shortest path between vertices <code>#8:32</code> and <code>#8:10</code> only crossing outgoing edges</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT shortestPath(#8:32, #8:10, 'OUT')</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>on finding the shortest path between vertices `#8:32<code> and `#8:10</code> only crossing incoming edges of type "Friend"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT shortestPath(#8:32, #8:10, 'IN', 'Friend')</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>on finding the shortest path between vertices `#8:32<code> and `#8:10</code> only crossing incoming edges of type "Friend" or "Colleague"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT shortestPath(#8:32, #8:10, 'IN', ['Friend', 'Colleague'])</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>on finding the shortest path between vertices <code>#8:32</code> and <code>#8:10</code>, long at most five hops</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT shortestPath(#8:32, #8:10, null, null, {"maxDepth": 5})</code></pre>
</div>
</div>
<hr>
<h5 id="_distance" class="discrete">distance()</h5>
<div class="paragraph">
<p>Syntax: <code>distance( &lt;x-field&gt;, &lt;y-field&gt;, &lt;x-value&gt;, &lt;y-value&gt; )</code></p>
</div>
<div class="paragraph">
<p>Returns the distance between two points in the globe using the <a href="https://en.wikipedia.org/wiki/Haversine_formula">Haversine algorithm</a>.
Coordinates must be in degrees.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM POI WHERE distance(x, y, 52.20472, 0.14056 ) &lt;= 30</code></pre>
</div>
</div>
<hr>
<h5 id="_distinct" class="discrete">distinct()</h5>
<div class="paragraph">
<p>Syntax: <code>distinct(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p>Retrieves only unique data entries depending on the field you have specified as argument.
The main difference compared to standard SQL DISTINCT is that with ArcadeDB, a function with parenthesis and only one field can be specified.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT distinct(name) FROM City</code></pre>
</div>
</div>
<hr>
<h5 id="_unionall" class="discrete">unionall()</h5>
<div class="paragraph">
<p>Syntax: <code>unionall(&lt;field&gt; [,&lt;field-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p>Works as aggregate or inline.
If only one argument is passed then aggregates, otherwise executes and returns a UNION of all the collections received as parameters.
Also works with no collection values.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT unionall(friends) FROM profile</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT unionall(inEdges, outEdges) FROM OGraphVertex WHERE label = 'test'</code></pre>
</div>
</div>
<hr>
<h5 id="_intersect" class="discrete">intersect()</h5>
<div class="paragraph">
<p>Syntax: <code>intersect(&lt;field&gt; [,&lt;field-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p>Works as aggregate or inline.
If only one argument is passed then it aggregates, otherwise executes and returns the INTERSECTION of the collections received as parameters.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT intersect(friends) FROM profile WHERE jobTitle = 'programmer'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT intersect(inEdges, outEdges) FROM OGraphVertex</code></pre>
</div>
</div>
<hr>
<h5 id="_difference" class="discrete">difference()</h5>
<div class="paragraph">
<p>Syntax: <code>difference(&lt;field&gt; [,&lt;field-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p>Works as aggregate or inline.
If only one argument is passed then it aggregates, otherwise it executes and returns the DIFFERENCE between the collections received as parameters.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT difference(tags) FROM book</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT difference(inEdges, outEdges) FROM OGraphVertex</code></pre>
</div>
</div>
<hr>
<h5 id="symmetricDifference" class="discrete">symmetricDifference()</h5>
<div class="paragraph">
<p>Syntax: <code>symmetricDifference(&lt;field&gt; [,&lt;field-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p>Works as aggregate or inline.
If only one argument is passed then it aggregates, otherwise executes and returns the SYMMETRIC DIFFERENCE between the collections received as parameters.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT symmetricDifference(tags) FROM book</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT symmetricDifference(inEdges, outEdges) FROM OGraphVertex</code></pre>
</div>
</div>
<hr>
<h5 id="_set" class="discrete">set()</h5>
<div class="paragraph">
<p>Creates or adds a value to a set.
If <code>&lt;value&gt;</code> is a collection, then it is merged with the set, otherwise <code>&lt;field|value&gt;</code> is added to the set.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>set(&lt;field|value&gt;[,]*)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name, set(roles.name) AS roles FROM OUser</code></pre>
</div>
</div>
<hr>
<h5 id="_point" class="discrete">point()</h5>
<div class="paragraph">
<p>Creates a 2D point from two numbers specifying X- and Y-coordinate.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>point(&lt;x&gt;,&lt;y&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT point(10,20) AS point</code></pre>
</div>
</div>
<hr>
<h5 id="_circle" class="discrete">circle()</h5>
<div class="paragraph">
<p>Creates a 2D circle from two numbers specifying X- and Y-coordinate of circle&#8217;s center and a number describing the circle&#8217;s radius.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>circle(&lt;center-x&gt;,&lt;center-y&gt;,&lt;radius&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT circle(10,10,10) AS circle</code></pre>
</div>
</div>
<hr>
<h5 id="_rectangle" class="discrete">rectangle()</h5>
<div class="paragraph">
<p>Creates a 2D rectangle from four numbers specifying the left boundary X-, top boundary Y-, right boundary X- and botton boundary Y-values.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>rectangle(&lt;left-x&gt;,&lt;top-y&gt;,&lt;right-x&gt;,&lt;bottom-y&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT rectangle(10,10,20,20) AS rectangle</code></pre>
</div>
</div>
<hr>
<h5 id="_linestring" class="discrete">lineString()</h5>
<div class="paragraph">
<p>Creates a chain of 2D lines from a list of points.
A string of lines is not necessarily closed.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>lineString([&lt;point&gt;*])</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT lineString( [ point(10,10), point(20,10), point(20,20), point(10,20), point(30,30) ] ) AS linesString</code></pre>
</div>
</div>
<hr>
<h5 id="_polygon" class="discrete">polygon()</h5>
<div class="paragraph">
<p>Creates a 2D polygon from a list of points.
The lines making up a polygon are closed.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>polygon([&lt;point&gt;*])</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT polygon( [ point(10,10), point(20,10), point(20,20), point(10,20), point(10,10) ] ) AS polygon</code></pre>
</div>
</div>
<hr>
<h5 id="_list" class="discrete">list()</h5>
<div class="paragraph">
<p>Creates or adds a value to a list.
If <code>&lt;field|value&gt;</code> is a collection, then is merged with the list, otherwise <code>&lt;field|value&gt;</code> is added to the list.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>list(&lt;field|value&gt;[,]*)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name, list(roles.name) AS roles FROM OUser</code></pre>
</div>
</div>
<hr>
<h5 id="_map" class="discrete">map()</h5>
<div class="paragraph">
<p>Creates a map.
The arguments have to be pairs of keys and values, hence the number of arguments has to be even.
The <code>&lt;key&gt;</code> argument(s) have to be strings.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>map(&lt;key&gt;,&lt;value&gt;[,]*)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT map(name, roles.name) FROM OUser</code></pre>
</div>
</div>
<hr>
<h5 id="_traversedelement" class="discrete">traversedElement()</h5>
<div class="paragraph">
<p>Returns the traversed element(s) in Traverse commands.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>traversedElement(&lt;index&gt; [,&lt;items&gt;])</code></p>
</div>
<div class="paragraph">
<p>Where:
- <code>&lt;index&gt;</code> is the starting item to retrieve. Value &#x2265; 0 means absolute position in the traversed stack. 0 means the first record. Negative values are counted from the end: -1 means last one, -2 means the record before last one, etc.
- <code>&lt;items&gt;</code>, optional, by default is 1. If &gt;1 a collection of items is returned</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Returns last traversed item of TRAVERSE command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT traversedElement(-1) FROM ( TRAVERSE out() FROM #34:3232 WHILE $depth &lt;= 10 )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns last 3 traversed items of TRAVERSE command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT traversedElement(-1, 3) FROM ( TRAVERSE out() FROM #34:3232 WHILE $depth &lt;= 10 )</code></pre>
</div>
</div>
<hr>
<h5 id="_traversededge" class="discrete">traversedEdge()</h5>
<div class="paragraph">
<p>Returns the traversed edge(s) in Traverse commands.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>traversedEdge(&lt;index&gt; [,&lt;items&gt;])</code></p>
</div>
<div class="paragraph">
<p>Where:
- <code>&lt;index&gt;</code> is the starting edge to retrieve. Value &#x2265; 0 means absolute position in the traversed stack. 0 means the first record. Negative values are counted from the end: -1 means last one, -2 means the edge before last one, etc.
- <code>&lt;items&gt;</code>, optional, by default is 1. If &gt;1 a collection of edges is returned</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Returns last traversed edge(s) of TRAVERSE command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT traversedEdge(-1) FROM ( TRAVERSE outE(), inV() FROM #34:3232 WHILE $depth &lt;= 10 )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns last 3 traversed edge(s) of TRAVERSE command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT traversedEdge(-1, 3) FROM ( TRAVERSE outE(), inV() FROM #34:3232 WHILE $depth &lt;= 10 )</code></pre>
</div>
</div>
<hr>
<h5 id="_traversedvertex" class="discrete">traversedVertex()</h5>
<div class="paragraph">
<p>Returns the traversed vertex(es) in Traverse commands.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>traversedVertex(&lt;index&gt; [,&lt;items&gt;])</code></p>
</div>
<div class="paragraph">
<p>Where:
- <code>&lt;index&gt;</code> is the starting vertex to retrieve. Value &gt;= 0 means absolute position in the traversed stack. 0 means the first vertex. Negative values are counted from the end: -1 means last one, -2 means the vertex before last one, etc.
- <code>&lt;items&gt;</code>, optional, by default is 1. If &gt;1 a collection of vertices is returned</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Returns last traversed vertex of TRAVERSE command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT traversedVertex(-1) FROM ( TRAVERSE out() FROM #34:3232 WHILE $depth &lt;= 10 )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns last 3 traversed vertices of TRAVERSE command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT traversedVertex(-1, 3) FROM ( TRAVERSE out() FROM #34:3232 WHILE $depth &lt;= 10 )</code></pre>
</div>
</div>
<hr>
<h5 id="_mode" class="discrete">mode()</h5>
<div class="paragraph">
<p>Returns the values that occur with the greatest frequency.
Nulls are ignored in the calculation.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>mode(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT mode(salary) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_median" class="discrete">median()</h5>
<div class="paragraph">
<p>Returns the middle value or an interpolated value that represent the middle value after the values are sorted.
Nulls are ignored in the calculation.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>median(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT median(salary) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_percentile" class="discrete">percentile()</h5>
<div class="paragraph">
<p>Returns the nth percentiles (the values that cut off the first n percent of the field values when it is sorted in ascending order).
Nulls are ignored in the calculation.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>percentile(&lt;field&gt; [, &lt;quantile-n&gt;]*)</code></p>
</div>
<div class="paragraph">
<p>The quantiles have to be in the range 0&#8212;&#8203;1</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT percentile(salary, 0.95) FROM Account
SELECT percentile(salary, 0.25, 0.75) AS IQR FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_variance" class="discrete">variance()</h5>
<div class="paragraph">
<p>Returns the middle variance: the average of the squared differences from the mean.
Nulls are ignored in the calculation.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>variance(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT variance(salary) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_stddev" class="discrete">stddev()</h5>
<div class="paragraph">
<p>Returns the standard deviation: the measure of how spread out values are.
Nulls are ignored in the calculation.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>stddev(&lt;field&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT stddev(salary) FROM Account</code></pre>
</div>
</div>
<hr>
<h5 id="_uuid" class="discrete">uuid()</h5>
<div class="paragraph">
<p>Generates a UUID as a 128-bits value using the Leach-Salz variant.
For more information look at: <a href="http://docs.oracle.com/javase/6/docs/api/java/util/UUID.html" class="bare">http://docs.oracle.com/javase/6/docs/api/java/util/UUID.html</a>.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>uuid()</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Insert a new record with an automatic generated id:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">INSERT INTO Account SET id = UUID()</code></pre>
</div>
</div>
<hr>
<h5 id="_strcmpci" class="discrete">strcmpci()</h5>
<div class="paragraph">
<p>Compares two string ignoring case.
Return value is -1 if first string ignoring case is less than second, 0 if strings ignoring case are equals, 1 if second string ignoring case is less than first one.
Before comparison both strings are transformed to lowercase and then compared.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>strcmpci(&lt;first_string&gt;, &lt;second_string&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Select all records where state name ignoring case is equal to "washington"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT * FROM State WHERE strcmpci('washington', name) = 0</code></pre>
</div>
</div>
<hr>
<h5 id="_encode" class="discrete">encode()</h5>
<div class="paragraph">
<p>Encode binary data into the specified format (base64 is the only supported).
The <code>&lt;binaryfields&gt;</code> must be a property containing binary data.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>encode(&lt;binaryfield&gt;,&lt;format&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Encode binary data into base64.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT encode(raw, 'base64') FROM Blob</code></pre>
</div>
</div>
<hr>
<h5 id="_decode" class="discrete">decode()</h5>
<div class="paragraph">
<p>Decode a value into binary data (base64 is the only supported).
The <code>&lt;value&gt;</code> must contain base64 encoded information.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>decode(&lt;value&gt;,&lt;format&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Decode a value into binary format from base64.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT decode('LDLM322DDMki33kDK=', 'base64')</code></pre>
</div>
</div>
<hr>
<h4 id="_custom_functions" class="discrete">Custom functions</h4>
<div class="paragraph">
<p>The SQL engine can be extended with custom functions written with a scripting language or via Java.</p>
</div>
<h5 id="_databases_function" class="discrete">Database&#8217;s function</h5>
<div class="paragraph">
<p>Look at the <a href="#Database">Database Interface</a> page.</p>
</div>
<h5 id="_custom_functions_in_java" class="discrete">Custom functions in Java</h5>
<div class="paragraph">
<p>Before to use them in your queries you need to register:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// REGISTER 'BIGGER' FUNCTION WITH FIXED 2 PARAMETERS (MIN/MAX=2)
SQLEngine.getInstance().registerFunction("bigger",
                                          new SQLFunctionAbstract("bigger", 2, 2) {
  public String getSyntax() {
    return "bigger(&lt;first&gt;, &lt;second&gt;)";
  }

  public Object execute(Object[] iParameters) {
    if (iParameters[0] == null || iParameters[1] == null)
      // CHECK BOTH EXPECTED PARAMETERS
      return null;

    if (!(iParameters[0] instanceof Number) || !(iParameters[1] instanceof Number))
      // EXCLUDE IT FROM THE RESULT SET
      return null;

    // USE DOUBLE TO AVOID LOSS OF PRECISION
    final double v1 = ((Number) iParameters[0]).doubleValue();
    final double v2 = ((Number) iParameters[1]).doubleValue();

    return Math.max(v1, v2);
  }

  public boolean aggregateResults() {
    return false;
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can execute it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Resultset result = database.command("sql", "SELECT FROM Account WHERE bigger( salary, 10 ) &gt; 10");</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="SQL-Methods">8.2. Methods</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Methods.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>SQL Methods are similar to <a href="#SQL-Functions">SQL Functions</a> but they apply to values.
In Object-Oriented paradigm they are called "methods", as functions related to a type.
So what&#8217;s the difference between a function and a method?</p>
</div>
<div class="paragraph">
<p>This is a <a href="#SQL-Functions">SQL Function</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM sum( salary ) FROM employee</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a SQL method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM salary.toJSON() FROM employee</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see the method is executed against a field/value.
Methods can receive parameters, like functions.
You can concatenate N operators in sequence.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
methods are case-insensitive.
</td>
</tr>
</table>
</div>
<h5 id="Methods-squares" class="discrete">[]</h5>
<div class="paragraph">
<p>Execute an expression against the item.
An item can be a multi-value object like a map, a list, an array or a document.
For documents and maps, the item must be a string.
For lists and arrays, the index is a number.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;[&lt;expression&gt;]</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>document,</p>
</li>
<li>
<p>map,</p>
</li>
<li>
<p>list,</p>
</li>
<li>
<p>array</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get the item with key "phone" in a map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Profile WHERE '+39' IN contacts[phone].left(3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Get the first 10 tags of posts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM tags[0...9] FROM Posts</code></pre>
</div>
</div>
<hr>
<h5 id="_append" class="discrete">append()</h5>
<div class="paragraph">
<p>Appends a string to another one.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.append(&lt;value&gt;)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name.append(' ').append(surname) FROM Employee</code></pre>
</div>
</div>
<hr>
<h5 id="_asboolean" class="discrete">asBoolean()</h5>
<div class="paragraph">
<p>Transforms the field into a Boolean type.
If the origin type is a string, then "true" (or "TRUE", "True", &#8230;&#8203;) means TRUE, all other strings transform to FALSE.
If it is a number type, then 0 means FALSE while all other numbers transform to TRUE.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asBoolean()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string,</p>
</li>
<li>
<p>short,</p>
</li>
<li>
<p>int,</p>
</li>
<li>
<p>long</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Users WHERE online.asBoolean() = true</code></pre>
</div>
</div>
<hr>
<h5 id="_asdate" class="discrete">asDate()</h5>
<div class="paragraph">
<p>Transforms the field into a Date type.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asDate([&lt;format&gt;])</code></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>format</code>, optional, is the format of the date to convert if the value is a string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string,</p>
</li>
<li>
<p>long</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Returns all the records where time is before the year 2010:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Log WHERE time.asDate() &lt; '01-01-2010'</code></pre>
</div>
</div>
<hr>
<h5 id="_asdatetime" class="discrete">asDateTime()</h5>
<div class="paragraph">
<p>Transforms the field into a Date type but parsing also the time information.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asDateTime([&lt;format&gt;])</code></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>format</code>, optional, is the format of the date to convert if the value is a string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string,</p>
</li>
<li>
<p>long</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Time is stored as long type measuring milliseconds since a particular day.
Returns all the records where time is before the year 2010:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Log WHERE time.asDateTime() &lt; '01-01-2010 00:00:00'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example returns the dates stored as strings following the ISO 8601 format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT timeAsString.asDateTime("yyyy-MM-dd'T'HH:mm:ss'Z'") as time FROM Log</code></pre>
</div>
</div>
<hr>
<h5 id="_asdecimal" class="discrete">asDecimal()</h5>
<div class="paragraph">
<p>Transforms the field into an Decimal type.
Use Decimal type when treat currencies.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asDecimal()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT salary.asDecimal() FROM Employee</code></pre>
</div>
</div>
<hr>
<h5 id="_asfloat" class="discrete">asFloat()</h5>
<div class="paragraph">
<p>Transforms the field into a float type.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asFloat()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT ray.asFloat() &gt; 3.14</code></pre>
</div>
</div>
<hr>
<h5 id="_asinteger" class="discrete">asInteger()</h5>
<div class="paragraph">
<p>Transforms the field into an integer type.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asInteger()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Converts the first 3 chars of 'value' field in an integer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT value.left(3).asInteger() FROM Log</code></pre>
</div>
</div>
<hr>
<h5 id="_aslist" class="discrete">asList()</h5>
<div class="paragraph">
<p>Transforms the value in a List.
If it&#8217;s a single item, a new list is created.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asList()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT tags.asList() FROM Friend</code></pre>
</div>
</div>
<hr>
<h5 id="_aslong" class="discrete">asLong()</h5>
<div class="paragraph">
<p>Transforms the field into a Long type.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asLong()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT date.asLong() FROM Log</code></pre>
</div>
</div>
<hr>
<h5 id="_asmap" class="discrete">asMap()</h5>
<div class="paragraph">
<p>Transforms the value in a Map where even items are the keys and odd items are values.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asMap()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>collections</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT tags.asMap() FROM Friend</code></pre>
</div>
</div>
<hr>
<h5 id="_asrid" class="discrete">asRID()</h5>
<div class="paragraph">
<p>Transforms the field into an RID link type.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asRID()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Transform string holding an RID to a link:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT "#1:0".asRID()</code></pre>
</div>
</div>
<hr>
<h5 id="_asset" class="discrete">asSet()</h5>
<div class="paragraph">
<p>Transforms the value in a Set.
If it&#8217;s a single item, a new set is created.
Sets do not allow duplicates.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asSet()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT tags.asSet() FROM Friend</code></pre>
</div>
</div>
<hr>
<h5 id="_asstring" class="discrete">asString()</h5>
<div class="paragraph">
<p>Transforms the field into a string type.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.asString()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get all the salaries with decimals:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT salary.asString().indexof('.') &gt; -1</code></pre>
</div>
</div>
<hr>
<h5 id="_charat" class="discrete">charAt()</h5>
<div class="paragraph">
<p>Returns the character of the string contained in the position 'position'. 'position' starts from 0 to string length.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.charAt(&lt;position&gt;)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get the first character of the users' name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM User WHERE name.charAt( 0 ) = 'L'</code></pre>
</div>
</div>
<hr>
<h5 id="_convert" class="discrete">convert()</h5>
<div class="paragraph">
<p>Convert a value to another type.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.convert(&lt;type&gt;)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT dob.convert( 'date' ) FROM User</code></pre>
</div>
</div>
<hr>
<h5 id="_exclude" class="discrete">exclude()</h5>
<div class="paragraph">
<p>Excludes some properties in the resulting document.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.exclude(&lt;field-name&gt;[,]*)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>document record</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT EXPAND( @this.exclude( 'password' ) ) FROM OUser</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can specify a wildcard as ending character to exclude all the fields that start with a certain string.
Example to exclude all the outgoing and incoming edges:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT EXPAND( @this.exclude( 'out_*', 'in_*' ) ) FROM V</code></pre>
</div>
</div>
<hr>
<h5 id="_format_2" class="discrete">format()</h5>
<div class="paragraph">
<p>Returns the value formatted using the common "printf" syntax.
For the complete reference goto <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/Formatter.html#syntax">Java Formatter JavaDoc</a>.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.format(&lt;format&gt;)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong>
Formats salaries as number with 11 digits filling with 0 at left:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT salary.format("%-011d") FROM Employee</code></pre>
</div>
</div>
<hr>
<h5 id="_hash" class="discrete">hash()</h5>
<div class="paragraph">
<p>Returns the hash of the field.
Supports all the algorithms <a href="https://docs.oracle.com/en/java/javase/11/docs/specs/security/standard-names.html">available in the JVM</a>.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;</code>.hash([&lt;algorithm&gt;])<code>`</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get the SHA-512 of the field "password" in the type User:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT password.hash('SHA-512') FROM User</code></pre>
</div>
</div>
<hr>
<h5 id="_include" class="discrete">include()</h5>
<div class="paragraph">
<p>Include only some properties in the resulting document.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.include(&lt;field-name&gt;[,]*)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>document record</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT EXPAND( @this.include( 'name' ) ) FROM OUser</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can specify a wildcard as ending character to inclide all the fields that start with a certain string.
Example to include all the fields that starts with <code>amonut</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT EXPAND( @this.include( 'amount*' ) ) FROM V</code></pre>
</div>
</div>
<hr>
<h5 id="_indexof" class="discrete">indexOf()</h5>
<div class="paragraph">
<p>Returns the position of the 'string-to-search' inside the value.
It returns -1 if no occurrences are found. 'begin-position' is the optional position where to start, otherwise the beginning of the string is taken (=0).</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.indexOf(&lt;string-to-search&gt; [,&lt;begin-position&gt;])</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Returns all the UK numbers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Contact WHERE phone.indexOf('+44') &gt; -1</code></pre>
</div>
</div>
<hr>
<h5 id="_javatype" class="discrete">javaType()</h5>
<div class="paragraph">
<p>Returns the corresponding Java Type.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.javaType()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Prints the Java type used to store dates:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM date.javaType() FROM Events</code></pre>
</div>
</div>
<hr>
<h5 id="_keys" class="discrete">keys()</h5>
<div class="paragraph">
<p>Returns the map&#8217;s keys as a separate set.
Useful to use in conjunction with IN, CONTAINS and CONTAINSALL operators.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.keys()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>maps</p>
</li>
<li>
<p>documents</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Actor WHERE 'Luke' IN map.keys()</code></pre>
</div>
</div>
<hr>
<h5 id="_left" class="discrete">left()</h5>
<div class="paragraph">
<p>Returns a substring of the original cutting from the begin and getting 'len' characters.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.left(&lt;length&gt;)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Actors WHERE name.left( 4 ) = 'Luke'</code></pre>
</div>
</div>
<hr>
<h5 id="_length" class="discrete">length()</h5>
<div class="paragraph">
<p>Returns the length of the string.
If the string is null 0 will be returned.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.length()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Providers WHERE name.length() &gt; 0</code></pre>
</div>
</div>
<hr>
<h5 id="_normalize" class="discrete">normalize()</h5>
<div class="paragraph">
<p>Unicode normalization form can be NDF, NFD, NFKC, NFKD, the default is NDF.
Pattern-matching, if not defined is the regular expression <code>"\p{InCombiningDiacriticalMarks}+"</code>.
For more information look at <a href="http://www.unicode.org/reports/tr15/tr15-23.html">Unicode Standard</a>.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.normalize( [&lt;form&gt;] [,&lt;pattern-matching&gt;] )</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM V WHERE name.normalize() AND name.normalize('NFD')</code></pre>
</div>
</div>
<hr>
<h5 id="_prefix" class="discrete">prefix()</h5>
<div class="paragraph">
<p>Prefixes a string to another one.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.prefix(&#39;&lt;string&gt;&#39;)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name.prefix('Mr. ') FROM Profile</code></pre>
</div>
</div>
<hr>
<h5 id="_remove" class="discrete">remove()</h5>
<div class="paragraph">
<p>Removes the first occurrence of the passed items.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.remove(&lt;item&gt;*)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>collection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT out().in().remove( @this ) FROM V</code></pre>
</div>
</div>
<hr>
<h5 id="_removeall" class="discrete">removeAll()</h5>
<div class="paragraph">
<p>Removes all the occurrences of the passed items.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.removeAll(&lt;item&gt;*)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>collection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT out().in().removeAll( @this ) FROM V</code></pre>
</div>
</div>
<hr>
<h5 id="_replace" class="discrete">replace()</h5>
<div class="paragraph">
<p>Replace a string with another one.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.replace(&lt;to-find&gt;, &lt;to-replace&gt;)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name.replace('Mr.', 'Ms.') FROM User</code></pre>
</div>
</div>
<hr>
<h5 id="_right" class="discrete">right()</h5>
<div class="paragraph">
<p>Returns a substring of the original cutting from the end of the string 'length' characters.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.right(&lt;length&gt;)</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Returns all the vertices where the name ends by "ke".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM V WHERE name.right( 2 ) = 'ke'</code></pre>
</div>
</div>
<hr>
<h5 id="_size" class="discrete">size()</h5>
<div class="paragraph">
<p>Returns the size of the collection.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.size()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>collection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Returns all the items in a tree with children:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM TreeItem WHERE children.size() &gt; 0</code></pre>
</div>
</div>
<hr>
<h5 id="_substring" class="discrete">subString()</h5>
<div class="paragraph">
<p>Returns a substring of the original cutting from 'begin' index up to 'end' index (not included).</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.subString(&lt;begin&gt; [,&lt;end&gt;] )</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Get all the items where the name begins with an "L":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name.substring( 0, 1 ) = 'L' FROM StockItems</code></pre>
</div>
</div>
<div class="paragraph">
<p>Substring of <code>ArcadeDB</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT "ArcadeDB".substring(0,6)</code></pre>
</div>
</div>
<div class="paragraph">
<p>returns <code>Orient</code></p>
</div>
<hr>
<h5 id="_trim" class="discrete">trim()</h5>
<div class="paragraph">
<p>Returns the original string removing white spaces from the begin and the end.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.trim()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name.trim() = 'Luke' FROM Actors</code></pre>
</div>
</div>
<hr>
<h5 id="_tojson" class="discrete">toJSON()</h5>
<div class="paragraph">
<p>Returns the record in JSON format.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.toJSON([&lt;format&gt;])</code></p>
</div>
<div class="paragraph">
<p>Where:
- <strong>format</strong> optional, allows custom formatting rules (separate multiple options by comma).
Rules are the following:
- <strong>rid</strong> to include records&#8217;s RIDs as attribute "@rid" - <strong>type</strong> to include the type name in the attribute "@type" - <strong>attribSameRow</strong> put all the attributes in the same row - <strong>indent</strong> is the indent level as integer.
By Default no ident is used - <strong>fetchPlan</strong> is the fetching strategy to use while fetching linked records - <strong>alwaysFetchEmbedded</strong> to always fetch embedded records (without considering the fetch plan) - <strong>dateAsLong</strong> to return dates (Date and Datetime types) as long numbers - <strong>prettyPrint</strong> indent the returning JSON in readeable (pretty) way.</p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>record</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">create vertex type Test
insert into Test content {"attr1": "value 1", "attr2": "value 2"}

select @this.toJson('rid,version,fetchPlan:in_*:-2 out_*:-2') from Test</code></pre>
</div>
</div>
<hr>
<h5 id="_tolowercase" class="discrete">toLowerCase()</h5>
<div class="paragraph">
<p>Returns the string in lower case.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.toLowerCase()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name.toLowerCase() = 'luke' FROM Actors</code></pre>
</div>
</div>
<hr>
<h5 id="_touppercase" class="discrete">toUpperCase()</h5>
<div class="paragraph">
<p>Returns the string in upper case.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.toUpperCase()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT name.toUpperCase() = 'LUKE' FROM Actors</code></pre>
</div>
</div>
<hr>
<h5 id="_type" class="discrete">type()</h5>
<div class="paragraph">
<p>Returns the value&#8217;s ArcadeDB Type.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.type()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>Prints the type used to store dates:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM date.type() FROM Events</code></pre>
</div>
</div>
<hr>
<h5 id="_values" class="discrete">values()</h5>
<div class="paragraph">
<p>Returns the map&#8217;s values as a separate collection.
Useful to use in conjunction with IN, CONTAINS and CONTAINSALL operators.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;value&gt;.values()</code></p>
</div>
<div class="paragraph">
<p>Applies to the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>maps</p>
</li>
<li>
<p>documents</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Clients WHERE map.values() CONTAINSALL ( name is not null)</code></pre>
</div>
</div>
<hr>
<h5 id="_iswithin" class="discrete">isWithin()</h5>
<div class="paragraph">
<p>Returns Boolean answering if argument shape is fully inside shape instance.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;point|circle|rectangle|linestring|polygon&gt;.isWithin(&lt;point|circle|rectangle|linestring|polygon&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT point(11,11).isWithin( circle(10,10,10) ) AS inside</code></pre>
</div>
</div>
<hr>
<h5 id="_intersectswith" class="discrete">intersectsWith()</h5>
<div class="paragraph">
<p>Returns Boolean answering if argument shape intersects with shape instance.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>&lt;point|circle|rectangle|linestring|polygon&gt;.intersectsWith(&lt;point|circle|rectangle|linestring|polygon&gt;)</code></p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT linestring( [ [10,10], [20,10], [20,20], [10,20], [10,10] ] ).intersectsWith( rectangle(10,10,20,20) ) AS collision</code></pre>
</div>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="Filtering">8.3. Filtering</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Where.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>The Where condition is shared among many SQL commands.</p>
</div>
<h4 id="_syntax_2" class="discrete">Syntax</h4>
<div class="paragraph">
<p><code>[&lt;item&gt;] &lt;operator&gt; &lt;item&gt;</code></p>
</div>
<h4 id="_items" class="discrete">Items</h4>
<div class="paragraph">
<p>And <code>item</code> can be:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>What</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Example</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Document field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where <em>price</em> &gt; 1000000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">field&lt;indexes&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Document field part. To know more about field part look at the full syntax: <a href="#Supported-Types">Document-API-Property</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where tags[name='Hi'] or tags[0&#8230;&#8203;3] IN ('Hello') and employees IS NOT NULL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">record attribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Record attribute name with @ as prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where <em>@type</em> = 'Profile'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of the column. Useful in Column Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where <em>column(1)</em> &gt; 300</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents any field of the Document. The condition is true if ANY of the fields matches the condition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where <em>any()</em> like 'L%'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">all()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents all the fields of the Document. The condition is true if ALL the fields match the condition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where <em>all()</em> is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Functions">Functions</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any <a href="#SQL-Functions">Function</a> between the defined ones</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where distance(x, y, 52.20472, 0.14056 ) &lt;= 30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Filtering">$variable</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Context variable prefixed with $</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where $depth &lt;= 3</p></td>
</tr>
</tbody>
</table>
<h5 id="_record_attributes" class="discrete">Record attributes</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@this</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns the record itself</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">select <strong>@this.toJSON()</strong> from Account</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@rid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns the <a href="#RID">RID</a> in the form &lt;bucket:position&gt;. It&#8217;s null for embedded records. _NOTE: using @rid in where condition slow down queries. Much better to use the <a href="#RID">RID</a> as target. Example: change this: select from Profile where @rid = #10:44 with this: select from #10:44</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>@rid</strong> = #11:0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns the record size in bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>@size</strong> &gt; 1024</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns the record type between: 'document', 'column', 'flat', 'bytes'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>@type</strong> = 'flat'</p></td>
</tr>
</tbody>
</table>
<h4 id="_filtering-operators" class="discrete">Operators</h4>
<h5 id="_conditional_operators" class="discrete">Conditional Operators</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Apply to</th>
<th class="tableblock halign-left valign-top">Operator</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>=</code> or <code>==</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name <strong>=</strong> 'Luke'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;=&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null-safe equal to, is also true if left and right operands are <code>null</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name <strong>&lt;=&gt;</strong> word</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIKE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Similar to equals, but allows the wildcards '%' that means "any characters" and '?' that means "any single character". LIKE is case sensitive.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name <em>LIKE</em> 'Luk%'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Less than</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">age <strong>&lt;</strong> 40</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Less or equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">age <strong>&lt;=</strong> 40</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Greater than</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">age <strong>&gt;</strong> 40</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Greater or equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">age <strong>&gt;=</strong> 40</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;&gt;</code> or <code>!=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">age <strong>&lt;&gt;</strong> 40</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BETWEEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value is between a range. It&#8217;s equivalent to &lt;field&gt; &gt;= &lt;from-value&gt; AND &lt;field&gt; &lt;= &lt;to-value&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">price <em>BETWEEN</em> 10 and 30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to test if a value is NULL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">children <em>IS</em> null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">record, string (as type name)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSTANCEOF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to check if the record extends a type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@this <em>INSTANCEOF</em> 'Customer' or @type <em>INSTANCEOF</em> 'Provider'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contains any of the elements listed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name <em>IN</em> ['European','Asiatic']</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONTAINS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if the collection contains at least one element that satisfy the next condition. Condition can be a single item: in this case the behaviour is like the IN operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">children <em>CONTAINS</em> (name = 'Luke') - map.values() <em>CONTAINS</em> (name = 'Luke')</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONTAINSALL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if all the elements of the collection satisfy the next condition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">children <em>CONTAINSALL</em> (name = 'Luke')</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONTAINSANY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if any the elements of the collection satisfy the next condition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">children <em>CONTAINSANY</em> (name = 'Luke')</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONTAINSKEY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if the map contains at least one key equals to the requested. You can also use map.keys() CONTAINS in place of it</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">connections <em>CONTAINSKEY</em> 'Luke'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONTAINSVALUE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if the map contains at least one value equals to the requested. You can also use map.values() CONTAINS in place of it</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">connections <em>CONTAINSVALUE</em> 10:3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONTAINSTEXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When used against an indexed field, a lookup in the index will be performed with the text specified as key. When there is no index a simple Java indexOf will be performed. So the result set could be different if you have an index or not on that field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text <em>CONTAINSTEXT</em> 'jay'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MATCHES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Matches the string using a <a href="http://www.regular-expressions.info/">Regular Expression</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text <em>MATCHES</em> <code>\b[A-Z0-9.%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b</code></p></td>
</tr>
</tbody>
</table>
<h5 id="_logical_operators" class="discrete">Logical Operators</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operator</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if both the conditions are true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name = 'Luke' <strong>and</strong> surname like 'Sky%'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if at least one of the condition is true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name = 'Luke' <strong>or</strong> surname like 'Sky%'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NOT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if the condition is false. NOT needs parenthesis on the right with the condition to negate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>not</strong> ( name = 'Luke')</p></td>
</tr>
</tbody>
</table>
<h5 id="_mathematics_operators" class="discrete">Mathematics Operators</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Apply to</th>
<th class="tableblock halign-left valign-top">Operator</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Numbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>age + 34</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Numbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>salary - 34</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Numbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiply</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>factor * 1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Numbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Divide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>total / 12</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Numbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mod</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>total % 3</code></p></td>
</tr>
</tbody>
</table>
<h5 id="_methods_3" class="discrete">Methods</h5>
<div class="paragraph">
<p>Also called "Field Operators", are <a href="#SQL-Methods">SQL-Methods</a>.</p>
</div>
<h4 id="_variables" class="discrete">Variables</h4>
<div class="paragraph">
<p>ArcadeDB supports variables managed in the context of the command/query. By default, some variables are created. Below the table with the available variables:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Command(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$parent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the parent context from a sub-query. Example: <code>select from V let $type = ( traverse * from $parent.$current.children )</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Select">SELECT</a> and <a href="#SQL-Traverse">TRAVERSE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$current</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current record to use in sub-queries to refer from the parent&#8217;s variable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Select">SELECT</a> and <a href="#SQL-Traverse">TRAVERSE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$depth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current depth of nesting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Traverse">TRAVERSE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The string representation of the current path. Example: <code><mark>6:0.in.#5:0</mark>.out</code>. You can also display it with <code>select $path from (traverse * from V)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Traverse">TRAVERSE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$stack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The List of operation in the stack. Use it to access to the history of the traversal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Traverse">TRAVERSE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$history</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The set of all the records traversed as a <code>Set&lt;RID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SQL-Traverse">TRAVERSE</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To set custom variable use the <a href="#SQL-LET">LET</a> keyword.</p>
</div>
<h4 id="_wildcards" class="discrete">Wildcards</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbol</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Matches all strings that contain an unknown substring of any length at the position of <code>%</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"%DB" "A%DB" "Arcade%" all match "ArcadeDB"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Matches all strings that contain an unknown character at the position of <code>?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"N?SQL" matches "NoSQL" but not "NewSQL"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Filtering for strings containing wildcards characters can be done by escaping with backslash, i.e. <code>\%</code>, <code>\?</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="SQL-Commands">8.4. Commands</h3>
<h3 id="_sql_align_database" class="discrete">SQL - <code>ALIGN DATABASE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Align-Database.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Executes a distributed alignment of the database. It must be executed on the Leader server. The alignment computes a checksum of
each file and sends them to the replica nodes. Each replica node will compute the checksum on its own files. The files that are
mismatching are requested by the replica to the leader. In the future single pages could be transferred instead of the entire file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Align Database command is available only when the server is running with the <a href="#High-Availability">HA module</a> active.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ALIGN DATABASE</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command returns which page have been aligned on each server.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Align the current database.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALIGN DATABASE</pre>
</div>
</div>
<h3 id="SQL-Alter-Database" class="discrete">SQL - <code>ALTER DATABASE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Alter-Database.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Change a database setting. You can find the available settings in <a href="#Settings">Settings</a> appendix. The update is persistent.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ALTER DATABASE &lt;setting-name&gt; &lt;setting-value&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;setting-name&gt;</code></strong> Check the available settings in <a href="#Settings">Settings</a> appendix. Since the setting name contains <code>.</code>
characters, surround the setting name with <code>`</code>.</p>
</li>
<li>
<p><strong><code>&lt;setting-value&gt;</code></strong> The new value to set</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the date time format to support milliseconds (the default is 'yyyy-MM-dd HH:mm:ss').</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER DATABASE `arcadedb.dateTimeFormat` 'yyyy-MM-dd HH:mm:ss.SSS'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the default page size for buckets to 262,144 bytes. This is useful when importing database with records bigger than the
default page.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER DATABASE `arcadedb.bucketDefaultPageSize` 262144</pre>
</div>
</div>
<h3 id="SQL-Alter-Property" class="discrete">SQL - <code>ALTER PROPERTY</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Alter-Property.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Change a property defined in the schema. The change is persistent.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ALTER PROPERTY &lt;type-name&gt;.&lt;property-name&gt; &lt;attribute-name&gt; &lt;attribute-value&gt; [CUSTOM &lt;custom-key&gt; = &lt;custom-value&gt;]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type-name&gt;</code></strong> Defines the type where the property is defined</p>
</li>
<li>
<p><strong><code>&lt;property-name&gt;</code></strong> Defines the property in the <code>type-name</code> you want to change</p>
</li>
<li>
<p><strong><code>&lt;attribute-name&gt;</code></strong> Defines the attribute you want to change. For a list of supported attributes, see the table below</p>
</li>
<li>
<p><strong><code>&lt;attribute-value&gt;</code></strong> Defines the value you want to set</p>
<div class="ulist">
<ul>
<li>
<p><code>mandatory &lt;true|false&gt;</code> If true, the property must be present. Default is false</p>
</li>
<li>
<p><code>notnull &lt;true|false&gt;</code> If true, the property, if present, cannot be null. Default is false</p>
</li>
<li>
<p><code>readonly &lt;true|false&gt;</code> If true, the property cannot be changed after the creation of the record. Default is false</p>
</li>
<li>
<p><code>min &lt;number|string&gt;</code> Defines the minimum value for this property.
For number types it is the minimum number as a value.
For strings, it represents the minimum number of characters.
For dates is the minimum date (uses the database date format).
For collections (lists, sets, maps) this attribute determines the minimally required number of elements.</p>
</li>
<li>
<p><code>max &lt;number|string&gt;</code> Defines the maximum value for this property.
For number types it is the maximum number as a value.
For strings, it represents the maximum number of characters.
For dates is the maximum date (uses the database date format).
For collections (lists, sets, maps) this attribute determines the maximally allowed number of elements.</p>
</li>
<li>
<p><code>regexp &lt;string&gt;</code> Defines the mask to validate the input as a Regular Expression</p>
</li>
<li>
<p><code>default &lt;any&gt;</code> Defines default value if not present. Default is <code>null</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>&lt;custom-key&gt;</code></strong> Name of the custom property to set</p>
</li>
<li>
<p><strong><code>&lt;custom-value&gt;</code></strong> Value for the custom property. All data types are supported as values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the property 'subscribedOn' as mandatory:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER PROPERTY User.subscribedOn MANDATORY true</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the property 'createdOn' as read-only</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER PROPERTY User.createdOn READONLY true</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the custom value with key 'description':</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER PROPERTY Account.signedOn CUSTOM description = 'First Sign In'</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Create-Property"><code>CREATE PROPERTY</code></a></p>
</li>
<li>
<p><a href="#SQL-Drop-Property"><code>DROP PROPERTY</code></a></p>
</li>
<li>
<p><a href="#SQL-Alter-Type"><code>ALTER TYPE</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Alter-Type" class="discrete">SQL - <code>ALTER TYPE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Alter-Type.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Change a type defined in the schema.
The change is persistent.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ALTER TYPE &lt;type&gt; [&lt;attribute-name&gt; &lt;attribute-value&gt;] [CUSTOM &lt;custom-key&gt; = &lt;custom-value&gt;]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines the type you want to change</p>
</li>
<li>
<p><strong><code>&lt;attribute-name&gt;</code></strong> Defines the attribute you want to change.
For a list of supported attributes, see the table below</p>
</li>
<li>
<p><strong><code>&lt;attribute-value&gt;</code></strong> Defines the value you want to set</p>
</li>
<li>
<p><strong><code>&lt;custom-key&gt;</code></strong> Name of the custom property to set</p>
</li>
<li>
<p><strong><code>&lt;custom-value&gt;</code></strong> Value for the custom property. All data types are supported as values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add <code>Person</code> to the super types:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER TYPE Employee SUPERTYPE +Person</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove a super-type:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER TYPE Employee SUPERTYPE -Person</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the "account2" bucket to the type <code>Account</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER TYPE Account BUCKET +account2</pre>
</div>
</div>
<div class="paragraph">
<p>In the event that the bucket does not exist, it automatically creates it.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove a bucket from the type <code>Account</code> with the ID <code>34</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER TYPE Account BUCKET -34</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Modify the bucket selection strategy to <code>partitioned</code> selecting the property id as partition key:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER TYPE Account BucketSelectionStrategy `partitioned('id')`</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the custom value with key 'description':</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER TYPE Account CUSTOM description = 'All users'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the custom nested value with key 'meta':</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; ALTER TYPE Account CUSTOM meta = { abool: true, alist: [1,2,3,4,5]};</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Create-Type"><code>CREATE TYPE</code></a></p>
</li>
<li>
<p><a href="#SQL-Drop-Type"><code>DROP TYPE</code></a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Supported Attributes</strong></p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Support</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes the type name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SUPERTYPE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a super-type for the type. Use <code>NULL</code> to remove a super-type assignment. It supports multiple
inheritances. To set or add a new type, you can use the syntax <code>+&lt;type&gt;</code>, to remove it use <code>-&lt;type&gt;</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BUCKET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier or Integer</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code> to add a bucket
and <code>-</code> to remove it from the type. If the bucket doesn&#8217;t exist, it creates a physical bucket. Adding buckets to a type is also
useful in storing records in distributed servers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BUCKETSELECTIONSTRATEGY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change the selection of the bucket when new records are created. Using <code>partitioned()</code> is reccomended when your have a unique id</p></td>
</tr>
</tbody>
</table>
<h3 id="SQL-Backup-Database" class="discrete">SQL - <code>BACKUP DATABASE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Backup-Database.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Executes a backup of the current database. The resulting file is a compressed archive using ZIP as algorithm. The archive contains
the database directory without the transaction logs. The backup is executed taking a snapshot of the database at the time the
command is executed. Any pending transaction will not be in the backup archive. ArcadeDB allows to execute a non-stop backup of a
database while it is used without blocking writes or affecting performance.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">BACKUP DATABASE [ &lt;backup-file-url&gt; ]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;backup-file-url&gt;</code></strong> Optional, defines the location for the backup archive. If not specified, the backup file will
be <code>backups/&lt;db-name&gt;/&lt;db-name&gt;-backup-&lt;timestamp&gt;.tgz</code>, where the timestamp is expresses from the year to the millisecond.
Example of backup file name <code>backups/TheMatrix/TheMatrix-backup-20210921-172750767.zip</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute the backup of the current database with the default filename.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; BACKUP DATABASE</pre>
</div>
</div>
<h3 id="_sql_check_database" class="discrete">SQL - <code>CHECK DATABASE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Check-Database.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Executes an integrity check and in case of a repair of the database. This command analyzes the following things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>buckets: all the pages and records are scanned and checked if can be loaded (no physical corruption)</p>
</li>
<li>
<p>vertices: all the vertices are loaded and all the connected edges are checked. In case some edges point to records that have been
deleted they can be fixed automatically if the <code>FIX</code> option is enabled.</p>
</li>
<li>
<p>edges: scan all the edges and check the incoming and outgoing links are consistent in the relative vertices. If not, the edges can
be automatically removed if the <code>FIX</code> option is enabled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CHECK DATABASE [ TYPE &lt;type-name&gt;[,]* ] [ BUCKET &lt;bucket-name&gt;[,]* ] [ FIX ]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type-name&gt;</code></strong> Optional, if specified limit the check (and the fix) only to the specific types</p>
</li>
<li>
<p><strong><code>&lt;bucket-name&gt;</code></strong> Optional, if specified limit the check (and the fix) only to the specific buckets</p>
</li>
<li>
<p><strong><code>FIX</code></strong> Optional, if defined auto fix the issue found with the check</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command returns the integrity check report in one record with the fields:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Field</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>avgPageUsed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">average space used in a page.
                  This is a percentage value, where 100% means all the pages are full.
                  If a record is too big, a page is split into multiple pages and multiple reads are necessary.
                  Sometimes it helps to create buckets with larger pages to accommodate large records,
                  see the <a href="#Settings"><code>bucketDefaultPageSize</code></a> setting.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warnings</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set of warning messages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalSurrogateRecords</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of records that have been moved between pages.
                            This happens when a record is updated and doesn&#8217;t fit the original page,
                            so a surrogate (placeholder) is set to point to the new page/position or it&#8217;s a piece of a record stored on multiple pages. Internal, can be ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalPlaceholderRecords</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see above. Internal, can be ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pageSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">internal, can be ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalDeletedRecords</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of records deleted in the database (allocated minus active).
                          When a record is deleted, it&#8217;s RID is not recycled!</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalAllocatedRecords</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">total number of records created in the database.
                            A record can be of type document, vertex or edge.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalAllocatedDocuments</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see above, but only documents records.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalAllocatedVertices</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see above, but only vertex records.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalAllocatedEdges</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see above, but only edge records.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalActiveRecords</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">total number of records that are "active" (not deleted).
                         A record can be of type document, vertex or edge.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalActiveDocuments</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see above, but only vertex document.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalActiveVertices</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see above, but only vertex records.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalActiveEdges</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see above, but only edge records.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalMaxOffset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">internal, can be ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deletedRecordsAfterFix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">holds the list of RIDs deleted after a fix.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>corruptedRecords</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all the records not found in the database.
                       This could happen with broken edges (edges pointing to deleted vertices).
                       This should be zero; if not, it means there is a bug in the graph operations that doesn&#8217;t keep operations 100% transactional. Please report this.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalPages</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">total number of pages in the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rebuiltIndexes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">list of indexes that have been rebuilt automatically if corrupted records were found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>operation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">can be ignored, set by the console.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>invalidLinks</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">similar to corrupted records; should be zero.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalErrors</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">counter of errors encountered while checking the database.
             It should be zero.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>autoFix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">counter of autofix operations executed by the check database under the hood when corrupted records have been encountered.
              Some operations, like broken edges, can be fixed and restored automatically.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute the integrity check of the entire database without fixing any issue found.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CHECK DATABASE</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute the integrity check of the types 'Account' and 'Bill' without fixing any issue found.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CHECK DATABASE TYPE Account, Bill</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute the integrity check only on the bucket 'Account_Europe' without fixing any issue found.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CHECK DATABASE BUCKET Account_Europe</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute the integrity check of the entire database and auto fix any issues found.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CHECK DATABASE FIX</pre>
</div>
</div>
<h3 id="SQL-Create-Bucket" class="discrete">SQL - <code>CREATE BUCKET</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Create-Bucket.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Creates a new bucket in the database. Once created, you can use the bucket to save records by specifying its name during saves. If you want to add the new bucket to a type, follow its creation with the <a href="#SQL-Alter-Type"><code>ALTER TYPE</code></a> command.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE BUCKET &lt;bucket&gt; [ID &lt;bucket-id&gt;]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;bucket&gt;</code></strong> Defines the name of the bucket you want to create. You must use a letter for the first character, for all other characters, you can use alphanumeric characters, underscores and dashes.</p>
</li>
<li>
<p><strong><code>&lt;bucket-id&gt;</code></strong> Defines the numeric ID you want to use for the bucket.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the bucket <code>account</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE BUCKET account</pre>
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>For more information see:</p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Drop-Bucket"><code>DROP BUCKET</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Create-Edge" class="discrete">SQL - <code>CREATE EDGE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Create-Edge.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Creates a new edge in the database.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE EDGE &lt;type&gt; [BUCKET &lt;bucket&gt;] [UPSERT] FROM &lt;rid&gt;|(&lt;query&gt;)|[&lt;rid&gt;]* TO &lt;rid&gt;|(&lt;query&gt;)|[&lt;rid&gt;]*
                    [IF NOT EXISTS]
                    [SET &lt;field&gt; = &lt;expression&gt;[,]*]|CONTENT {&lt;JSON&gt;}
                    [RETRY &lt;retry&gt; [WAIT &lt;pauseBetweenRetriesInMs]] [BATCH &lt;batch-size&gt;]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines the type name for the edge.</p>
</li>
<li>
<p><strong><code>&lt;bucket&gt;</code></strong> Defines the bucket in which you want to store the edge.</p>
</li>
<li>
<p><strong><code>IF NOT EXISTS</code></strong> skips the creation of the edge in another edge already exists with the same direction (same from/to) and same edge type.</p>
</li>
<li>
<p><strong><code>UPSERT</code></strong> allows to skip the creation of edges that already exist between two vertices (ie. a unique edge for a couple of vertices). This works only if the edge type has a UNIQUE index on <code>out, in</code> fields, otherwise the statement fails.</p>
</li>
<li>
<p><strong><code>JSON</code></strong> Provides JSON content to set as the record. Use this instead of entering data field by field.</p>
</li>
<li>
<p><strong><code>RETRY</code></strong> Define the number of retries to attempt in the event of conflict, (optimistic approach).</p>
</li>
<li>
<p><strong><code>WAIT</code></strong> Defines the time to delay between retries in milliseconds.</p>
</li>
<li>
<p><strong><code>BATCH</code></strong> Defines whether it breaks the command down into smaller blocks and the size of the batches. This helps to avoid memory issues when the number of vertices is too high. By default, it is set to <code>100</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Edges and Vertices form the main components of a Graph database. ArcadeDB supports polymorphism on edges.</p>
</div>
<div class="paragraph">
<p>When no edges are created ArcadeDB throws a <code>OCommandExecutionException</code> error. This makes it easier to integrate edge creation in transactions. In such cases, if the source or target vertices don&#8217;t exist, it rolls back the transaction.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new edge type and an edge of the new type:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE EDGE TYPE E1
ArcadeDB&gt; CREATE EDGE E1 FROM #10:3 TO #11:4</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an edge in a specific bucket:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE EDGE E1 BUCKET EuropeEdges FROM #10:3 TO #11:4</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an edge and define its properties:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE EDGE FROM #10:3 TO #11:4 SET brand = 'fiat'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an edge of the type <code>E1</code> and define its properties:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE EDGE E1 FROM #10:3 TO #11:4 SET brand = 'fiat', name = 'wow'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create edges of the type <code>Watched</code> between all action movies in the database and the user Luca, using sub-queries:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE EDGE Watched FROM (SELECT FROM account WHERE name = 'Luca') TO
            (SELECT FROM movies WHERE type.name = 'action')</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an edge using JSON content:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE EDGE E FROM #22:33 TO #22:55 CONTENT { "name": "Jay",
            "surname": "Miner" }</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an edge only if not previously created:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE INDEX Watched_out_in ON Watched (`@out`, `@in`) UNIQUE
ArcadeDB&gt; CREATE EDGE Watched FROM (SELECT FROM account WHERE name = 'Luca') TO
            (SELECT FROM movies WHERE type.name = 'action') IF NOT EXISTS</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Create-Vertex"><code>CREATE VERTEX</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Create-Index" class="discrete">SQL - <code>CREATE INDEX</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Create-Index.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Creates a new index. Indexes can be
- <strong>Unique</strong> Where they don&#8217;t allow duplicates.
- <strong>Not Unique</strong> Where they allow duplicates.
- <strong>Full Text</strong> Where they index any single word of text.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>There are several index algorithms available to determine how ArcadeDB indexes your database. For more information on these, see <a href="#Indexes">Indexes</a>.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE INDEX [&lt;name&gt;]
[ IF NOT EXISTS ]
[ ON &lt;type&gt; (&lt;property&gt;*) ]
&lt;index-type&gt; [&lt;key-type&gt;]
[ NULL_STRATEGY SKIP|ERROR]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;name&gt;</code></strong> Defines the logical name for the index. It&#8217;s required ony for manual indexes, otherwise the index name is assigned automatically by ArcadeDB at creation as <code>&lt;type&gt;[&lt;property&gt;[,]*]</code>. For example, the index created on type Friend, properties "firstName" and "lastName", it will be named "Friend[firstName,lastName]"</p>
</li>
<li>
<p><strong>IF NOT EXISTS</strong> Specifying this option, the index creation will just be ignored if the index already exists (instead of failing with an error)</p>
</li>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines the type to create an automatic index for. The type must already exist.</p>
</li>
<li>
<p><strong><code>&lt;property&gt;</code></strong> Defines the property you want to automatically index. The property must already exist.</p>
</li>
<li>
<p><strong><code>&lt;index-type&gt;</code></strong> Defines the index type you want to use:</p>
<div class="ulist">
<ul>
<li>
<p><code>UNIQUE</code> does not allow duplicate keys,</p>
</li>
<li>
<p><code>NOTUNIQUE</code> allows duplicate keys,</p>
</li>
<li>
<p><code>FULL_TEXT</code> based on any single word of text.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>&lt;key-type&gt;</code></strong> Defines the key type. With automatic indexes, the key type is automatically selected when the database reads the target schema property. For manual indexes, when not specified, it selects the key at run-time during the first insertion by reading the type of the type. In creating composite indexes, it uses a comma-separated list of types.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create an automatic index bound to the schema property, use the <code>ON</code> clause. In order to create an index, the schema must already exist in your database.</p>
</div>
<div class="paragraph">
<p>In the event that the <code>ON</code> and <code>&lt;key-type&gt;</code> clauses both exist, the database validates the specified property types. If the property types don&#8217;t equal those specified in the key type list, it throws an exception.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Null values are not indexed, so any query that is looking for null values will not use the index with a full scan.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A unique index does not regard or derived types or embedded documents of the indexed type.
</td>
</tr>
</table>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>You can use list key types when creating manual composite indexes, but bear in mind that such indexes are not yet fully supported.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a manual index to store dates:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE INDEX `mostRecentRecords` UNIQUE DATE</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an automatic index bound to the new property <code>id</code> in the type <code>User</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE PROPERTY User.id BINARY
ArcadeDB&gt; CREATE INDEX ON User (id) UNIQUE</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a series automatic indexes for the <code>thumbs</code> property in the type <code>Movie</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE INDEX ON Movie (thumbs) UNIQUE
ArcadeDB&gt; CREATE INDEX ON Movie (thumbs BY KEY) UNIQUE
ArcadeDB&gt; CREATE INDEX ON Movie (thumbs BY VALUE) UNIQUE</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a series of properties and on them create a composite index:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE PROPERTY Book.author STRING
ArcadeDB&gt; CREATE PROPERTY Book.title STRING
ArcadeDB&gt; CREATE PROPERTY Book.publicationYears LIST
ArcadeDB&gt; CREATE INDEX ON Book (author, title, publicationYears) UNIQUE</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an index on an edge&#8217;s date range:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE VERTEX TYPE File
ArcadeDB&gt; CREATE EDGE TYPE Has
ArcadeDB&gt; CREATE PROPERTY Has.started DATETIME
ArcadeDB&gt; CREATE PROPERTY Has.ended DATETIME
ArcadeDB&gt; CREATE INDEX ON Has (started, ended) NOTUNIQUE</pre>
</div>
</div>
<div class="paragraph">
<p>&gt;You can create indexes on edge types only if they contain the begin and end date range of validity. This is use case is very common with historical graphs, such as the example above.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using the above index, retrieve all the edges that existed in the year 2014:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM Has WHERE started &gt;= '2014-01-01 00:00:00.000' AND
            ended &lt; '2015-01-01 00:00:00.000'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Using the above index, retrieve all edges that existed in 2014 and write them to the parent file:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT outV() FROM Has WHERE started &gt;= '2014-01-01 00:00:00.000'
            AND ended &lt; '2015-01-01 00:00:00.000'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Using the above index, retrieve all the 2014 edges and connect them to children files:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT inV() FROM Has WHERE started &gt;= '2014-01-01 00:00:00.000'
            AND ended &lt; '2015-01-01 00:00:00.000'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an index that includes null values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, indexes ignore null values. Queries against null values that use an index returns no entries. To return an error in case of null values, append <code>NULL_STRATEGY ERROR</code> when you create the index.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE INDEX ON Employee (address) NOTUNIQUE NULL_STRATEGY ERROR</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Drop-Index"><code>DROP INDEX</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Create-Property" class="discrete">SQL - <code>CREATE PROPERTY</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Create-Property.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Creates a new property in the schema.
It requires that the type for the property already exist on the database.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>CREATE PROPERTY
&lt;type&gt;.&lt;property&gt; [IF NOT EXISTS] &lt;data-type&gt;
[&lt;property-constraint&gt;[,]*]</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines the type for the new property.</p>
</li>
<li>
<p><strong><code>&lt;property&gt;</code></strong> Defines the logical name for the property.</p>
</li>
<li>
<p><strong><code>&lt;data-type&gt;</code></strong> Defines the property data type.
For supported types, see the table below.</p>
</li>
<li>
<p><strong><code>&lt;property-constraint&gt;</code></strong> See <a href="#SQL-Alter-Property"><code>ALTER PROPERTY</code></a> <code>&lt;attribute-name&gt; * &lt;attribute-value&gt;</code></p>
<div class="ulist">
<ul>
<li>
<p><code>mandatory &lt;true|false&gt;</code> If true, the property must be present.
Default is false</p>
</li>
<li>
<p><code>notnull &lt;true|false&gt;</code> If true, the property, if present, cannot be null.
Default is false</p>
</li>
<li>
<p><code>readonly &lt;true|false&gt;</code> If true, the property cannot be changed after the creation of the record.
Default is false</p>
</li>
<li>
<p><code>min &lt;number|string&gt;</code> Defines the minimum value for this property.
For number types it is the minimum number as a value.
For strings it represents the minimum number of characters.
For dates is the minimum date (uses the database date format).
For collections (lists, sets, maps) this attribute determines the minimally required number of elements.</p>
</li>
<li>
<p><code>max &lt;number|string&gt;</code> Defines the maximum value for this property.
For number types it is the maximum number as a value.
For strings it represents the maximum number of characters.
For dates is the maximum date (uses the database date format).
For collections (lists, sets, maps) this attribute determines the maximally allowed number of elements.</p>
</li>
<li>
<p><code>regexp &lt;string&gt;</code> Defines the mask to validate the input as a Regular Expression</p>
</li>
<li>
<p><code>default &lt;any&gt;</code> Defines default value if not present. Default is <code>null</code>.</p>
</li>
<li>
<p><code>IF NOT EXISTS</code> If specified, create the property only if not exists.
If a property with the same name already exists in the type, then no error is returned</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When you create a property, ArcadeDB checks the data for property and type.
In the event that persistent data contains incompatible values for the specified type, the property creation fails.
It applies no other constraints on the persistent data.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When constraints are set, such as <code>mandatory</code>, <code>read-only</code>, etc., it&#8217;s not possible to use the Gremlin syntax to add vertices and edges without incurring in a Validation exception.
The issue is that Gremlin API sets the properties after the creation of the vertex and edge.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the property <code>name</code> of the string type in the type <code>User</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE PROPERTY User.name STRING</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a property formed from a list of strings called <code>tags</code> in the type <code>Profile</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE PROPERTY Profile.tags LIST</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the property <code>friends</code>, as an embedded map:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE PROPERTY Profile.friends MAP</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the property <code>address</code>, as an embedded document:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE PROPERTY Profile.address EMBEDDED</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the property <code>date</code> of type date with additional constraints:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE PROPERTY Transaction.createdOn DATE (mandatory true, notnull true, readonly true, min "2010-01-01")</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the property <code>salary</code> only if it does not exist:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE PROPERTY Employee.salary IF NOT EXISTS double</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the property <code>hiredAt</code> with the time of creation being the default value:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE PROPERTY Employee.hiredAt DATETIME (readonly, default sysdate('YYYY-MM-DD HH:MM:SS'))</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Alter-Property"><code>ALTER PROPERTY</code></a></p>
</li>
<li>
<p><a href="#SQL-Drop-Property"><code>DROP PROPERTY</code></a></p>
</li>
</ul>
</div>
<div id="Supported-Types" class="paragraph">
<p><strong>Supported Types</strong></p>
</div>
<div class="paragraph">
<p>ArcadeDB supports the following data types for standard properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BOOLEAN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SHORT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATETIME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BYTE</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INTEGER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LONG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LINK</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DECIMAL</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DOUBLE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BINARY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EMBEDDED</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>It supports the following data types for container properties.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LIST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MAP</code></p></td>
</tr>
</tbody>
</table>
<h3 id="SQL-Create-Type" class="discrete">SQL - <code>CREATE TYPE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Create-Type.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Creates a new type in the schema.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE &lt;DOCUMENT|VERTEX|EDGE&gt; TYPE &lt;type&gt;
[ IF NOT EXISTS ]
[EXTENDS &lt;super-type&gt;] [BUCKET &lt;bucket-id&gt;[,]*] [BUCKETS &lt;total-bucket-number&gt;]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Use <strong><code>&lt;DOCUMENT|VERTEX|EDGE&gt;</code></strong> if you are creating respectively a document, vertex or edge type.</p>
</li>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines the name of the type you want to create. You must use a letter, underscore or dollar for the first character,
for all other characters you can use alphanumeric characters, underscores and dollar.</p>
</li>
<li>
<p><strong>IF NOT EXISTS</strong> Specifying this option, the type creation will just be ignored if the type already exists (instead of failing
with an error)</p>
</li>
<li>
<p><strong><code>&lt;super-type&gt;</code></strong> Defines the super-type you want to extend with this type.</p>
</li>
<li>
<p><strong><code>&lt;bucket-id&gt;</code></strong> Defines in a comma-separated list the ID&#8217;s of the buckets you want this type to use.</p>
</li>
<li>
<p><strong><code>&lt;total-bucket-number&gt;</code></strong> Defines the total number of buckets you want to create for this type. The default value is <code>1</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the event that a bucket of the same name exists in the bucket, the new type uses this bucket by default. If you do not define a
bucket in the command and a bucket of this name does not exist, ArcadeDB creates one. The new bucket has the same name as the type,
but in lower-case.</p>
</div>
<div class="paragraph">
<p>When working with multiple cores, it is recommended that you use multiple buckets to improve concurrency during inserts. To change
the number of buckets created by default, <a href="#SQL-Alter-Database"><code>ALTER DATABASE</code></a> command to update the <code>minimumbuckets</code> property.
You can also define the number of buckets you want to create using the <code>BUCKETS</code> option when you create the type.</p>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the document type <code>Account</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE DOCUMENT TYPE Account</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the vertex type <code>Car</code> to extend <code>Vehicle</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE VERTEX TYPE Car EXTENDS Vehicle</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the vertex type <code>Car</code>, using the bucket with name 'Car_classic' and 'Car_modern':</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE VERTEX TYPE Car BUCKET Car_classic,Car_modern</pre>
</div>
</div>
<div id="Bucket-Selection" class="paragraph">
<p><strong>Bucket Selection Strategies</strong></p>
</div>
<div class="paragraph">
<p>When you create a type, it inherits the bucket selection strategy defined at the database-level. By default, this is set to
<code>round-robin</code>. You can change the database default using the <a href="#SQL-Alter-Database"><code>ALTER DATABASE</code></a> command and the selection
strategy for the type using the <a href="#SQL-Alter-Type"><code>ALTER TYPE</code></a> command.</p>
</div>
<div class="paragraph">
<p>Supported Strategies:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Strategy</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>round-robin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selects the next bucket in a circular order, restarting once complete.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>thread</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selects the next bucket by using the partition (mod) from the current thread id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>partitioned</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selects the smallest bucket. Allows the type to have
all underlying buckets balanced on size. When adding a new bucket to an existing type, it fills the new bucket first. When using a
distributed database, this keeps the servers balanced with the same amount of data. It calculates the bucket size every five seconds
or more to avoid slow-downs on insertion.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Alter-Type"><code>ALTER TYPE</code></a></p>
</li>
<li>
<p><a href="#SQL-Drop-Type"><code>DROP TYPE</code></a></p>
</li>
<li>
<p><a href="#SQL-Create-Bucket"><code>CREATE BUCKET</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Create-Vertex" class="discrete">SQL - <code>CREATE VERTEX</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Create-Vertex.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Creates a new vertex in the database.</p>
</div>
<div class="paragraph">
<p>The Vertex and Edge are the main components of a Graph database. ArcadeDB supports polymorphism on vertices.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE VERTEX [&lt;type&gt;] [BUCKET &lt;bucket&gt;] [SET &lt;field&gt; = &lt;expression&gt;[,]*]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines the type to which the vertex belongs.</p>
</li>
<li>
<p><strong><code>&lt;bucket&gt;</code></strong> Defines the bucket in which it stores the vertex.</p>
</li>
<li>
<p><strong><code>&lt;field&gt;</code></strong> Defines the field you want to set.</p>
</li>
<li>
<p><strong><code>&lt;expression&gt;</code></strong> Defines the express to set for the field.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When using a distributed database, you can create vertexes through two steps (creation and update). Doing so can break constraints defined at the type-level for vertices. To avoid these issues, disable constraints in the vertex type.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new vertex type, then create a vertex in that type:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE VERTEX TYPE V1
ArcadeDB&gt; CREATE VERTEX V1</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new vertex within a particular bucket:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; &lt;code type="userinput lang-sql"&gt;CREATE VERTEX V1 BUCKET recent</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new vertex, defining its properties:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE VERTEX SET brand = 'fiat'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new vertex of the type <code>V1</code>, defining its properties:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE VERTEX V1 SET brand = 'fiat', name = 'wow'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a vertex using JSON content:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; CREATE VERTEX Employee CONTENT { "name" : "Jay", "surname" : "Miner" }</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Create-Edge"><code>CREATE EDGE</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Delete" class="discrete">SQL - <code>DELETE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Delete.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Removes one or more records from the database.
You can refine the set of records that it removes using the <a href="#Filtering"><code>WHERE</code></a> clause.</p>
</div>
<div class="paragraph">
<p><strong>Syntax:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">DELETE FROM &lt;Type&gt;|BUCKET:&lt;bucket&gt;|INDEX:&lt;index&gt; [RETURN &lt;returning&gt;]
  [WHERE &lt;Condition&gt;*] [LIMIT &lt;MaxRecords&gt;] [TIMEOUT &lt;MilliSeconds&gt;] [UNSAFE]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>RETURN</code></strong> Defines what values the database returns.
It takes one of the following values:</p>
</li>
<li>
<p><code>COUNT</code> Returns the number of deleted records.
This is the default option.</p>
</li>
<li>
<p><code>BEFORE</code> Returns the number of records before the removal.</p>
</li>
<li>
<p><strong><a href="#Filtering"><code>WHERE</code></a></strong> Filters to the records you want to delete.</p>
</li>
<li>
<p><strong><code>LIMIT</code></strong> Defines the maximum number of records to delete.</p>
</li>
<li>
<p><strong><code>TIMEOUT</code></strong> Defines the time period to allow the operation to run, before it times out.</p>
</li>
<li>
<p><strong><code>UNSAFE</code></strong> no use, is kept only for compatibility with OrientDB SQL and it could be removed in the future versions of the SQL language.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Delete all records with the surname <code>unknown</code>, ignoring case:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; DELETE FROM Profile WHERE surname.toLowerCase() = 'unknown'</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Delete all records of the type <code>Document</code>, due to an improper JSON import, or record creation command (note the use of the backticks):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; DELETE FROM `Document`</code></pre>
</div>
</div>
<h3 id="SQL-Drop-Bucket" class="discrete">SQL - <code>DROP BUCKET</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Drop-Bucket.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Removes the bucket and all of its content. This operation is permanent and cannot be rolled back.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">DROP BUCKET &lt;bucket-name&gt;|&lt;bucket-id&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;bucket-name&gt;</code></strong> Defines the name of the bucket you want to remove.</p>
</li>
<li>
<p><strong><code>&lt;bucket-id&gt;</code></strong> Defines the ID of the bucket you want to remove.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove the bucket <code>Account</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; DROP BUCKET Account</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Create-Bucket"><code>CREATE BUCKET</code></a></p>
</li>
<li>
<p><a href="#SQL-Drop-Type"><code>DROP TYPE</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Drop-Index" class="discrete">SQL - <code>DROP INDEX</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Drop-Index.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Removes an index from a property defined in the schema.</p>
</div>
<div class="paragraph">
<p>If the index does not exist, this call just returns with no errors.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">DROP INDEX &lt;index-name&gt; [ IF EXISTS ]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;index-name&gt;</code></strong> Defines the name of the index.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove the index on the <code>Id</code> property of the <code>Users</code> type:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; DROP INDEX `Users.Id`</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Create-Index"><code>CREATE INDEX</code></a></p>
</li>
<li>
<p><a href="#Indexes">Indexes</a></p>
</li>
</ul>
</div>
<h3 id="SQL-Drop-Property" class="discrete">SQL - <code>DROP PROPERTY</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Drop-Property.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Removes a property from the schema. Does not remove the property values in the records, it just changes the schema information. Records continue to have the property values, if any.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">DROP PROPERTY &lt;type&gt;.&lt;property&gt; [FORCE]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines the type where the property exists.</p>
</li>
<li>
<p><strong><code>&lt;property&gt;</code></strong> Defines the property you want to remove.</p>
</li>
<li>
<p><strong>FORCE</strong> In case one or more indexes are defined on the property, the command will throw an exception. Use FORCE to drop indexes together with the property</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove the <code>name</code> property from the type <code>User</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; DROP PROPERTY User.name</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Alter-Property"><code>ALTER PROPERTY</code></a></p>
</li>
<li>
<p><a href="#SQL-Create-Property"><code>CREATE PROPERTY</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Drop-Type" class="discrete">SQL - <code>DROP TYPE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Drop-Type.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Removes a type from the schema.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">DROP TYPE &lt;type&gt; [UNSAFE] [IF EXISTS]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines the type you want to remove.</p>
</li>
<li>
<p><strong><code>UNSAFE</code></strong> Defines whether the command drops non-empty edge and vertex types. Note, this can disrupt data consistency. Be sure to create a backup before running it.</p>
</li>
<li>
<p><strong><code>IF EXISTS</code></strong> Prevent errors if the type does not exits when attempting to drop it.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Bear in mind, that the schema must remain coherent. For instance, avoid removing calsses that are super-types to others. This operation won&#8217;t delete the associated bucket.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove the type <code>Account</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; DROP TYPE Account</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Create-Type"><code>CREATE TYPE</code></a></p>
</li>
<li>
<p><a href="#SQL-Alter-Type"><code>ALTER TYPE</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Explain" class="discrete">SQL - <code>EXPLAIN</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Explain.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>EXPLAIN SQL command returns information about query execution planning of a specific statement, without executing the statement itself.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>EXPLAIN &lt;command&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;command&gt;</code></strong> Defines the command that you want to profile, eg. a SELECT statement</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Profile a query that executes on a type filtering based on an attribute:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>  ArcadeDB {db=foo}&gt; explain select from v where name = 'a'

  Profiled command '[{

  executionPlan:{...},

  executionPlanAsString:

  + FETCH FROM TYPE v
    + FETCH FROM BUCKET 9 ASC
    + FETCH FROM BUCKET 10 ASC
    + FETCH FROM BUCKET 11 ASC
    + FETCH FROM BUCKET 12 ASC
    + FETCH FROM BUCKET 13 ASC
    + FETCH FROM BUCKET 14 ASC
    + FETCH FROM BUCKET 15 ASC
    + FETCH FROM BUCKET 16 ASC
    + FETCH NEW RECORDS FROM CURRENT TRANSACTION SCOPE (if any)
  + FILTER ITEMS WHERE
    name = 'a'

  }]' in 0,022000 sec(s):</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Commands">SQL Commands</a></p>
</li>
<li>
<p><a href="#SQL-Profile">PROFILE</a></p>
</li>
</ul>
</div>
<h3 id="_sql_export_database" class="discrete">SQL - <code>EXPORT DATABASE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Export-Database.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Exports a database in the <code>exports</code> directory under the root directory where ArcadeDB is running.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">EXPORT DATABASE &lt;url&gt; [FORMAT JSONL|GRAPHML|GRAPHSON] [OVERWRITE TRUE|FALSE]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;url&gt;</code></strong> Defines the location of the file to export. Use:</p>
<div class="ulist">
<ul>
<li>
<p><code>file://</code> as prefix for files located on the same file system where ArcadeDB is running. For security reasons, it is not possible to provide an absolute or relative path to the file</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>&lt;FORMAT&gt;</code></strong> The format of the export as a quoted string</p>
<div class="ulist">
<ul>
<li>
<p><strong>JSONL</strong> exports in JSONL format (one json per line)</p>
</li>
<li>
<p><strong>GraphML</strong> exports in the popular GraphML format. GraphML is supported by all the major Graph DBMS. This format does not support complex types, like collection of elements. Using GraphSON instead of GraphML is recommended</p>
</li>
<li>
<p><strong>GraphSON</strong> database export. GraphSON is supported by all the major Graph DBMS</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>&lt;OVERWRITE&gt;</code></strong> Overwrite the export file if exists. Default is false.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Export the current database under the <code>exports/</code> directory:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; EXPORT DATABASE file://database.jsonl.tgz</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Export the current database in GraphSON format, overwriting any existent file if present:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; EXPORT DATABASE file://Movies.graphson.tgz FORMAT GraphSON OVERWRITE true</pre>
</div>
</div>
<h3 id="SQL-Import-Database" class="discrete">SQL - <code>IMPORT DATABASE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Import-Database.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Executes an import of the database into the current one. Usually an import database is executed on an empty database, but it is
possible to execute on any database. In case of conflict (unique index key already existent, etc.), the conflicting records will not
be imported. The importer automatically recognize the file between the following formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OrientDB</strong> database export</p>
</li>
<li>
<p><strong>Neo4J</strong> database export</p>
</li>
<li>
<p><strong>GraphML</strong> database export. This format does not support complex types, like collection of elements. Using GraphSON instead of
GraphML is recommended</p>
</li>
<li>
<p><strong>GraphSON</strong> database export</p>
</li>
<li>
<p><strong>JSON</strong> documents or responses</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">IMPORT DATABASE &lt;url&gt; [WITH ( &lt;setting-name&gt; = &lt;setting-value&gt; [,] )* ]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;url&gt;</code></strong> Defines the location of the file to import. Use:</p>
<div class="ulist">
<ul>
<li>
<p><code>file://</code> as prefix for files located on the same file system where ArcadeDB is running.</p>
</li>
<li>
<p><code>https://</code> and <code>http://</code> as prefix for remote files.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Import the public OpenBeer database available as demo database for OrientDB and exported in TGZ file</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>IMPORT DATABASE https://github.com/ArcadeData/arcadedb-datasets/raw/main/orientdb/OpenBeer.gz</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Import the Movie database used in Neo4j&#8217;s examples:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>IMPORT DATABASE https://github.com/ArcadeData/arcadedb-datasets/raw/main/neo4j/movies.graphson.tgz</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Import a JSON response into document type <code>mytype</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>IMPORT DATABASE http://echo.jsontest.com/key/value/one/two WITH documentType = 'mytype';</pre>
</div>
</div>
<div class="paragraph">
<p>See also <a href="#Importer">Importer</a></p>
</div>
<h3 id="SQL-Insert" class="discrete">SQL - <code>INSERT</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Insert.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>The <a href="#SQL-Insert"><code>INSERT</code></a> command creates a new record in the database. Records can be schema-less or follow rules specified in your model.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">INSERT INTO [TYPE:]&lt;type&gt;|BUCKET:&lt;bucket&gt;|INDEX:&lt;index&gt;
  [(&lt;field&gt;[,]*) VALUES (&lt;expression&gt;[,]*)[,]*]|
  [SET &lt;field&gt; = &lt;expression&gt;|&lt;sub-command&gt;[,]*]|
  [CONTENT {&lt;JSON&gt;}]
  [RETURN &lt;expression&gt;]
  [FROM &lt;query&gt;]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>CONTENT</code></strong> Defines JSON data as an option to set field values.</p>
</li>
<li>
<p><strong><code>RETURN</code></strong> Defines an expression to return instead of the number of inserted records. You can use any valid SQL expression. The most common use-cases,</p>
<div class="ulist">
<ul>
<li>
<p><code>@rid</code> Returns the Record ID of the new record.</p>
</li>
<li>
<p><code>@this</code> Returns the entire new record.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>FROM</code></strong> Defines where you want to insert the result-set.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To insert only documents, vertices, or edges with a certain <strong>unique</strong> property, use a <a href="#SQL-Create-Index">unique index</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inserts a new record with the name <code>Jay</code> and surname <code>Miner</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As an example, in the SQL-92 standard, such as with a Relational database, you might use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO Profile (name, surname)
            VALUES ('Jay', 'Miner')</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, in the ArcadeDB abbreviated syntax, the query would be written as,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO Profile SET name = 'Jay', surname = 'Miner'</code></pre>
</div>
</div>
<div class="paragraph">
<p>In JSON content syntax, it would be written as this,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO Profile CONTENT {"name": "Jay", "surname": "Miner"}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Insert a new record of the type <code>Profile</code>, but in a different bucket from the default.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In SQL-92 syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO Profile BUCKET profile_recent (name, surname) VALUES
            ('Jay', 'Miner')</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternative, in the ArcadeDB abbreviated syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO Profile BUCKET profile_recent SET name = 'Jay',
            surname = 'Miner'</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Insert several records at the same time:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; INSERT INTO Profile (name, surname) VALUES ('Jay', 'Miner'),
            ('Frank', 'Hermier'), ('Emily', 'Sout')</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Insert a new record, adding a relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In SQL-93 syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO Employee (name, boss) VALUES ('jack', #11:09)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the ArcadeDB abbreviated syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO Employee SET name = 'jack', boss = #11:99</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Insert a new record, add a collection of relationships.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In SQL-93 syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO Profile (name, friends) VALUES ('Luca', [#10:3, #10:4])</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the ArcadeDB abbreviated syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO Profiles SET name = 'Luca', friends = [#10:3, #10:4]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Inserts using <a href="#SQL-Select"><code>SELECT</code></a> sub-queries</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; INSERT INTO Diver SET name = 'Luca', buddy = (SELECT FROM Diver
            WHERE name = 'Marko')</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Inserts using <a href="#SQL-Insert"><code>INSERT</code></a> sub-queries:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; INSERT INTO Diver SET name = 'Luca', buddy = (INSERT INTO Diver
            SET name = 'Marko')</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Inserting into a different bucket:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; INSERT INTO BUCKET:asiaemployee (name) VALUES ('Matthew')</pre>
</div>
</div>
<div class="paragraph">
<p>However, note that the document has no assigned type. To create a document of a certain type, but in a different bucket than the default, instead use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO BUCKET:asiaemployee (@type, content) VALUES
            ('Employee', 'Matthew')</code></pre>
</div>
</div>
<div class="paragraph">
<p>That inserts the document of the type <code>Employee</code> into the bucket <code>asiaemployee</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Insert a new record, adding it as an embedded document:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; INSERT INTO Profile (name, address) VALUES ('Luca', { "@type": "d",
            "street": "Melrose Avenue"})</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Insert a record with a list property:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; INSERT INTO Profile SET friends = list("Joe","Jack","John")</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Insert a record with a map property:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; INSERT INTO Profile SET address = map("home","Avenue Lane")</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Insert from a query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To copy records from another type, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO GermanyClient FROM SELECT FROM Client WHERE
            country = 'Germany'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This inserts all the records from the type <code>Client</code> where the country is Germany, in the type <code>GermanyClient</code>.</p>
</div>
<div class="paragraph">
<p>To copy records from one type into another, while adding a field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO GermanyClient FROM SELECT *, true AS copied FROM Client
            WHERE country = 'Germany'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This inserts all records from the type <code>Client</code> where the country is Germany into the type <code>GermanClient</code>, with the addition field <code>copied</code> to the value <code>true</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Insert a vertex or edge.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Besides the specialized commands <a href="#SQL-Create-Vertex">CREATE VERTEX</a> and <a href="#SQL-Create-Edge">CREATE EDGE</a>,
vertices and edges can be inserted via the <code>INSERT</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO MyVertexType SET name = 'John Doe'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; INSERT INTO MyEdgeType SET @out = #34:23, @in = #91:2323</code></pre>
</div>
</div>
<h3 id="SQL-Match" class="discrete">SQL - <code>MATCH</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Match.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Queries the database in a declarative manner, using pattern matching.</p>
</div>
<div class="paragraph">
<p><strong>Simplified Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>MATCH
  {
    [type: &lt;type&gt;],
    [as: &lt;alias&gt;],
    [where: (&lt;whereCondition&gt;)]
  }
  .&lt;functionName&gt;(){
    [type: &lt;typeName&gt;],
    [as: &lt;alias&gt;],
    [where: (&lt;whereCondition&gt;)],
    [while: (&lt;whileCondition&gt;)],
    [maxDepth: &lt;number&gt;],
    [depthAlias: &lt;identifier&gt; ],
    [pathAlias: &lt;identifier&gt; ],
    [optional: (true | false)]
  }*
  [,
    [NOT]
    {
      [as: &lt;alias&gt;],
      [type: &lt;type&gt;],
      [where: (&lt;whereCondition&gt;)]
    }
    .&lt;functionName&gt;(){
      [type: &lt;typeName&gt;],
      [as: &lt;alias&gt;],
      [where: (&lt;whereCondition&gt;)],
      [while: (&lt;whileCondition&gt;)],
      [maxDepth: &lt;number&gt;],
      [depthAlias: &lt;identifier&gt; ],
      [pathAlias: &lt;identifier&gt; ],
      [optional: (true | false)]
    }*
  ]*
RETURN [DISTINCT] &lt;expression&gt; [ AS &lt;alias&gt; ] [, &lt;expression&gt; [ AS &lt;alias&gt; ]]*
[ GROUP BY &lt;expression&gt; [, &lt;expression&gt;]* ]
[ ORDER BY &lt;expression&gt; [, &lt;expression&gt;]* ]
[ UNWIND &lt;Field&gt;* ]
[ SKIP &lt;number&gt; ]
[ LIMIT &lt;number&gt; ]</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines a valid target type.</p>
</li>
<li>
<p><strong><code>as: &lt;alias&gt;</code></strong> Defines an alias for a node in the pattern.</p>
</li>
<li>
<p><strong><code>&lt;whereCondition&gt;</code></strong> Defines a filter condition to match a node in the pattern. It supports the normal SQL <a href="#Filtering"><code>WHERE</code></a> clause. You can also use the <code>$currentMatch</code> and <code>$matched</code> <a href="#Match-Context-Variables">context variables</a>.</p>
</li>
<li>
<p><strong><code>&lt;functionName&gt;</code></strong> Defines a graph function to represent the connection between two nodes. For instance, <code>out()</code>, <code>in()</code>, <code>outE()</code>, <code>inE()</code>, etc.
For out(), in(), both() also a shortened <em>arrow</em> syntax is supported:</p>
</li>
<li>
<p><code>{&#8230;&#8203;}.out(){&#8230;&#8203;}</code> can be written as <code>{&#8230;&#8203;}--&gt;{&#8230;&#8203;}</code></p>
</li>
<li>
<p><code>{&#8230;&#8203;}.out(&quot;EdgeType&quot;){&#8230;&#8203;}</code> can be written as <code>{&#8230;&#8203;}-EdgeType-&gt;{&#8230;&#8203;}</code></p>
</li>
<li>
<p><code>{&#8230;&#8203;}.in(){&#8230;&#8203;}</code> can be written as <code>{&#8230;&#8203;}&lt;--{&#8230;&#8203;}</code></p>
</li>
<li>
<p><code>{&#8230;&#8203;}.in(&quot;EdgeType&quot;){&#8230;&#8203;}</code> can be written as <code>{&#8230;&#8203;}&lt;-EdgeType-{&#8230;&#8203;}</code></p>
</li>
<li>
<p><code>{&#8230;&#8203;}.both(){&#8230;&#8203;}</code> can be written as <code>{&#8230;&#8203;}--{&#8230;&#8203;}</code></p>
</li>
<li>
<p><code>{&#8230;&#8203;}.both(&quot;EdgeType&quot;){&#8230;&#8203;}</code> can be written as <code>{&#8230;&#8203;}-EdgeType-{&#8230;&#8203;}</code></p>
</li>
<li>
<p><strong><code>&lt;whileCondition&gt;</code></strong> Defines a condition that the statement must meet to allow the traversal of this path. It supports the normal SQL <a href="#Filtering"><code>WHERE</code></a> clause. You can also use the <code>$currentMatch</code>, <code>$matched</code> and <code>$depth</code> <a href="#Match-Context-Variables">context variables</a>. For more information, see <a href="#Deep-Traversal">Deep Traversal While Condition</a>, below.</p>
</li>
<li>
<p><strong><code>&lt;maxDepth&gt;</code></strong> Defines the maximum depth for this single path.</p>
</li>
<li>
<p><strong><code>&lt;depthAlias&gt;</code></strong> This is valid only if you have a <code>while</code> or a <code>maxDepth</code>. It defines the alias to be used to store the depth of this traversal. This alias can be used in the <code>RETURN</code> block to retrieve the depth of current traversal.</p>
</li>
<li>
<p><strong><code>&lt;pathAlias&gt;</code></strong> This is valid only if you have a <code>while</code> or a <code>maxDepth</code>. It defines the alias to be used to store the elements traversed to reach this alias. This alias can be used in the <code>RETURN</code> block to retrieve the elements traversed to reach this alias.</p>
</li>
<li>
<p><strong><code>RETURN &lt;expression&gt; [ AS &lt;alias&gt; ]</code></strong> Defines elements in the pattern that you want returned. It can use one of the following:</p>
</li>
<li>
<p>Aliases defined in the <code>as:</code> block.</p>
</li>
<li>
<p><code>$matches</code> Indicating all defined aliases.</p>
</li>
<li>
<p><code>$paths</code> Indicating the full traversed paths.</p>
</li>
<li>
<p><code>$elements</code> Indicating that all the elements that would be returned by the $matches have to be returned flattened, without duplicates.</p>
</li>
<li>
<p><code>$pathElements</code> Indicating that all the elements that would be returned by the $paths have to be returned flattened, without duplicates.</p>
</li>
<li>
<p><strong><code>optional</code></strong> if set to true, allows to evaluate and return a pattern even if that particular node does not match the pattern itself (ie. there is no value for that node in the pattern). In current version, optional nodes are allowed only on right terminal nodes, eg. <code>{} --&gt; {optional:true}</code> is allowed, <code>{optional:true} &lt;-- {}</code> is not.</p>
</li>
<li>
<p><strong><code>NOT</code> patterns</strong> Together with normal patterns, you can also define negative patterns. A result will be returned only if it also DOES NOT match any of the negative patterns, ie. if it matches at least one of the negative patterns it won&#8217;t be returned.</p>
</li>
<li>
<p><strong><a href="#SQL-Select-Unwind"><code>UNWIND</code></a></strong> Designates the field on which to unwind the collection.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>The following examples are based on this sample data-set from the type <code>People</code>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/match-example-table.png" alt="match example table"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/match-example-graph.png" alt="match example graph"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Find all people with the name John:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; MATCH {type: Person, as: people, where: (name = 'John')}
            RETURN people

---------
  people
---------
  #12:0
  #12:1
---------</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Find all people with the name John and the surname Smith:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; MATCH  {type: Person, as: people, where: (name = 'John' AND surname = 'Smith')}
	        RETURN people

-------
people
-------
 #12:1
-------</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Find people named John with their friends:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; MATCH {type: Person, as: person, where: (name = 'John')}.both('Friend') {as: friend}
            RETURN person, friend

--------+---------
 person | friend
--------+---------
 #12:0  | #12:1
 #12:0  | #12:2
 #12:0  | #12:3
 #12:1  | #12:0
 #12:1  | #12:2
--------+---------</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Find friends of friends:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; MATCH {type: Person, as: person, where: (name = 'John' AND surname = 'Doe')}
		    .both('Friend').both('Friend') {as: friendOfFriend}
		    RETURN person, friendOfFriend

--------+----------------
 person | friendOfFriend
--------+----------------
 #12:0  | #12:0
 #12:0  | #12:1
 #12:0  | #12:2
 #12:0  | #12:3
 #12:0  | #12:4
--------+----------------</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Find people, excluding the current user:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; MATCH {type: Person, as: person, where: (name = 'John' AND
            surname = 'Doe')}.both('Friend').both('Friend'){as: friendOfFriend,
			where: ($matched.person != $currentMatch)}
			RETURN person, friendOfFriend

--------+----------------
 person | friendOfFriend
--------+----------------
 #12:0  | #12:1
 #12:0  | #12:2
 #12:0  | #12:3
 #12:0  | #12:4
--------+----------------</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Find friends of friends to the sixth degree of separation:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; MATCH {type: Person, as: person, where: (name = 'John' AND
            surname = 'Doe')}.both('Friend'){as: friend,
			where: ($matched.person != $currentMatch) while: ($depth &lt; 6)}
			RETURN person, friend

--------+---------
 person | friend
--------+---------
 #12:0  | #12:0
 #12:0  | #12:1
 #12:0  | #12:2
 #12:0  | #12:3
 #12:0  | #12:4
--------+---------</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Finding friends of friends to six degrees of separation, since a particular date:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; MATCH {type: Person, as: person,
            where: (name = 'John')}.(bothE('Friend'){
			where: (date &lt; ?)}.bothV()){as: friend,
			while: ($depth &lt; 6)} RETURN person, friend</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the condition <code>$depth &lt; 6</code> refers to traversing the block <code>bothE(&#39;Friend&#39;)</code> six times.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Find friends of my friends who are also my friends, using multiple paths:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; MATCH {type: Person, as: person, where: (name = 'John' AND
            surname = 'Doe')}.both('Friend').both('Friend'){as: friend},
			{ as: person }.both('Friend'){ as: friend }
			RETURN person, friend

--------+--------
 person | friend
--------+--------
 #12:0  | #12:1
 #12:0  | #12:2
--------+--------</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the statement matches two expression: the first to friends of friends, the second to direct friends. Each expression shares the common aliases (<code>person</code> and <code>friend</code>). To match the whole statement, the result must match both expressions, where the alias values for the first expression are the same as that of the second.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Find common friends of John and Jenny:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; MATCH {type: Person, where: (name = 'John' AND
            surname = 'Doe')}.both('Friend'){as: friend}.both('Friend')
			{type: Person, where: (name = 'Jenny')} RETURN friend

--------
 friend
--------
 #12:1
--------</pre>
</div>
</div>
<div class="paragraph">
<p>The same, with two match expressions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, where: (name = 'John' AND
            surname = 'Doe')}.both('Friend'){as: friend},
			{type: Person, where: (name = 'Jenny')}.both('Friend')
			{as: friend} RETURN friend</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>DISTINCT</strong></p>
</div>
<div class="paragraph">
<p>The MATCH statement returns all the occurrences of a pattern, even if they are duplicated. To have unique, distinct records
as a result, you have to specify the DISTINCT keyword in the RETURN statement.</p>
</div>
<div class="paragraph">
<p>Example: suppose you have a dataset made like following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql"> INSERT INTO V SET name = 'John', surname = 'Smith';
 INSERT INTO V SET name = 'John', surname = 'Harris'
 INSERT INTO V SET name = 'Jenny', surname = 'Rose'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the result of the query without a DISTINCT clause:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, as:p} RETURN p.name as name

--------
 name
--------
 John
--------
 John
--------
 Jenny
--------</code></pre>
</div>
</div>
<div class="paragraph">
<p>And this is the result of the query with a DISTINCT clause:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, as:p} RETURN DISTINCT p.name as name

--------
 name
--------
 John
--------
 Jenny
--------</code></pre>
</div>
</div>
<div id="Match-Context-Variables" class="paragraph">
<p><strong>Context Variables</strong></p>
</div>
<div class="paragraph">
<p>When running these queries, you can use any of the following context variables:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$matched</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gives the current matched record. You must explicitly define the attributes for this record in order to access them. You can use this in the <code>where:</code> and <code>while:</code> conditions to refer to current partial matches or as part of the <code>RETURN</code> value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$currentMatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gives the current complete node during the match.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$depth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gives the traversal depth, following a single path item where a <code>while:</code> condition is defined.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Use Cases</strong></p>
</div>
<div class="paragraph">
<p><strong>Expanding Attributes</strong></p>
</div>
<div class="paragraph">
<p>You can run this statement as a sub-query inside of another statement. Doing this allows you to obtain details and aggregate data from the inner <a href="#SQL-Select"><code>SELECT</code></a> query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT person.name AS name, person.surname AS surname,
          friend.name AS friendName, friend.surname AS friendSurname
		  FROM (MATCH {type: Person, as: person,
		  where: (name = 'John')}.both('Friend'){as: friend}
		  RETURN person, friend)

--------+----------+------------+---------------
 name   | surname  | friendName | friendSurname
--------+----------+------------+---------------
 John   | Doe      | John       | Smith
 John   | Doe      | Jenny      | Smith
 John   | Doe      | Frank      | Bean
 John   | Smith    | John       | Doe
 John   | Smith    | Jenny      | Smith
--------+----------+------------+---------------</code></pre>
</div>
</div>
<div class="paragraph">
<p>As an alternative, you can use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, as: person,
		  where: (name = 'John')}.both('Friend'){as: friend}
		  RETURN
		  person.name as name, person.surname as surname,
		  friend.name as friendName, friend.surname as friendSurname

--------+----------+------------+---------------
 name   | surname  | friendName | friendSurname
--------+----------+------------+---------------
 John   | Doe      | John       | Smith
 John   | Doe      | Jenny      | Smith
 John   | Doe      | Frank      | Bean
 John   | Smith    | John       | Doe
 John   | Smith    | Jenny      | Smith
--------+----------+------------+---------------</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Incomplete Hierarchy</strong></p>
</div>
<div class="paragraph">
<p>Consider building a database for a company that shows a hierarchy of departments within the company. For instance,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">          [manager] department
          (employees in department)


                [m0]0
                 (e1)
                 /   \
                /     \
               /       \
           [m1]1        [m2]2
          (e2, e3)     (e4, e5)
             / \         / \
            3   4       5   6
          (e6) (e7)   (e8)  (e9)
          /  \
      [m3]7    8
      (e10)   (e11)
       /
      9
  (e12, e13)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This loosely shows that,
- Department <code>0</code> is the company itself, manager 0 (<code>m0</code>) is the CEO
- <code>e10</code> works at department <code>7</code>, his manager is <code>m3</code>
- <code>e12</code> works at department <code>9</code>, this department has no direct manager, so <code>e12&#8217;s manager is `m3</code> (the upper manager)</p>
</div>
<div class="paragraph">
<p>In this case, you would use the following query to find out who&#8217;s the manager to a particular employee:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type:Employee, where: (name = ?)}.out('WorksAt').out('ParentDepartment')
		  {while: (out('Manager').size() == 0),
		  where: (out('Manager').size() &gt; 0)}.out('Manager')
		  {as: manager} RETURN expand(manager)</code></pre>
</div>
</div>
<div id="Deep-Traversal" class="paragraph">
<p><strong>Deep Traversal</strong></p>
</div>
<div class="paragraph">
<p>Match path items act in a different manners, depending on whether or not you use <code>while:</code> conditions in the statement.</p>
</div>
<div class="paragraph">
<p>For instance, consider the following graph:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">[name='a'] -FriendOf-&gt; [name='b'] -FriendOf-&gt; [name='c']</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running the following statement on this graph only returns <code>b</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, where: (name = 'a')}.out("FriendOf")
          {as: friend} RETURN friend

--------
 friend
--------
 b
--------</code></pre>
</div>
</div>
<div class="paragraph">
<p>What this means is that it traverses the path item <code>out(&quot;FriendOf&quot;)</code> exactly once. It only returns the result of that traversal.</p>
</div>
<div class="paragraph">
<p>If you add a <code>while</code> condition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, where: (name = 'a')}.out("FriendOf")
          {as: friend, while: ($depth &lt; 2)} RETURN friend

---------
 friend
---------
 a
 b
---------</code></pre>
</div>
</div>
<div class="paragraph">
<p>Including a <code>while:</code> condition on the match path item causes ArcadeDB to evaluate this item as zero to <em>n</em> times. That means that it returns the starting node, (<code>a</code>, in this case), as the result of zero traversal.</p>
</div>
<div class="paragraph">
<p>To exclude the starting point, you need to add a <code>where:</code> condition, such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, where: (name = 'a')}.out("FriendOf")
          {as: friend, while: ($depth &lt; 2) where: ($depth &gt; 0)}
		  RETURN friend</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a general rule,</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>while</code> Conditions:</strong> Define this if it must execute the next traversal, (it evaluates at level zero, on the origin node).</p>
</li>
<li>
<p><strong><code>where</code> Condition:</strong> Define this if the current element, (the origin node at the zero iteration the right node on the iteration is greater than zero), must be returned as a result of the traversal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For instance, suppose that you have a genealogical tree. In the tree, you want to show a person, grandparent and the grandparent of that grandparent, and so on. The result: saying that the person is at level zero, parents at level one, grandparents at level two, etc., you would see all ancestors on even levels. That is, <code>level % 2 == 0</code>.</p>
</div>
<div class="paragraph">
<p>To get this, you might use the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, where: (name = 'a')}.out("Parent")
          {as: ancestor, while: (true) where: ($depth % 2 = 0)}
		  RETURN ancestor</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Best practices</strong></p>
</div>
<div class="paragraph">
<p>Queries can involve multiple operations, based on the domain model and use case. In some cases, like projection and aggregation, you can easily manage them with a <a href="#SQL-Select"><code>SELECT</code></a> query. With others, such as pattern matching and deep traversal, <a href="#SQL-Match"><code>MATCH</code></a> statements are more appropriate.</p>
</div>
<div class="paragraph">
<p>Use <a href="#SQL-Select"><code>SELECT</code></a> and <a href="#SQL-Match"><code>MATCH</code></a> statements together (that is, through sub-queries), to give each statement the correct responsibilities. Here,</p>
</div>
<div class="paragraph">
<p><strong>Filtering Record Attributes for a Single Type</strong></p>
</div>
<div class="paragraph">
<p>Filtering based on record attributes for a single type is a trivial operation through both statements. That is, finding all people named John can be written as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT FROM Person WHERE name = 'John'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also write it as,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, as: person, where: (name = 'John')}
          RETURN person</code></pre>
</div>
</div>
<div class="paragraph">
<p>The efficiency remains the same. Both queries use an index. With <a href="#SQL-Select"><code>SELECT</code></a>, you obtain expanded records, while with <a href="#SQL-Match"><code>MATCH</code></a>, you only obtain the Record ID&#8217;s. If you want to return expanded records from the MATCH, use the <code>expand()</code> function in the return statement:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, as: person, where: (name = 'John')}
          RETURN expand(person)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Filtering on Record Attributes of Connected Elements</strong></p>
</div>
<div class="paragraph">
<p>Filtering based on the record attributes of connected elements, such as neighboring vertices, can grow trick when using <a href="#SQL-Select"><code>SELECT</code></a>, while with <a href="#SQL-Match"><code>MATCH</code></a> it is simple.</p>
</div>
<div class="paragraph">
<p>For instance, find all people living in Rome that have a friend called John. There are three different ways you can write this, using <a href="#SQL-Select"><code>SELECT</code></a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM Person WHERE BOTH('Friend').name CONTAINS 'John'
          AND out('LivesIn').name CONTAINS 'Rome'

ArcadeDB&gt; SELECT FROM (SELECT BOTH('Friend') FROM Person WHERE name
          'John') WHERE out('LivesIn').name CONTAINS 'Rome'

ArcadeDB&gt; SELECT FROM (SELECT in('LivesIn') FROM City WHERE name = 'Rome')
          WHERE BOTH('Friend').name CONTAINS 'John'</pre>
</div>
</div>
<div class="paragraph">
<p>In the first version, the query is more readable, but it does not use indexes, so it is less optimal in terms of execution time. The second and third use indexes if they exist, (on <code>Person.name</code> or <code>City.name</code>, both in the sub-query), but they&#8217;re harder to read. Which index they use depends only on the way you write the query. That is, if you only have an index on <code>City.name</code> and not <code>Person.name</code>, the second version doesn&#8217;t use an index.</p>
</div>
<div class="paragraph">
<p>Using a <a href="#SQL-Match"><code>MATCH</code></a> statement, the query becomes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, where: (name = 'John')}.both("Friend")
          {as: result}.out('LivesIn'){type: City, where: (name = 'Rome')}
		  RETURN result</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, the query executor optimizes the query for you, choosing indexes where they exist. Moreover, the query becomes more readable, especially in complex cases, such as multiple nested <a href="#SQL-Select"><code>SELECT</code></a> queries.</p>
</div>
<div class="paragraph">
<p><strong><code>TRAVERSE</code> Alternative</strong></p>
</div>
<div class="paragraph">
<p>There are similar limitations to using <a href="#SQL-Traverse"><code>TRAVERSE</code></a>. You may benefit from using <a href="#SQL-Match"><code>MATCH</code></a> as an alternative.</p>
</div>
<div class="paragraph">
<p>For instance, consider a simple <a href="#SQL-Traverse"><code>TRAVERSE</code></a> statement, like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; TRAVERSE out('Friend') FROM (SELECT FROM Person WHERE name = 'John')
          WHILE $depth &lt; 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using a <a href="#SQL-Match"><code>MATCH</code></a> statement, you can write the same query as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, where: (name = 'John')}.both("Friend")
          {as: friend, while: ($depth &lt; 3)} RETURN friend</code></pre>
</div>
</div>
<div class="paragraph">
<p>Consider a case where you have a <code>since</code> date property on the edge <code>Friend</code>. You want to traverse the relationship only for edges where the <code>since</code> value is greater than a given date. In a <a href="#SQL-Traverse"><code>TRAVERSE</code></a> statement, you might write the query as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; TRAVERSE bothE('Friend')[since &gt; date('2012-07-02', 'yyyy-MM-dd')].bothV()
          FROM (SELECT FROM Person WHERE name = 'John') WHILE $depth &lt; 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unfortunately, this statement DOESN&#8217;T WORK in the current release. However, you can get the results you want using a <a href="#SQL-Match"><code>MATCH</code></a> statement:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, where: (name = 'John')}.(bothE("Friend")
          {where: (since &gt; date('2012-07-02', 'yyyy-MM-dd'))}.bothV())
		  {as: friend, while: ($depth &lt; 3)} RETURN friend</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Projections and Grouping Operations</strong></p>
</div>
<div class="paragraph">
<p>Projections and grouping operations are better expressed with a <a href="#SQL-Select"><code>SELECT</code></a> query. If you need to filter and do projection or aggregation in the same query, you can use <a href="#SQL-Select"><code>SELECT</code></a> and <a href="#SQL-Match"><code>MATCH</code></a> in the same statement.</p>
</div>
<div class="paragraph">
<p>This is particular important when you expect a result that contains attributes from different connected records (cartesian product). For instance, to retrieve names, their friends and the date since they became friends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT person.name AS name, friendship.since AS since, friend.name
          AS friend FROM (MATCH {type: Person, as: person}.bothE('Friend')
		  {as: friendship}.bothV(){as: friend,
		  where: ($matched.person != $currentMatch)}
		  RETURN person, friendship, friend)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same can be also achieved with the MATCH only:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; MATCH {type: Person, as: person}.bothE('Friend')
		  {as: friendship}.bothV(){as: friend,
		  where: ($matched.person != $currentMatch)}
		  RETURN person.name as name, friendship.since as since, friend.name as friend</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>RETURN expressions</strong></p>
</div>
<div class="paragraph">
<p>In the RETURN section you can use:</p>
</div>
<div class="paragraph">
<p><strong>multiple expressions</strong>, with or without an alias (if no alias is defined, ArcadeDB will generate a default alias for you), comma separated</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH
  {type: Person, as: person}
  .bothE('Friend'){as: friendship}
  .bothV(){as: friend, where: ($matched.person != $currentMatch)}
RETURN person, friendship, friend

result:

| person | friendship | friend |
--------------------------------
| #12:0  | #13:0      | #12:2  |
| #12:0  | #13:1      | #12:3  |
| #12:1  | #13:2      | #12:3  |</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH
  {type: Person, as: person}
  .bothE('Friend'){as: friendship}
  .bothV(){as: friend, where: ($matched.person != $currentMatch)}
RETURN person.name as name, friendship.since as since, friend.name as friend

result:

| name | since | friend |
-------------------------
| John | 2015  | Frank  |
| John | 2015  | Jenny  |
| Joe  | 2016  | Jenny  |</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH
  {type: Person, as: person}
  .bothE('Friend'){as: friendship}
  .bothV(){as: friend, where: ($matched.person != $currentMatch)}
RETURN person.name + " is a friend of " + friend.name as friends

result:

| friends                    |
------------------------------
| John is a friend of Frank  |
| John is a friend of Jenny  |
| Joe is a friend of Jenny   |</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>$matches</strong>, to return all the patterns that match current statement. Each row in the result set will be a single pattern, containing only nodes in the statement that have an <code>as:</code> defined</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH
  {type: Person, as: person}
  .bothE('Friend'){} // no 'as:friendship' in this case
  .bothV(){as: friend, where: ($matched.person != $currentMatch)}
RETURN $matches

result:

| person |  friend |
--------------------
| #12:0  |  #12:2  |
| #12:0  |  #12:3  |
| #12:1  |  #12:3  |</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>$paths</strong>, to return all the patterns that match current statement. Each row in the result set will be a single pattern, containing all th nodes in the statement. For nodes that have an <code>as:</code>, the alias will be returned, for the others a default alias is generated (automatically generated aliases start with <code>$ORIENT_DEFAULT_ALIAS_</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH
  {type: Person, as: person}
  .bothE('Friend'){} // no 'as:friendship' in this case
  .bothV(){as: friend, where: ($matched.person != $currentMatch)}
RETURN $paths

result:

| person | friend | $ORIENT_DEFAULT_ALIAS_0 |
---------------------------------------------
| #12:0  | #12:2  | #13:0                   |
| #12:0  | #12:3  | #13:1                   |
| #12:1  | #12:3  | #13:2                   |</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>$elements</strong> the same as <code>$matches</code>, but for each node present in the pattern, a single row is created in the result set (no duplicates)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH
  {type: Person, as: person}
  .bothE('Friend'){} // no 'as:friendship' in this case
  .bothV(){as: friend, where: ($matched.person != $currentMatch)}
RETURN $elements

result:

| @rid   |  @type | name   |  .....   |
----------------------------------------
| #12:0  |  Person | John   |  .....   |
| #12:1  |  Person | Joe    |  .....   |
| #12:2  |  Person | Frank  |  .....   |
| #12:3  |  Person | Jenny  |  .....   |</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>$pathElements</strong> the same as <code>$paths</code>, but for each node present in the pattern, a single row is created in the result set (no duplicates)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH
  {type: Person, as: person}
  .bothE('Friend'){} // no 'as:friendship' in this case
  .bothV(){as: friend, where: ($matched.person != $currentMatch)}
RETURN $pathElements

result:

| @rid   |  @type | name   | since  |  .....   |
-------------------------------------------------
| #12:0  |  Person | John   |        |  .....   |
| #12:1  |  Person | Joe    |        |  .....   |
| #12:2  |  Person | Frank  |        |  .....   |
| #12:3  |  Person | Jenny  |        |  .....   |
| #13:0  |  Friend |        |  2015  |  .....   |
| #13:1  |  Friend |        |  2015  |  .....   |
| #13:2  |  Friend |        |  2016  |  .....   |</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>IMPORTANT</strong>: When using MATCH statemet in ArcadeDB Studio Graph panel you have to use $elements or $pathElements as return type, to let the Graph panel render the matched patterns correctly</p>
</div>
<div class="paragraph">
<p><strong>Arrow notation</strong></p>
</div>
<div class="paragraph">
<p><code>out()</code>, <code>in()</code> and <code>both()</code> operators can be replaced with arrow notation <code>--&gt;</code>, <code>&lt;--</code> and <code>--</code></p>
</div>
<div class="paragraph">
<p>Eg. the query</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH {type: V, as: a}.out(){}.out(){}.out(){as:b}
RETURN a, b</code></pre>
</div>
</div>
<div class="paragraph">
<p>can be written as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH {type: V, as: a} --&gt; {} --&gt; {} --&gt; {as:b}
RETURN a, b</code></pre>
</div>
</div>
<div class="paragraph">
<p>Eg. the query (things that belong to friends)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH {type: Person, as: a}.out('Friend'){as:friend}.in('BelongsTo'){as:b}
RETURN a, b</code></pre>
</div>
</div>
<div class="paragraph">
<p>can be written as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH {type: Person, as: a}  -Friend-&gt; {as:friend} &lt;-BelongsTo- {as:b}
RETURN a, b</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using arrow notation the curly braces are mandatory on both sides. eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">MATCH {type: Person, as: a} --&gt; {} --&gt; {as:b} RETURN a, b  //is allowed

MATCH {type: Person, as: a} --&gt; --&gt; {as:b} RETURN a, b  //is NOT allowed

MATCH {type: Person, as: a}.out().out(){as:b} RETURN a, b  //is allowed

MATCH {type: Person, as: a}.out(){}.out(){as:b} RETURN a, b  //is allowed</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Negative (NOT) patterns</strong></p>
</div>
<div class="paragraph">
<p>Together with normal patterns, you can also define negative patterns. A result will be returned only if it also DOES NOT match any of the negative patterns, ie. if the result matches at least one of the negative patterns it won&#8217;t be returned.</p>
</div>
<div class="paragraph">
<p>As an example, consider the following problem: given a social network, choose a single person and return all the people that are friends of their friends, but that are not their direct friends.</p>
</div>
<div class="paragraph">
<p>The pattern can be calculated as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>MATCH
  {type:Person, as:a, where:(name = "John")} -FriendOf-&gt; {as:b} -FriendOf-&gt; {as:c},
  NOT {as:a} -FriendOf-&gt; {as:c}
RETURN c.name</pre>
</div>
</div>
<h3 id="_sql_rebuild_index" class="discrete">SQL - <code>REBUILD INDEX</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Rebuild-Index.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Rebuilds automatic indexes.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">REBUILD INDEX &lt;index-name&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;index-name&gt;</code></strong> It is the index name that you want to rebuild. Use <code>*</code> to rebuild all automatic indexes. Quote the index name
if it contains special characters like square brackets.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
During the rebuild, any idempotent queries made against the index, skip the index and perform sequential scans. This means
that queries run slower during this operation. Non-idempotent commands, such as <a href="#SQL-Insert"><code>INSERT</code></a>, <a href="#SQL-Update"><code>UPDATE</code></a>,
and <a href="#SQL-Delete"><code>DELETE</code></a> are blocked waiting until the indexes are rebuilt.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Rebuild an index on the <code>email</code> property on the type <code>Profile</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; REBUILD INDEX `Profile[email]`</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Rebuild all indexes:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; REBUILD INDEX *</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Create-Index"><code>CREATE INDEX</code></a></p>
</li>
<li>
<p><a href="#SQL-Drop-Index"><code>DROP INDEX</code></a></p>
</li>
<li>
<p><a href="#Indexes">Indexes</a></p>
</li>
</ul>
</div>
<h3 id="SQL-Select" class="discrete">SQL - <code>SELECT</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Select.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB supports the SQL language to execute queries against the database engine. For more information,
see <a href="#Filtering">operators</a> and <a href="#SQL-Functions">functions</a>. For more information on the differences between this
implementation and the SQL-92 standard, please refer to <a href="#SQL-Introduction">this</a> section.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT [ &lt;Projections&gt; ] [ FROM &lt;Target&gt; [ LET &lt;Assignment&gt;* ] ]
    [ WHERE &lt;Condition&gt;* ]
    [ GROUP BY &lt;Field&gt;* ]
    [ ORDER BY &lt;Fields&gt;* [ ASC|DESC ] * ]
    [ UNWIND &lt;Field&gt;* ]
    [ SKIP &lt;SkipRecords&gt; ]
    [ LIMIT &lt;MaxRecords&gt; ]
    [ TIMEOUT &lt;MilliSeconds&gt; [ &lt;STRATEGY&gt; ] ]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><a href="#SQL-Projections"><code>Projections</code></a></strong> Indicates the data you want to extract from the query as the result-set. Note: In
ArcadeDB, this variable is optional. In the projections you can define aliases for single fields, using the <code>AS</code> keyword; in
current release aliases cannot be used in the WHERE condition, GROUP BY and ORDER BY (they will be evaluated to null)</p>
</li>
<li>
<p><strong><code>FROM</code></strong> Designates the object to query. This can be a type, bucket, single <a href="#RID">RID</a>, set of <a href="#RID">RID</a> index values sorted
by ascending or descending key order.</p>
<div class="ulist">
<ul>
<li>
<p>When querying a type, for <code>&lt;target&gt;</code> use the type name.</p>
</li>
<li>
<p>When querying a bucket, for <code>&lt;target&gt;</code> use <code>BUCKET:&lt;bucket-name&gt;</code> (eg. <code>BUCKET:person</code>) or <code>BUCKET:&lt;bucket-id&gt;</code> (
eg. <code>BUCKET:12</code>). This causes the query to execute only on records in that bucket.</p>
</li>
<li>
<p>When querying record ID&#8217;s, you can specific one or a small set of records to query. This is useful when you need to specify a
starting point in navigating graphs.</p>
</li>
<li>
<p>To query the schema you can use:</p>
<div class="ulist">
<ul>
<li>
<p><code>select from schema:types</code> to retrieve the defined types</p>
</li>
<li>
<p><code>select from schema:indexes</code> to retrieve the defined indexes</p>
</li>
<li>
<p><code>select from schema:database</code> to retrieve information about database settings</p>
</li>
</ul>
</div>
</li>
<li>
<p>When querying indexes, use the following prefixes:</p>
<div class="ulist">
<ul>
<li>
<p><code>INDEXVALUES:&lt;index&gt;</code> and <code>INDEXVALUESASC:&lt;index&gt;</code> sorts values into an ascending order of index keys.</p>
</li>
<li>
<p><code>INDEXVALUESDESC:&lt;index&gt;</code> sorts the values into a descending order of index keys.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong><a href="#Filtering"><code>WHERE</code></a></strong> Designates conditions to filter the result-set.</p>
</li>
<li>
<p><strong><a href="#SQL-LET"><code>LET</code></a></strong> Binds context variables to use in projections, conditions or sub-queries.</p>
</li>
<li>
<p><strong><code>GROUP BY</code></strong> Designates field on which to group the result-set.</p>
</li>
<li>
<p><strong><code>ORDER BY</code></strong> Designates the field with which to order the result-set. Use the optional <code>ASC</code> and <code>DESC</code> operators to define the
direction of the order. The default is ascending. Additionally, if you are using a <a href="#SQL-Projections">projection</a>, you
need to include the <code>ORDER BY</code> field in the projection. Note that ORDER BY works only on projection fields (fields that are
returned to the result set) not on LET variables.</p>
</li>
<li>
<p><strong><a href="#SQL-Select-Unwind"><code>UNWIND</code></a></strong> Designates the field on which to unwind the collection.</p>
</li>
<li>
<p><strong><code>SKIP</code></strong> Defines the number of records you want to skip from the start of the result-set. You may find this useful in <a href="#SQL-Pagination">Pagination</a>, when using it in conjunction with <code>LIMIT</code>.</p>
</li>
<li>
<p><strong><code>LIMIT</code></strong> Defines the maximum number of records in the result-set. You may find this useful in <a href="#SQL-Pagination">Pagination</a>, when using it in conjunction with <code>SKIP</code>.</p>
</li>
<li>
<p><strong><code>TIMEOUT</code></strong> Defines the maximum time in milliseconds for the query. By default, queries have no timeouts. If you don&#8217;t specify a
timeout strategy, it defaults to <code>EXCEPTION</code>. These are the available timeout strategies:</p>
<div class="ulist">
<ul>
<li>
<p><code>RETURN</code> Truncate the result-set, returning the data collected up to the timeout.</p>
</li>
<li>
<p><code>EXCEPTION</code> Raises an exception.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Return all records of the type <code>Person</code>, where the name starts with <code>Luk</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM Person WHERE name LIKE 'Luk%'</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you might also use either of these queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT FROM Person WHERE name.left(3) = 'Luk'
ArcadeDB&gt; SELECT FROM Person WHERE name.substring(0,3) = 'Luk'</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return all records of the type <code>!AnimalType</code> where the collection <code>races</code> contains at least one entry where the first character
is <code>e</code>, ignoring case:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM animaltype WHERE races CONTAINS( name.toLowerCase().subString(
            0, 1) = 'e' )</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return all records of type <code>!AnimalType</code> where the collection <code>races</code> contains at least one entry with names <code>European</code>
or <code>Asiatic</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT * FROM animaltype WHERE races CONTAINS(name in ['European',
            'Asiatic'])</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return all records in the type <code>Profile</code> where any field contains the word <code>danger</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM Profile WHERE ANY() LIKE '%danger%'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return any record where up to the third level of connections has some field that contains the word <code>danger</code>, ignoring case:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM Profile WHERE ANY() TRAVERSE(0, 3) (
            ANY().toUpperCase().indexOf('danger') &gt; -1 )</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return all results on type <code>Profile</code>, ordered by the field <code>name</code> in descending order:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM Profile ORDER BY name DESC</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return the number of records in the type <code>Account</code> per city:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT SUM(*) FROM Account GROUP BY city</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Traverse records from a root node:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM #11:4 WHERE ANY() TRAVERSE(0,10) (address.city = 'Rome')</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return only a limited set of records:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM [#10:3, #10:4, #10:5]</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return three fields from the type <code>Profile</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT nick, followings, followers FROM Profile</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return the field <code>name</code> in uppercase and the field country name of the linked city of the address:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT name.toUppercase(), address.city.country.name FROM Profile</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return records from the type <code>Profile</code> in descending order of their creation:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM Profile ORDER BY @rid DESC</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Return value of <code>email</code> which is stored in a JSON field <code>data</code> (type EMBEDDED) of the type <code>Person</code>, where the name starts
with <code>Luk</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT data.email FROM Person WHERE name LIKE 'Luk%'</pre>
</div>
</div>
<div class="paragraph">
<p>ArcadeDB can open an inverse cursor against buckets. This is very fast and doesn&#8217;t require the typical ordering resources, CPU and
RAM.</p>
</div>
<div id="SQL-Select-Projections" class="paragraph">
<p><strong>Projections </strong></p>
</div>
<div class="paragraph">
<p>In the standard implementations of SQL, projections are mandatory. In ArcadeDB, the omission of projects translates to its returning
the entire record. That is, it reads no projection as the equivalent of the <code>*</code> wildcard.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT FROM Account</code></pre>
</div>
</div>
<div class="paragraph">
<p>For all projections except the wildcard <code>*</code>, it creates a new temporary document, which does not include the <code>@rid</code>
fields of the original record.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT name, age FROM Account</code></pre>
</div>
</div>
<div class="paragraph">
<p>The naming convention for the returned document fields are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Field name for plain fields, like <code>invoice</code> becoming <code>invoice</code>.</p>
</li>
<li>
<p>First field name for chained fields, like <code>invoice.customer.name</code> becoming <code>invoice</code>.</p>
</li>
<li>
<p>Function name for functions, like <code>MAX(salary)</code> becoming <code>max</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the event that the target field exists, it uses a numeric progression. For instance,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT MAX(incoming), MAX(cost) FROM Balance

------+------
 max  | max2
------+------
 1342 | 2478
------+------</code></pre>
</div>
</div>
<div class="paragraph">
<p>To override the display for the field names, use the <code>AS</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT MAX(incoming) AS max_incoming, MAX(cost) AS max_cost FROM Balance

---------------+----------
 max_incoming  | max_cost
---------------+----------
 1342          | 2478
---------------+----------</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the dollar sign <code>$</code>, you can access the context variables. Each time you run the command, ArcadeDB accesses the context to read
and write the variables. For instance, say you want to display the path and depth levels up to the fifth of a
<a href="#SQL-Traverse"><code>TRAVERSE</code></a> on all records in the <code>Movie</code> type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT $path, $depth FROM ( TRAVERSE * FROM Movie WHERE $depth &lt;= 5 )</code></pre>
</div>
</div>
<h4 id="SQL-LET" class="discrete"><code>LET</code> Block</h4>
<div class="paragraph">
<p>The <code>LET</code> block contains context variables to assign each time ArcadeDB evaluates a record. It destroys these values once the query
execution ends. You can use context variables in projections, conditions, and sub-queries.</p>
</div>
<div class="paragraph">
<p><strong>Assigning Fields for Reuse </strong></p>
</div>
<div class="paragraph">
<p>ArcadeDB allows for crossing relationships. In single queries, you need to evaluate the same branch of the nested relationship. This
is better than using a context variable that refers to the full relationship.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT FROM Profile WHERE address.city.name LIKE '%Saint%"' AND
          ( address.city.country.name = 'Italy' OR
            address.city.country.name = 'France' )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the <code>LET</code> makes the query shorter and faster, because it traverses the relationships only once:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT FROM Profile LET $city = address.city WHERE $city.name LIKE
          '%Saint%"' AND ($city.country.name = 'Italy' OR $city.country.name = 'France')</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, it traverses the path till <code>address.city</code> only once.</p>
</div>
<h4 id="_sub_query" class="discrete">Sub-query</h4>
<div class="paragraph">
<p>The <code>LET</code> block allows you to assign a context variable to the result of a sub-query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT FROM Document LET $temp = ( SELECT @rid, $depth FROM (TRAVERSE
          V.OUT, E.IN FROM $parent.current ) WHERE @type = 'Concept' AND
          ( id = 'first concept' OR id = 'second concept' )) WHERE $temp.SIZE() &gt; 0</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><code>LET</code> Block in Projection </strong></p>
</div>
<div class="paragraph">
<p>You can use context variables as part of a result-set in <a href="#SQL-Projections">projections</a>. For instance, the query below displays the
city name from the previous example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT $temp.name FROM Profile LET $temp = address.city WHERE $city.name
          LIKE '%Saint%"' AND ( $city.country.name = 'Italy' OR
          $city.country.name = 'France' )</code></pre>
</div>
</div>
<h4 id="SQL-Select-Unwind" class="discrete">Unwinding</h4>
<div class="paragraph">
<p>ArcadeDB allows unwinding of collection fields and obtaining multiple records as a result, one for each element in the collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT name, OUT("Friend").name AS friendName FROM Person

--------+-------------------
 name   | friendName
--------+-------------------
 'John' | ['Mark', 'Steve']
--------+-------------------</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the event if you want one record for each element in <code>friendName</code>, you can rewrite the query using <code>UNWIND</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT name, OUT("Friend").name AS friendName FROM Person UNWIND friendName

--------+-------------
 name   | friendName
--------+-------------
 'John' | 'Mark'
 'John' | 'Steve'
--------+-------------</code></pre>
</div>
</div>
<h3 id="_sql_select_statements_execution" class="discrete">SQL SELECT Statements Execution</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Select-Execution.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>The execution flow of a SELECT statement is made of many steps.
Understanding these steps will help you to write better and more optimized queries.</p>
</div>
<div class="paragraph">
<p>The SELECT query execution, at a very high level, is made of three steps:
- Query optimization
- Creation of execution plans
- Choice of the optimal execution plan
- Actual execution</p>
</div>
<h4 id="_query_optimization" class="discrete">Query optimization</h4>
<div class="paragraph">
<p>The first step for the query executor is to run a query optimizer. This operation can change the internal structure of the SQL statement to make it more efficient, preserving the same semantics of the original query.</p>
</div>
<div class="paragraph">
<p>Typical optimization steps are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Early calculation of expressions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>eg. consider the following statement</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Person WHERE fullName = "John" + " " + "Smith"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of the string concatenation <code>&quot;John&quot; + &quot; &quot; + &quot;Smith&quot;</code> does not depend on the query context (eg. the content of a record in the result set), so it can be calculated only once in the execution phase. The result of the optimization of this query will be the equivalent of</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Person WHERE fullName = "John Smith"</code></pre>
</div>
</div>
<h4 id="_early_calculation_of_sub_queries" class="discrete">Early calculation of sub-queries</h4>
<div class="paragraph">
<p>eg. consider the following statement</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Person WHERE father in (SELECT FROM Person WHERE name = 'John')</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of the subquery does not depend on the parent query context, so it can be executed only once, and then use the result as an argument for the parent query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">LET $a = (SELECT FROM Person WHERE name = 'John');
SELECT FROM Person WHERE father in $a</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible only if the subquery does not depend on the context of the parent query, so for example the following cannot be split:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Person WHERE father in (SELECT FROM Person WHERE name = 'John' and surname = $parent.$current.surname)</code></pre>
</div>
</div>
<h4 id="_refactoring_of_the_where_conditions" class="discrete">Refactoring of the WHERE conditions</h4>
<div class="paragraph">
<p>eg. consider the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Person
WHERE
(name = 'John' AND surname = 'Smith')
OR (name = 'John' AND surname = 'Doe')
OR (name = 'John' AND surname = 'Travolta')
OR (name = 'John' AND surname = 'Lennon')
OR (name = 'John' AND surname = 'Nash')</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the WHERE condition is evaluated as is, the condition <code>name = &#39;John&#39;</code> has to be evaluated five times for each record that does not have a 'John' as a name. This query can be rewritten as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM Person
WHERE
name = 'John' AND (
  surname = 'Smith'
  OR surname = 'Doe'
  OR surname = 'Travolta'
  OR surname = 'Lennon'
  OR surname = 'Nash'
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes, like in case of full type scan, this is convenient. In other cases it&#8217;s not. Eg. if <code>Person</code> type has an index on <code>&lt;name, surname&gt;</code>, the original query can be executed as the union of five index lookups. The query optimizer will create multiple versions of optimized conditions, for different execution plans (see below).</p>
</div>
<h4 id="_creation_of_execution_plans" class="discrete">Creation of execution plans</h4>
<div class="paragraph">
<p>An execution plan is a sequence of operations that the query engine has to execute to calculate the query result.</p>
</div>
<div class="paragraph">
<p>Each step in the execution plan typically does a single operation, eg. fetch data from a type, filter results, calculate projections and so on.</p>
</div>
<div class="paragraph">
<p>For the same query, ArcadeDB can calculate multiple execution plans, based on involvement of indexes, optimized sorting and so on.</p>
</div>
<div class="paragraph">
<p>An execution plan has an execution cost that depends on the number of processed records, the number of operations performed and the elaboration time. The query executor uses the execution cost as the main criterion to choose the optimal execution plan.</p>
</div>
<div class="paragraph">
<p><strong>Choice of the optimal execution plan</strong></p>
</div>
<div class="paragraph">
<p>If the query executor produces multiple execution plans, then it has to choose the more convenient one to actually execute the query.
This choice is made based on the execution cost: the execution plan with the minimum cost is chosen.</p>
</div>
<div class="paragraph">
<p><strong>Actual execution</strong></p>
</div>
<div class="paragraph">
<p>After choosing the optimal execution plan, it is just executed.</p>
</div>
<div class="paragraph">
<p>The execution of an execution plan is just the execution of all the steps that it represents.</p>
</div>
<div class="paragraph">
<p><strong>Query Execution Plan</strong></p>
</div>
<div class="paragraph">
<p>As described above, an execution plan is a sequence of steps that have to be executed to calculate a query result.</p>
</div>
<div class="paragraph">
<p>Different queries will have different execution plans.</p>
</div>
<div class="paragraph">
<p>The typical execution plan is made of the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>fetch from query target (that can be a type, a bucket, an index and so on)</p>
</li>
<li>
<p>evaluate LET expressions</p>
</li>
<li>
<p>calculate query projections</p>
</li>
<li>
<p>filter results</p>
</li>
<li>
<p>aggregate data (eg. aggregate functions + GROUP BY)</p>
</li>
<li>
<p><a href="#SQL-Select-Unwind"><code>UNWIND</code></a> projections</p>
</li>
<li>
<p>sort result (ORDER BY)</p>
</li>
<li>
<p>SKIP</p>
</li>
<li>
<p>LIMIT</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Obviously, a simple query like <code>SELECT FROM Person</code> will have a very simple execution plan made of a single step (the fetch from <code>Person</code> type), while a complex query will have an execution plan made of multiple steps</p>
</div>
<div class="paragraph">
<p>To display the execution plan of a query, without executing it, you can just execute the query prefixing it with <a href="#SQL-Explain"><code>EXPLAIN</code></a>, eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">EXPLAIN SELECT FROM Person</code></pre>
</div>
</div>
<h3 id="SQL-Pagination" class="discrete">Pagination</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Pagination.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB supports pagination natively. Pagination doesn&#8217;t consume server side resources because no cursors are used. Only <a href="#RID">Record ID&#8217;s</a> are used as pointers to the physical position in the bucket.</p>
</div>
<div class="paragraph">
<p>There are 2 ways to achieve pagination:</p>
</div>
<h4 id="_use_the_skip_limit" class="discrete">Use the SKIP-LIMIT</h4>
<div class="paragraph">
<p>The first and simpler way to do pagination is to use the <code>SKIP</code>/<code>LIMIT</code> approach. This is the slower way because ArcadeDB repeats the query and just skips the first X records from the result.
Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM &lt;target&gt; [WHERE ...] SKIP &lt;records-to-skip&gt; LIMIT &lt;max-records&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:
- <strong>records-to-skip</strong> is the number of records to skip before starting to collect them as the result set
- <strong>max-records</strong> is the maximum number of records returned by the query</p>
</div>
<h4 id="_use_the_rid_limit" class="discrete">Use the RID-LIMIT</h4>
<div class="paragraph">
<p>This method is faster than the <code>SKIP</code>-<code>LIMIT</code> because ArcadeDB will begin the scan from the starting RID. ArcadeDB can seek the first record in about O(1) time. The downside is that it&#8217;s more complex to use.</p>
</div>
<div class="paragraph">
<p>The trick here is to execute the query multiple times setting the <code>LIMIT</code> as the page size and using the greater than <code>&gt;</code> operator against <code>@rid</code>. The <strong>lower-rid</strong> is the starting point to search, for example <code>#10:300</code>.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT FROM &lt;target&gt; WHERE @rid &gt; &lt;lower-rid&gt; ... [LIMIT &lt;max-records&gt;]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:
- <strong>lower-rid</strong> is the exclusive lower bound of the range as <a href="#RID">RID</a>
- <strong>max-records</strong> is the maximum number of records returned by the query</p>
</div>
<div class="paragraph">
<p>In this way, ArcadeDB will start to scan the bucket from the given position <strong>lower-rid</strong> + 1. After the first call, the <strong>lower-rid</strong> will be the rid of the last record returned by the previous call. To scan the cluster from the beginning, use <code>#-1:-1</code> as <strong>lower-rid</strong> .</p>
</div>
<h3 id="SQL-Traverse" class="discrete">SQL - <code>TRAVERSE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Traverse.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Retrieves connected records crossing relationships. This works with both the Document and Graph API&#8217;s, meaning that you can traverse relationships between say invoices and customers on a graph, without the need to model the domain using the Graph API.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In many cases, you may find it more efficient to use <a href="#SQL-Select"><code>SELECT</code></a>, which can result in shorter and faster queries. For more information, see <a href="#traverse-versus-select"><code>TRAVERSE</code> versus <code>SELECT</code></a> below.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">TRAVERSE [&lt;type.]field&gt;|*|any()|all()
         [FROM &lt;target&gt;]
         [
           MAXDEPTH &lt;number&gt;
           |
           WHILE &lt;condition&gt;
         ]
         [LIMIT &lt;max-records&gt;]
         [STRATEGY &lt;strategy&gt;]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#fields"><code>&lt;fields&gt;</code></a> Defines the fields you want to traverse.</p>
</li>
<li>
<p><a href="#target"><code>&lt;target&gt;</code></a> Defines the target you want to traverse. This can be a type, one or more buckets, a single Record ID, set of Record ID&#8217;s, or a sub-query.</p>
</li>
<li>
<p><strong><code>MAXDEPTH</code></strong> Defines the maximum depth of the traversal. <code>0</code> indicates that you only want to traverse the root node. Negative values are invalid.</p>
</li>
<li>
<p><strong><code>WHILE</code></strong> Defines the condition for continuing the traversal while it is true.</p>
</li>
<li>
<p><strong><code>LIMIT</code></strong> Defines the maximum number of results the command can return.</p>
</li>
<li>
<p><a href="#_traversal-strategies"><code>STRATEGY</code></a> Defines strategy for traversing the graph.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The use of the <a href="#Filtering"><code>WHERE</code></a> clause has been deprecated for this command.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There is a difference between <code>MAXDEPTH N</code> and <code>WHILE DEPTH &lt;= N</code>: the <code>MAXDEPTH</code> will evaluate exactly N levels, while the <code>WHILE</code> will evaluate N+1 levels and will discard the N+1th, so the <code>MAXDEPTH</code> in general has better performance.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="paragraph">
<p>In a social network-like domain, a user profile is connected to friend through links. The following examples consider common operations on a user with the record ID <code>#10:1234</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Traverse all fields in the root record:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; TRAVERSE * FROM #10:1234</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify fields and depth up to the third level, using the <a href="#Traversal-Strategies"><code>BREADTH_FIRST</code></a> strategy:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; TRAVERSE out("Friend") FROM #10:1234 MAXDEPTH 3
            STRATEGY BREADTH_FIRST</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute the same command, this time filtering for a minimum depth to exclude the first target vertex:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM (TRAVERSE out("Friend") FROM #10:1234 MAXDEPTH 3)
            WHERE $depth &gt;= 1</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also define the maximum depth in the <a href="#SQL-Select"><code>SELECT</code></a> command, but it&#8217;s much more efficient to set it at the inner <a href="#SQL-Traverse"><code>TRAVERSE</code></a> statement because the returning record sets are already filtered by depth.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Combine traversal with <a href="#SQL-Select"><code>SELECT</code></a> command to filter the result-set. Repeat the above example, filtering for users in Rome:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM (TRAVERSE out("Friend") FROM #10:1234 MAXDEPTH 3)
            WHERE city = 'Rome'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Extract movies of actors that have worked, at least once, in any movie produced by J.J. Abrams:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT FROM (TRAVERSE out("Actors"), out("Movies") FROM (SELECT FROM
            Movie WHERE producer = "J.J. Abrams") MAXDEPTH 3) WHERE
            @type = 'Movie'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Display the current path in the traversal:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT $path FROM ( TRAVERSE out() FROM V MAXDEPTH 10 )</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Supported Variables</strong></p>
</div>
<div class="paragraph">
<p><strong>Fields</strong></p>
</div>
<div class="paragraph">
<p>Defines the fields that you want to traverse. If set to <code>*</code>, <code>any()</code> or <code>all()</code> then it traverses all fields. This can prove costly to performance and resource usage, so it is recommended that you optimize the command to only traverse the pertinent fields.</p>
</div>
<div class="paragraph">
<p>In addition to his, you can specify the fields at a type-level. <a href="#Inheritance">Inheritance</a> is supported. By specifying <code>Person.city</code> and the type <code>Customer</code> extends person, you also traverse fields in <code>Customer</code>.</p>
</div>
<div class="paragraph">
<p>Field names are case-sensitive, types not.</p>
</div>
<div class="paragraph">
<p><strong>Target</strong></p>
</div>
<div class="paragraph">
<p>Targets for traversal can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines the type that you want to traverse.</p>
</li>
<li>
<p><strong><code>BUCKET:&lt;bucket&gt;</code></strong> Defines the bucket you want to traverse.</p>
</li>
<li>
<p><strong><code>&lt;record-id&gt;</code></strong> Individual root Record ID that you want to traverse.</p>
</li>
<li>
<p><strong><code>[&lt;record-id&gt;,&lt;record-id&gt;,&#8230;&#8203;]</code></strong> Set of Record ID&#8217;s that you want to traverse. This is useful when navigating graphs starting from the same root nodes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Context Variables</strong></p>
</div>
<div class="paragraph">
<p>In addition to the above, you can use the following context variables in traversals:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>$parent</code></strong> Gives the parent context, if any. You may find this useful when traversing from a sub-query.</p>
</li>
<li>
<p><strong><code>$current</code></strong> Gives the current record in the iteration. To get the upper-level record in nested queries, you can use <code>$parent.$current</code>.</p>
</li>
<li>
<p><strong><code>$depth</code></strong> Gives the current depth of nesting.</p>
</li>
<li>
<p><strong><code>$path</code></strong> Gives a string representation of the current path. For instance, <code>#5:0.out</code>. You can also display it through <a href="#SQL-Select"><code>SELECT</code></a>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; SELECT $path FROM (TRAVERSE * FROM V)</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Use Cases</strong></p>
</div>
<div id="traverse-versus-select" class="paragraph">
<p><strong><code>TRAVERSE</code> versus <code>SELECT</code></strong></p>
</div>
<div class="paragraph">
<p>When you already know traversal information, such as relationship names and depth-level, consider using <a href="#SQL-Select"><code>SELECT</code></a> instead of <a href="#SQL-Traverse"><code>TRAVERSE</code></a> as it is faster in some cases.</p>
</div>
<div class="paragraph">
<p>For example, this query traverses the <code>follow</code> relationship on Twitter accounts, getting the second level of friendship:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT FROM (TRAVERSE out('follow') FROM TwitterAccounts MAXDEPTH 2 )
          WHERE $depth = 2</code></pre>
</div>
</div>
<div class="paragraph">
<p>But, you could also express this same query using <a href="#SQL-Select"><code>SELECT</code></a> operation, in a way that is also shorter and faster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT out('follow').out('follow') FROM TwitterAccounts</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><code>TRAVERSE</code> with the Graph Model and API</strong></p>
</div>
<div class="paragraph">
<p>While you can use the <a href="#SQL-Traverse"><code>TRAVERSE</code></a> command with any domain model, it provides the greatest utility with the <a href="#Graph-Model">Graph Model</a>.</p>
</div>
<div class="paragraph">
<p>This model is based on the concepts of the Vertex (or Node) and the Edge (or Arc, Connection, Link, etc.) If you want to traverse in a direction, you have to use the type name when declaring the traversing fields. The supported directions are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Vertex to outgoing edges</strong> Using <code>outE()</code> or <code>outE(&#39;EdgeTypeName&#39;)</code>. That is, going out from a vertex and into the outgoing edges.</p>
</li>
<li>
<p><strong>Vertex to incoming edges</strong> Using <code>inE()</code> or <code>inE(&#39;EdgeTypeName&#39;)</code>. That is, going from a vertex and into the incoming edges.</p>
</li>
<li>
<p><strong>Vertex to all edges</strong> Using <code>bothE()</code> or <code>bothE(&#39;EdgeTypeName&#39;)</code>. That is, going from a vertex and into all the connected edges.</p>
</li>
<li>
<p><strong>Edge to Vertex (end point)</strong> Using <code>inV()</code> . That is, going out from an edge and into a vertex.</p>
</li>
<li>
<p><strong>Edge to Vertex (starting point)</strong> Using <code>outV()</code> . That is, going back from an edge and into a vertex.</p>
</li>
<li>
<p><strong>Edge to Vertex (both sizes)</strong> Using <code>bothV()</code> . That is, going from an edge and into connected vertices.</p>
</li>
<li>
<p><strong>Vertex to Vertex (outgoing edges)</strong> Using <code>out()</code> or <code>out(&#39;EdgeTypeName&#39;)</code>. This is the same as <code>outE().inV()</code></p>
</li>
<li>
<p><strong>Vertex to Vertex (incoming edges)</strong> Using <code>in()</code> or <code>in(&#39;EdgeTypeName&#39;)</code>. This is the same as <code>outE().inV()</code></p>
</li>
<li>
<p><strong>Vertex to Vertex (all directions)</strong> Using <code>both()</code> or <code>both(&#39;EdgeTypeName&#39;)</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For instance, traversing outgoing edges on the record <code>#10:3434</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; TRAVERSE out() FROM #10:3434</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a domain for emails, to find all messages sent on January 1, 2012 from the user Luca, assuming that they are stored in the vertex type <code>User</code> and that the messages are contained in the vertex type <code>Message</code>. Sent messages are stored as <code>out</code> connections on the edge type <code>SentMessage</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ArcadeDB&gt; SELECT FROM (TRAVERSE outE(), inV() FROM (SELECT FROM User WHERE
          name = 'Luca') MAXDEPTH 2 AND (@type = 'Message' or
          (@type = 'SentMessage' AND sentOn = '01/01/2012') )) WHERE
          @type = 'Message'</code></pre>
</div>
</div>
<h3 id="SQL-Truncate-Bucket" class="discrete">SQL - <code>TRUNCATE BUCKET</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Truncate-Bucket.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Deletes all records of a bucket. This command operates at a lower level than the standard <a href="#SQL-Delete"><code>DELETE</code></a> command.</p>
</div>
<div class="paragraph">
<p>Truncation is not permitted on vertex or edge types, but you can force its execution using the <code>UNSAFE</code> keyword. Forcing truncation is strongly discouraged, as it can leave the graph in an inconsistent state.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>TRUNCATE BUCKET &lt;bucket&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;bucket&gt;</code></strong> Defines the bucket to delete.</p>
</li>
<li>
<p><strong><code>UNSAFE</code></strong> Defines whether the command forces the truncation on vertex or edge types.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove all records in the bucket <code>profile</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; TRUNCATE BUCKET profile</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Delete"><code>DELETE</code></a></p>
</li>
<li>
<p><a href="#SQL-Truncate-Type"><code>TRUNCATE TYPE</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Truncate-Type" class="discrete">SQL - <code>TRUNCATE TYPE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Truncate-Type.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Deletes records of all buckets defined as part of the type.</p>
</div>
<div class="paragraph">
<p>By default, every type has an associated bucket with the same name. This command operates at a lower level than <a href="#SQL-Delete"><code>DELETE</code></a>. This commands ignores sub-types, (That is, their records remain in their buckets). If you want to also remove all records from the type hierarchy, you need to use the <code>POLYMORPHIC</code> keyword.</p>
</div>
<div class="paragraph">
<p>Truncation is not permitted on vertex or edge types, but you can force its execution using the <code>UNSAFE</code> keyword. Forcing truncation is strongly discouraged, as it can leave the graph in an inconsistent state.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>TRUNCATE TYPE &lt;type&gt; [ POLYMORPHIC ] [ UNSAFE ]</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;type&gt;</code></strong> Defines the type you want to truncate.</p>
</li>
<li>
<p><strong><code>POLYMORPHIC</code></strong> Defines whether the command also truncates the type hierarchy.</p>
</li>
<li>
<p><strong><code>UNSAFE</code></strong> Defines whether the command forces the truncation on vertex or edge types.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove all records of the type <code>Profile</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; TRUNCATE TYPE Profile</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Delete"><code>DELETE</code></a></p>
</li>
<li>
<p><a href="#SQL-Truncate-Bucket"><code>TRUNCATE BUCKET</code></a></p>
</li>
<li>
<p><a href="#SQL-Create-Type"><code>CREATE TYPE</code></a></p>
</li>
</ul>
</div>
<h3 id="SQL-Update" class="discrete">SQL - <code>UPDATE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Update.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Update one or more records in the current database. Remember: ArcadeDB can work in schema-less mode, so you can create any field on-the-fly. Furthermore, the command also supports extensions to work on collections.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">UPDATE &lt;type&gt;|BUCKET:&lt;bucket&gt;|&lt;recordID&gt;
  [SET|REMOVE &lt;field-name&gt; = &lt;field-value&gt;[,]*]|[CONTENT|MERGE &lt;JSON&gt;]
  [UPSERT]
  [RETURN &lt;returning&gt; [&lt;returning-expression&gt;]]
  [WHERE &lt;conditions&gt;]
  [LIMIT &lt;max-records&gt;] [TIMEOUT &lt;MilliSeconds&gt;]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>SET</code></strong> Defines the fields to update.</p>
</li>
<li>
<p><strong><code>REMOVE</code></strong> Removes an item in collection and map fields.</p>
</li>
<li>
<p><strong><code>CONTENT</code></strong> Replaces the record content with a JSON document.</p>
</li>
<li>
<p><strong><code>MERGE</code></strong> Merges the record content with a JSON document.</p>
</li>
<li>
<p><strong><code>UPSERT</code></strong> Updates a record if it exists or inserts a new record if it doesn&#8217;t. This avoids the need to execute two commands, (one for each condition, inserting and updating).
<code>UPSERT</code> requires a <a href="#Filtering"><code>WHERE</code></a> clause and a type target. There are further limitations on <code>UPSERT</code>, explained below.
Practically <code>UPSERT</code> means: <code>UPDATE</code> if the <code>WHERE</code> condition is fulfilled, otherwise <code>INSERT</code>.</p>
</li>
<li>
<p><strong><code>RETURN</code></strong> Specifies an expression to return instead of the record and what to do with the result-set returned by the expression. The available return operators are:</p>
<div class="ulist">
<ul>
<li>
<p><code>COUNT</code> Returns the number of updated records. This is the default return operator.</p>
</li>
<li>
<p><code>BEFORE</code> Returns the records before the update.</p>
</li>
<li>
<p><code>AFTER</code> Return the records after the update.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#Filtering"><code>WHERE</code></a> Defines the subset of records to be updated.</p>
</li>
<li>
<p><code>LIMIT</code> Defines the maximum number of records to update.</p>
</li>
<li>
<p><code>TIMEOUT</code> Defines the time you want to allow the update run before it times out.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Update to change the value of a field:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Profile SET nick = 'Luca' WHERE nick IS NULL

  Updated 2 record(s) in 0.008000 sec(s).</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Update to remove a field from all records:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Profile REMOVE nick</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Update to remove a value from a collection, if you know the exact value that you want to remove:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Remove an element from a link list or set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Account REMOVE address = #12:0</pre>
</div>
</div>
<div class="paragraph">
<p>Remove an element from a list or set of strings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Account REMOVE addresses = 'Foo'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Update to remove a value, filtering on value attributes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Remove addresses based in the city of Rome:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Account REMOVE addresses = addresses[city = 'Rome']</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Update to remove a value, filtering based on position in the collection.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Account REMOVE addresses = addresses[1]</pre>
</div>
</div>
<div class="paragraph">
<p>This remove the second element from a list, (position numbers start from <code>0</code>, so <code>addresses[1]</code> is the second elelment).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Update to remove a value from a map</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Account REMOVE addresses = 'Luca'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Update an embedded document. The <a href="#SQL-Update"><code>UPDATE</code></a> command can take JSON as a value to update.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Account SET address={ "street": "Melrose Avenue", "city": {
            "name": "Beverly Hills" } }</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Update the first twenty records that satisfy a condition:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Profile SET nick = 'Luca' WHERE nick IS NULL LIMIT 20</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Update a record or insert if it doesn&#8217;t already exist:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Profile SET nick = 'Luca' UPSERT WHERE nick = 'Luca'</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Updates using the <code>RETURN</code> keyword:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE ♯7:0 SET gender='male' RETURN AFTER @rid
ArcadeDB&gt; UPDATE ♯7:0 SET gender='male' RETURN AFTER @this
ArcadeDB&gt; UPDATE ♯7:0 SET gender='male' RETURN AFTER $current.exclude("really_big_field")</pre>
</div>
</div>
<div class="paragraph">
<p>In the event that a single field is returned, ArcadeDB wraps the result-set in a record storing the value in the field <code>result</code>. This avoids introducing a new serialization, as there is no primitive values collection serialization in the binary protocol. Additionally, it provides useful fields like <code>version</code> and <code>rid</code> from the original record in corresponding fields. The new syntax allows for optimization of client-server network traffic.</p>
</div>
<div class="paragraph">
<p>For more information on SQL syntax, see <a href="#SQL-Select"><code>SELECT</code></a>.</p>
</div>
<div class="paragraph">
<p><strong>Limitations of the <code>UPSERT</code> Clause</strong></p>
</div>
<div class="paragraph">
<p>The <code>UPSERT</code> clause only guarantees atomicity when you use a <code>UNIQUE</code> index and perform the look-up on the index through the <a href="#Filtering"><code>WHERE</code></a> condition.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB&gt; UPDATE Client SET id = 23 UPSERT WHERE id = 23</pre>
</div>
</div>
<div class="paragraph">
<p>Here, you must have a unique index on <code>Client.id</code> to guarantee uniqueness on concurrent operations.</p>
</div>
<h3 id="SQL-Profile" class="discrete">SQL - <code>PROFILE</code></h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Profile.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>PROFILE SQL command returns information about query execution planning and statistics for a specific statement.
The statement is actually executed to provide the execution stats.</p>
</div>
<div class="paragraph">
<p>The result is the execution plan of the query (like for <a href="#SQL-Explain">EXPLAIN</a> ) with additional information about execution time spent on each step, in microseconds.</p>
</div>
<div class="paragraph">
<p><strong>Syntax</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>PROFILE &lt;command&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;command&gt;</code></strong> Defines the command that you want to profile, eg. a SELECT statement</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">PROFILE SELECT sum(Amount), OrderDate
FROM Orders
WHERE OrderDate &gt; date("2012-12-09", "yyyy-MM-dd")
GROUP BY OrderDate</code></pre>
</div>
</div>
<div class="paragraph">
<p>result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>+ FETCH FROM INDEX Orders.OrderDate (1.445μs)
  OrderDate &gt; date("2012-12-09", "yyyy-MM-dd")
+ EXTRACT VALUE FROM INDEX ENTRY
+ FILTER ITEMS BY TYPE
  Orders
+ CALCULATE PROJECTIONS (5.065μs)
  Amount AS _$$$OALIAS$$_1, OrderDate
+ CALCULATE AGGREGATE PROJECTIONS (3.182μs)
  sum(_$$$OALIAS$$_1) AS _$$$OALIAS$$_0, OrderDate
  GROUP BY OrderDate
+ CALCULATE PROJECTIONS (1.116μs)
  _$$$OALIAS$$_0 AS `sum(Amount)`, OrderDate</pre>
</div>
</div>
<div class="paragraph">
<p>You can see the <code>(1.445μs)</code> at the end of the first line, it means that fetching from index <code>Orders.OrderDate</code> took 1.445 microseconds (1.4 milliseconds)</p>
</div>
<div class="paragraph">
<p>For more information, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#SQL-Explain">EXPLAIN</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="SQL-Batch">8.5. Batch</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/sql/SQL-Batch.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB allows execution of arbitrary scripts written in Javascript or any scripting language installed in the JVM. ArcadeDB supports a minimal SQL engine to allow a batch of commands.</p>
</div>
<div class="paragraph">
<p>Batch of commands are very useful when you have to execute multiple things at the server side avoiding the network roundtrip for each command.</p>
</div>
<div class="paragraph">
<p>SQL Batch supports all the ArcadeDB <a href="#SQL-Commands">SQL Commands</a>, plus the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BEGIN [isolation &lt;isolation-level&gt;]</code>, where <code>&lt;isolation-level&gt;</code> can be <code>READ_COMMITTED</code>, <code>REPEATABLE_READ</code>. By default is <code>READ_COMMITTED</code></p>
</li>
<li>
<p><code>COMMIT [retry &lt;retry&gt;]</code>, where:</p>
<div class="ulist">
<ul>
<li>
<p><code>&lt;retry&gt;</code> is the number of retries in case of concurrent modification exception</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>LET &lt;variable&gt; = &lt;SQL&gt;</code>, to assign the result of a SQL command to a variable. To reuse the variable prefix it with the dollar sign <code>$</code>.</p>
</li>
<li>
<p><code>IF(&lt;condition&gt;){ &lt;statememt&gt;; [&lt;statement&gt;;]* }</code>. Look at <a href="#Conditional-Execution">conditional execution</a>.</p>
</li>
<li>
<p><code>WHILE(&lt;condition&gt;){ &lt;statememt&gt;; [&lt;statement&gt;;]* }</code>. Look at <a href="#Loops">loop</a>.</p>
</li>
<li>
<p><code>FOREACH(&lt;variable&gt; IN &lt;expression&gt;){ &lt;statememt&gt;; [&lt;statement&gt;;]* }</code>. Look at <a href="#Loops">loops</a>.</p>
</li>
<li>
<p><code>SLEEP &lt;ms&gt;</code>, put the batch in wait for <code>&lt;ms&gt;</code> milliseconds.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><code>RETURN &lt;value&gt;</code>, where <code>value</code> can be:</p>
<div class="ulist">
<ul>
<li>
<p>any value. Example: <code>return 3</code></p>
</li>
<li>
<p>any variable with <code>$</code> as prefix. Example: <code>return $a</code></p>
</li>
<li>
<p>arrays (HTTP protocol only, see below). Example: <code>return [ $a, $b ]</code></p>
</li>
<li>
<p>maps (HTTP protocol only, see below). Example: <code>return { &#39;first&#39; : $a, &#39;second&#39; : $b }</code></p>
</li>
<li>
<p>a query. Example: <code>return (SELECT FROM Foo)</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
to return arrays and maps (eg. Java or Node.js driver) it&#8217;s strongly recommended using a RETURN SELECT, eg.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>RETURN (SELECT $a as first, $b as second)</pre>
</div>
</div>
<div class="paragraph">
<p>This will work on any protocol and driver.</p>
</div>
<div class="paragraph">
<p><strong>Optimistic transaction</strong></p>
</div>
<div class="paragraph">
<p>Example to create a new vertex in a <a href="#Transactions">Transactions</a> and attach it to an existent vertex by creating a new edge between them. If a concurrent modification occurs, repeat the transaction up to 100 times:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">begin;
let account = create vertex Account set name = 'Luke';
let city = select from City where name = 'London';
let e = create edge Lives from $account to $city;
commit retry 100;
return $e;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the usage of <code>$account</code> and <code>$city</code> in further SQL commands.</p>
</div>
<div id="Conditional-Execution" class="paragraph">
<p><strong>Conditional execution</strong>
SQL Batch provides IF constructor to allow conditional execution.
The syntax is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">IF( &lt;sql-predicate&gt; ){
   &lt;statement&gt;;
   &lt;statement&gt;;
   ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>&lt;sql-predicate&gt;</code> is any valid SQL predicate (any condition that can be used in a <code>WHERE</code> clause).
In current release it&#8217;s mandatory to have <code>IF(){</code>, <code>&lt;statement&gt;</code> and <code>}</code> on separate lines, eg. the following is not a valid script</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">if( $a.size() &gt; 0 ) {
  ROLLBACK;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The right syntax is following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">IF( $a.size() &gt; 0 ) {
  ROLLBACK;
}</code></pre>
</div>
</div>
<div id="Loops" class="paragraph">
<p><strong>Loops</strong></p>
</div>
<div class="paragraph">
<p>SQL Batch provides two different loop blocks: <code>FOREACH</code> and <code>WHILE</code></p>
</div>
<h4 id="_foreach" class="discrete">FOREACH</h4>
<div class="paragraph">
<p>Loops on all the items of a collection and, for each of them, executes a set of SQL statements</p>
</div>
<div class="paragraph">
<p>The syntax is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">FOREACH( &lt;variable&gt; IN &lt;expression&gt; ){
   &lt;statement&gt;;
   &lt;statement&gt;;
   ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">FOREACH( $i IN [1, 2, 3] ){
  INSERT INTO Foo SET value = $i;
}</code></pre>
</div>
</div>
<h4 id="_while" class="discrete">WHILE</h4>
<div class="paragraph">
<p>Loops while a condition is true</p>
</div>
<div class="paragraph">
<p>The syntax is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">WHILE( &lt;condition&gt; ){
   &lt;statement&gt;;
   &lt;statement&gt;;
   ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">LET $i = 0;
WHILE ($i &lt; 10){
  INSERT INTO Foo SET value = $i;
  LET $i = $i + 1;
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Security">9. Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ArcadeDB manages the security at server level only.
This means if you work in embedded mode, there is no security available by default unless you install the server security or your own implementation.
Without any kind of security active, any user can read and write in the database.
For this reason it&#8217;s important your application is managing security and profiling.
You can work in embedded mode and still run a <code>ArcadeDBServer</code> instance to use the security for the incoming connections.</p>
</div>
<div class="sect2">
<h3 id="Security-Policy">9.1. Security Policy</h3>
<div class="paragraph">
<p>The default rules of security are pretty basic.
The username must be between 4 and 256 characters.
The password length must be between 8 and 256 characters.
You can implement your own security policy by providing your own implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">server.getSecurity().setCredentialsValidator( new DefaultCredentialsValidator(){
  @Override
  public void validateCredentials(final String userName, final String userPassword) throws ServerSecurityException {
    if( userPassword.equals("12345678")
      throw new ServerSecurityException("Guess who was not attending security lesson!");
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Users">9.2. Users</h3>
<div class="paragraph">
<p>Users are stored in the file <code>config/server-users.jsonl</code> file.
The JSONL format means one json per line.
When the server starts always checks if there are any users configured.
If the user file is empty, the <code>root</code> user is created with a password the user must enter in the console where the server is starting.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">+--------------------------------------------------------------------+
|                WARNING: FIRST RUN CONFIGURATION                    |
+--------------------------------------------------------------------+
| This is the first time the server is running. Please type a        |
| password of your choice for the 'root' user or leave it blank      |
| to auto-generate it.                                               |
|                                                                    |
| To avoid this message set the environment variable or JVM          |
| setting `arcadedb.server.rootPassword` to the root password to use.|
+--------------------------------------------------------------------+

Root password [BLANK=auto generate it]: ***********
Please type the root password for confirmation (copy and paste will not work): ***********</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example of <code>config/server-users.jsonl</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{"name":"root","password":"PBKDF2WithHmacSHA256$65536$hcv0joKV/o/q+KOVmcwNUqhEq1w2/j8OVnEkkVjzkeg=$2q2u4rjUlJjgoKBX9sG0rV0bOh6aHo+RhHsOkXneGkM=","databases":{"*":["admin"]}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the users file the following information are stored per user:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Name, mandatory</p>
</li>
<li>
<p>Password.
It is always saved hashed by using the algorithm <code>PBKDF2</code> with a configurable salt (default = 32).
The password is mandatory for all the users, but root.
In the case root has no password, then ArcadeDB server asks to insert a password at startup (see above).</p>
</li>
<li>
<p>Databases, as the map database name and set of groups for that database. "*" is a special wildcard and means any.
The configuration <code>"databases":{"*":["admin"]}</code> means use the "admin" group for any database.</p>
</li>
</ul>
</div>
<div class="literalblock">
<div class="content">
<pre>                           +-----------------+ Any Database
 +-------------+           | +-------------+ |
 |    root     |------------&gt;|    admin    | |
 |             |           | |             | |
 |   (User)    |  belongsTo| |   (Group)   | |
 +-------------+           | +-------------+ |
                           +-----------------+</pre>
</div>
</div>
<div class="paragraph">
<p>ArcadeDB allows each user to belong to zero or multiple groups.
If no groups are defined, the default setting for the group <code>*</code> are used.</p>
</div>
<div class="paragraph">
<p>The following configuration defines "Jay" user to belong to "BlogWriters" in "Blog" database and "Editors" in the "Library" database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "databases": {
    "Blog": ["BlogWriters"],
    "Library": ["Editors"]
  }
}</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>                           +--------------------+ Blog Database
 +-------------+           |   +-------------+  |
 |    Jay      |--------------&gt;| BlogWriters |  |
 |             |           |   |             |  |
 |   (User)    | belongsTo |   |   (Group)   |  |
 +-------------+           |   +-------------+  |
        |                  +--------------------+
        |
        |                  +--------------------+ Library Database
        |                  |   +-------------+  |
        |  belongsTo       |   |   Editors   |  |
        +---------------------&gt;|             |  |
                           |   |   (Group)   |  |
                           |   +-------------+  |
                           +--------------------+</pre>
</div>
</div>
<div class="paragraph">
<p>The declaration above implicitly assigns Jay to the default group for any other database configured.
The default configuration for the default group is no access, where the user cannot read or write in the database.</p>
</div>
<h4 id="_via_console" class="discrete">Via Console</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Alternatively, users can be created via the console, see <code>Create User</code> <a href="#Console">Console Command</a> and <a href="#HTTP-ServerCommand">Server Command</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Groups">9.3. Groups</h3>
<div class="paragraph">
<p>If a user has not assigned group in a database, the default group &#8220;*&#8221; is taken.
The wildcard &#8220;*&#8221; represents all the groups that are not defined in this configuration.
By default, such a group has no access to the database in read and write.
Below you can find the default configuration for the default group &#8220;*&#8221;.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "*": {
  "types": {"*": {"access": []}},
  "access": [],
  "readTimeout": -1,
  "resultSetLimit": -1
} }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>types</code> is the map of type and access level.
The wildcard &#8220;*&#8221; represents all the types that are not defined in this configuration.</p>
</li>
<li>
<p><code>access</code> is the array containing the allowed permissions for the group.
The supported permission at group level are:</p>
<div class="ulist">
<ul>
<li>
<p><code>updateSecurity</code>: to update the security settings (create, modify and delete users, groups, etc.)</p>
</li>
<li>
<p><code>updateSchema</code>: to update the database schema (create, modify and drop buckets, types and indexes)</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>readTimeout</code> if present, specify the maximum timeout for read operations. -1 means no limits.
If set, all the read operations (lookups and queries) will be limited to maximum <code>&lt;readTimeout&gt;</code> milliseconds.
This is useful to limit users to execute expensive commands and queries impacting the performance of the server and therefore other connected users.</p>
</li>
<li>
<p><code>resultSetLimit</code> if present, specify the maximum number of entries in the result set returning from a command or query. -1 means no limits.
If set, any query or command will be interrupted when this limit is reached.
This is useful to limit users to retrieve huge result sets impacting the performance of the server and therefore other connected users.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can profile the access of each group up to the type level.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>createRecord</code>, allows creating new records</p>
</li>
<li>
<p><code>readRecord</code>, allows reading records</p>
</li>
<li>
<p><code>updateRecord</code>, allows updating records</p>
</li>
<li>
<p><code>deleteRecord</code>, allows deleting records</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
creating an edge is technically 2 operations: (1) create a new edge record and (2) update the vertices with the reference.
For this reason, if you want to allow a user to create edges, you have to grant the <code>createRecord</code> permission on the edge type and <code>updateRecord</code> on the vertex type.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Example of the definition of the group for a Blog writer, where he can only read from the "Blog" type and have full access to the "Post" type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "types": {
    "*": {
      "access": []
    },
    "Blog": {
      "access": [
        "readRecord"
      ]
    },
    "Post": {
      "access": [
        "createRecord",
        "readRecord",
        "updateRecord",
        "deleteRecord"
      ]
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default settings for the <code>admin</code> group are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "access": [
    "updateSecurity",
    "updateSchema"
  ],
  "resultSetLimit": -1,
  "readTimeout": -1,
  "types": {
    "*": {
      "access": [
        "createRecord",
        "readRecord",
        "updateRecord",
        "deleteRecord"
      ]
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which allows to execute any operation against the security, the schema and records.</p>
</div>
<div class="paragraph">
<p>Here is an example for an append-only group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"appendonly": {
  "access": [],
  "resultSetLimit": -1,
  "readTimeout": -1,
  "types": {
    "*": {
      "access": [
        "createRecord",
        "readRecord"
      ]
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which allows the group members to read and create, but not to update or delete records.
Such a group can be useful for ledgers, block chains, or data provenance.</p>
</div>
<div class="paragraph">
<p>You can use any JSON editor to edit the file <code>config/server-groups.json</code>.
It&#8217;s recommended to keep a copy of the current file before editing the groups.
In this way if there are any errors, it&#8217;s easy to restore the previous file.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comparison">10. Comparison with other DBMSs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter contains the comparison between ArcadeDB and other DBMS. If you&#8217;re familiar with one of those, understanding ArcadeDB takes a few minutes.</p>
</div>
<h3 id="OrientDB" class="discrete">OrientDB</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/comparison/orientdb.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB was born initially as a fork of OrientDB.
Today more than 80% of ArcadeDB code has been rewritten from scratch from the same original authors of the OrientDB project.
This allowed to get rid of many legacy parts that makes OrientDB slow, heavy and hard to maintain.
Also, since OrientDB was the first Multi-Model project out there, a lot of work of the initial R&amp;D and experiments are still in the OrientDB code base.
You can consider ArcadeDB as the natural evolution of the legacy OrientDB project.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re coming from OrientDB, please use the <a href="#OrientDB-Importer">OrientDB Importer</a> tool to import an OrientDB export into an ArcadeDB database.</p>
</div>
<div class="paragraph">
<p><strong>Main similarities and differences</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Both can run on any platform</p>
</li>
<li>
<p>Both can run SQL; ArcadeDB and OrientDB both share the same SQL Engine.</p>
</li>
<li>
<p>ArcadeDB&#8217;s SQL dialect is closely related to OrientDB&#8217;s OSQL, but more streamlined.</p>
</li>
<li>
<p>ArcadeDB "types" are the "classes" in OrientDB</p>
</li>
<li>
<p>ArcadeDB "buckets" are similar to the "clusters" in OrientDB, but without the limitation of having only 32,768 clusters. The maximum number of buckets in ArcadeDB are 2,147,483,648</p>
</li>
<li>
<p>Both ArcadeDB and OrientDB support multiple inheritance</p>
</li>
<li>
<p>ArcadeDB shares the same database instance across threads,
this makes it much easier developing with ArcadeDB than with OrientDB with multi-threads applications.
With OrientDB you have to use a pool of databases and be careful on acquiring and releasing instanced.
With ArcadeDB create a Database instance at the beginning, share it with all your threads and close when your application shuts down.</p>
</li>
<li>
<p>ArcadeDB uses thread locals only to manage transactions, while OrientDB makes a strong usage of thread local structures internally, making hard to pass the database instance across threads and a pool if needed</p>
</li>
<li>
<p>There is no base <code>V</code> and <code>E</code> classes in ArcadeDB, but rather vertex and edge are first type citizens types of records.
Use <code>CREATE VERTEX TYPE Product</code> vs OrientDB <code>CREATE CLASS Product EXTENDS V</code>. Same for edges, use <code>CREATE EDGE TYPE Sold</code> vs OrientDB <code>CREATE CLASS Sold EXTENDS E</code>.</p>
</li>
<li>
<p>ArcadeDB saves every type and property name in the dictionary to compress record size by storing only the names ids (as varint)</p>
</li>
<li>
<p>ArcadeDB keeps the MVCC counter on the page rather than on the record. This means the transaction must be repeated if there are consurrent modification on the same page, not only on the same record (like with OrientDB)</p>
</li>
<li>
<p>ArcadeDB manages everything as files and pages, for transactions and replication.
OrientDB has a mixed pages/record approach. Using the page-only approach keeps everything much faster and easier to maintain</p>
</li>
<li>
<p>ArcadeDB allows custom page size per bucket/index</p>
</li>
<li>
<p>ArcadeDB supports light-weight edges (edges without properties), but they must be used with a different syntax.
This avoids automatic upgrade of edges and unexpected behavior experienced in OrientDB</p>
</li>
<li>
<p>ArcadeDB supports replication by using a Leader/Replica model with Raft election without sharding for now.
Instead, OrientDB is based on a Multi-Master model (the sharding was experimental, never production ready) with a multi-paxos style protocol not efficient on large volume of transactions and still not rock-solid after years because of its complexity</p>
</li>
<li>
<p>ArcadeDB replicates the pages across servers, so all the databases are identical at binary level, while with OrientDB there is a mix of logical and physical replication leaving room for not managed edge cases</p>
</li>
<li>
<p>ArcadeDB Server supports HTTP/JSON, Postgres, MongoDB and Redis protocols, while OrientDB supports only HTTP/JSON and a proprietary binary protocol</p>
</li>
<li>
<p>ArcadeDB supports OrientDB SQL, the latest Gremlin version, Open Cypher and MongoDB query language, while OrientDB supports only its SQL and an old version of Gremlin</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>What ArcadeDB does not support</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>ArcadeDB supports only UNIQUE constraints on data (by creating an index), while OrientDB supports multiple constraints and validation at class level</p>
</li>
<li>
<p>ArcadeDB does not provide a dirty manager, so it&#8217;s up to the developer to mark the object to save by calling <code>.save()</code> method on it.
This makes the code of ArcadeDB smaller without handling edge cases, but if you have a tree of objects it is the developer responsibility to mark the modified objects without auto-tracking</p>
</li>
<li>
<p>ArcadeDB does not allow a document to have no class. If you want to store an embedded document without a class, use a <code>Map&lt;String,Object&gt;</code> instead</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>What ArcadeDB has more than OrientDB</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>ArcadeDB is much Faster than OrientDB.
On a single server it is common to see 10X-20X improvement in performance, with 3 nodes the gap in performance with OrientDB can reach 50X-200X faster.
With 10 servers it is over 500X faster than OrientDB!</p>
</li>
<li>
<p>The maximum number of buckets are <code>2,147,483,648</code>, while with OrientDB the maximum number of clusters is <code>32,768</code></p>
</li>
<li>
<p>ArcadeDB uses much less RAM.
With the right tuning over the settings, it&#8217;s able to work with only 4MB of JVM heap, while OrientDB requires at least 8GB to run</p>
</li>
<li>
<p>ArcadeDB codebase is much smaller and easier to maintain and improve</p>
</li>
<li>
<p>ArcadeDB is lightweight, the engine is about 1MB</p>
</li>
<li>
<p>ArcadeDB mandate all the operations to be inside a transaction, even operations against the schema. With OrientDB, they are no transactional and in case of error they can break the database</p>
</li>
<li>
<p>ArcadeDB saves every type and property names in the dictionary to compress the record by storing only the names ids</p>
</li>
<li>
<p>ArcadeDB is much more efficient on data structure.
That means ArcadeDB takes less space on disk than OrientDB and uses less RAM for caching</p>
</li>
<li>
<p>ArcadeDB natively supports asynchronous operations (by using <code>.async()</code>).
Asynchronous calls are automatically balanced on the available cores with a nice API</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Appendix">11. Appendix</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="DataTypes">11.1. Data Types</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/appendix/datatypes.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB supports several data types natively.
Below is the complete table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">SQL type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Java type</th>
<th class="tableblock halign-left valign-top">Minimum&#8201;&#8212;&#8201;Maximum</th>
<th class="tableblock halign-left valign-top">Auto-conversion from/to</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOLEAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Handles only the values <strong>True</strong> or <strong>False</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Boolean</code> or <code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0&#8201;&#8212;&#8201;1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INTEGER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32-bit signed Integers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Integer</code> or <code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2,147,483,648&#8201;&#8212;&#8201;+2,147,483,647</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any Number, String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Small 16-bit signed integers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Short</code> or <code>short</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-32,768&#8201;&#8212;&#8201;32,767</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any Number, String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LONG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Big 64-bit signed integers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Long</code> or <code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2<sup>63</sup>&#8201;&#8212;&#8201;+2<sup>63</sup>-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any Number, String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decimal numbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Float</code> or <code>float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2<sup>-149</sup>&#8201;&#8212;&#8201;(2-2<sup>-23</sup>)*2<sup>127</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any Number, String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOUBLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decimal numbers with high precision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Double</code> or <code>double</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2<sup>-1074</sup>&#8201;&#8212;&#8201;(2-2<sup>-52</sup>)*2<sup>1023</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any Number, String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Datetime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATETIME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any date with the precision up to milliseconds.
To know more about it, look at <a href="#Managing-Dates">Managing Dates</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Date</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date, Long, String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">STRING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any string as alphanumeric sequence of chars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BINARY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can contain any value as byte array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0&#8201;&#8212;&#8201;2,147,483,647</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embedded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMBEDDED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Record is contained inside the owner.
The contained record has no <a href="#RID">RID</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EmbeddedDocument</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EmbeddedDocument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embedded list</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Records are contained inside the owner.
The contained records have no <a href="#RID">RIDs</a> and are reachable only by navigating the owner record</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;EmbeddedDocument&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0&#8201;&#8212;&#8201;41,000,000 items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embedded map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Records are contained inside the owner as values of the entries, while the keys can only be Strings.
The contained records have no <a href="#RID">RIDs</a> and are reachable only by navigating the owner Record</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map&lt;String, EmbeddedDocument&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0&#8201;&#8212;&#8201;41,000,000 items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Collection&lt;? extends EmbeddedDocument&lt;?&gt;&gt;</code>, <code>String</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Link</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LINK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Link to another Record.
It&#8217;s a common <a href="#_11-and-n1-embedded-relationships">one-to-one relationship</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RID</code>, <code>&lt;? extends Record&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1:-1&#8201;&#8212;&#8201;32767:2<sup>63</sup>-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BYTE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single byte.
Useful to store small 8-bit signed integers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Byte</code> or <code>byte</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-128&#8201;&#8212;&#8201;+127</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any Number, String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DECIMAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decimal numbers without rounding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.math.BigDecimal</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any Number, String</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="Settings">11.2. Settings</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/appendix/settings.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB allows changing settings at JVM (server or embedded) and per database level.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 62%;">
<col style="width: 38%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Server/Embedded (JVM) Level</th>
<th class="tableblock halign-left valign-top">Database Level</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Those settings are valid for all the databases open in the same Server or JVM when run embedded.
If defined, they override the default value (look at the table below to see the default values).
They are used only if a database does not override them.
Such settings are not saved, so you need to set them everytime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database level settings are stored in the database and override the Server/Embedded (JVM) settings if present.
You can change these settings via <a href="#Settings-SQL">SQL</a> or <a href="#Settings-API">API</a> when run embedded.</p></td>
</tr>
</tbody>
</table>
<h4 id="_jvm_startup_serverembedded_only" class="discrete">JVM startup (server/embedded only)</h4>
<div class="paragraph">
<p>All the settings modified at JVM startup are not persistent and need to be set everytime you&#8217;re running ArcadeDB server or your embedded application.
If you&#8217;re updating a setting at JVM level, prefix the setting name with <code>arcadedb.</code> by using this syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">java ... -Darcadedb.&lt;name&gt;=&lt;value&gt; ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>&lt;name&gt;</code> is the name of the setting and <code>&lt;value&gt;</code> the value you want to override.
Example to change the server mode from development (default) to production:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">java ... -Darcadedb.server.mode=production ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example to increase the default page size for buckets to 1 MB:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">java ... -Darcadedb.bucketDefaultPageSize=1048576 ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, these settings can be set via the environment variable <code>JAVA_OPTS</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">JAVA_OPTS="-Darcadedb.server.rootPassword=playwithdata" java ...</code></pre>
</div>
</div>
<h4 id="Settings-SQL" class="discrete">SQL (Database Level)</h4>
<div class="paragraph">
<p>All the changes executed via <a href="#SQL-Alter-Database">SQL Alter Database</a> command are relative to the current database only and are persistent.
Example to increase the default page size for buckets to 1 MB:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ALTER DATABASE `arcadedb.bucketDefaultPageSize` 1048576</code></pre>
</div>
</div>
<h4 id="Settings-API" class="discrete">Programmatically (Server/Embedded and Database levels)</h4>
<div class="paragraph">
<p>You can access to the database configuration with <code>database.getConfiguration()</code> to read and write per database settings.
Example to increase the default page size for all the buckets to 1 MB on the current database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.getConfiguration().setValue(GlobalConfiguration.BUCKET_DEFAULT_PAGE_SIZE, 1048576);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To change a setting at Server/Embedded (JVM) level, set the value in the <code>GlobalConfiguration</code> enum.
Example to increase the default page size for buckets to 1 MB for all the databases open in the current JVM (server/embedded):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">GlobalConfiguration.BUCKET_DEFAULT_PAGE_SIZE.setValue(1048576);</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="Setting-Table">11.2.1. Available settings by scope (in alphabetic order):</h4>
<div class="paragraph">
<p>The tables that follow contains all the available settings in ArcadeDB separated by scope:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>JVM</code>, as the settings applied at the JVM level, so to both clients and servers</p>
</li>
<li>
<p><code>SERVER</code>, as the settings that only apply to the ArcadeDB Server.
If you&#8217;re embedding a server in your Java application you can use these settings</p>
</li>
<li>
<p><code>DATABASE</code> are all the settings that can be saved in the database configuration and are restored once the database is open</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_jvm">JVM</h5>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 55%;">
<col style="width: 10%;">
<col style="width: 15%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dumpConfigAtStartup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dumps the configuration at startup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dumpMetricsEvery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dumps the metrics at startup, shutdown and every configurable amount of time (in seconds)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>profile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the preferred profile among: default, high-performance, low-ram, low-cpu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tells if it is running in test mode. This enables the calling of callbacks for testing purpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_server_2">SERVER</h5>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 55%;">
<col style="width: 10%;">
<col style="width: 15%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.clusterName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cluster name. By default is 'arcadedb'. Useful in case of multiple clusters in the same network</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcadedb</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True if HA is enabled for the current server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.k8s</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The server is running inside Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.k8sSuffix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When running inside Kubernetes use this suffix to reach the other servers. Example: arcadedb.default.svc.cluster.local</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.quorum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default quorum between 'none', 1, 2, 3, 'majority' and 'all' servers. Default is majority</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">majority</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.quorumTimeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timeout waiting for the quorum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.replicationChunkMaxSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum channel chunk size for replicating messages between servers. Default is 16777216</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16777216</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.replicationFileMaxSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum file size for replicating messages between servers. Default is 1GB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1073741824</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.replicationIncomingHost</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP host name used for incoming replication connections. By default is 0.0.0.0 (listens to all the configured network interfaces)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.replicationIncomingPorts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP port number used for incoming replication connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2424-2433</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.replicationQueueSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Queue size for replicating messages between servers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ha.serverList</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Servers in the cluster as a list of &lt;hostname/ip-address:port&gt; items separated by comma. Example: localhost:2424,192.168.0.1:2424</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>network.socketTimeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP Socket timeout (in ms)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ssl.keyStore</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path where the SSL certificates are stored</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ssl.keyStorePass</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password to open the SSL key store</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ssl.trustStore</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to the SSL trust store</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ssl.trustStorePass</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password to open the SSL trust store</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ssl.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use SSL for client connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>postgres.debug</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the printing of Postgres protocol to the console. Default is false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>postgres.host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP host name used for incoming connections for Postgres plugin. Default is '0.0.0.0'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>postgres.port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP port number used for incoming connections for Postgres plugin. Default is 5432</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5432</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>redis.host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP host name used for incoming connections for Redis plugin. Default is '0.0.0.0'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>redis.port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP port number used for incoming connections for Redis plugin. Default is 6379</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6379</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mongo.host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP host name used for incoming connections for Mongo plugin. Default is '0.0.0.0'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mongo.port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP port number used for incoming connections for Mongo plugin. Default is 27017</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">27017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.databaseLoadAtStartup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open all the available databases at server startup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.databaseDirectory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory containing the database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${arcadedb.server.rootPath}/databases</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.backupDirectory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory containing the backups</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${arcadedb.server.rootPath}/backups</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.defaultDatabases</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default databases created when the server starts. The format is <code>(&lt;database-name&gt;[(&lt;user-name&gt;:&lt;user-passwd&gt;[:&lt;user-group&gt;])<strong>])[{import|restore:&lt;URL&gt;}][;]</strong>'. Pay attention on using `;</code> to separate databases and <code>,</code> to separate credentials. The supported actions are <code>import</code> and <code>restore</code>. Example: <code>Universe[elon:musk:admin];Amiga[Jay:Miner,Jack:Tramiel]{import:/tmp/movies.tgz}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.defaultDatabaseMode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default mode to load pre-existing databases. The value must match a com.arcadedb.engine.PaginatedFile.MODE enum value: {READ_ONLY, READ_WRITE}Databases which are newly created will always be opened READ_WRITE.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">READ_WRITE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.httpsIncomingPort</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP port number used for incoming HTTPS connections. Specify a single port or a range <code>&lt;from&gt;-&lt;to&gt;</code>. Default is 2490-2499 to accept a range of ports in case they are occupied.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2490-2499</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.httpIncomingHost</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP host name used for incoming HTTP connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.httpIncomingPort</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/IP port number used for incoming HTTP connections. Specify a single port or a range <code>&lt;from&gt;-&lt;to&gt;</code>. Default is 2480-2489 to accept a range of ports in case they are occupied.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2480-2489</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.httpTxExpireTimeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timeout in seconds for a HTTP transaction to expire. This timeout is computed from the latest command against the transaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>serverMetrics</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True to enable metrics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server mode between 'development', 'test' and 'production'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">development</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ArcadeDB_0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.plugins</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of server plugins to install. The format to load a plugin is: <code>&lt;pluginName&gt;:&lt;pluginFullClass&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.rootPassword</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password for root user to use at first startup of the server. Set this to avoid asking the password to the user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.rootPath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Root path in the file system where the server is looking for files. By default is the current directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.securityAlgorithm</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default encryption algorithm used for passwords hashing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PBKDF2WithHmacSHA256</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.securitySaltCacheSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cache size of hashed salt passwords. The cache works as LRU. Use 0 to disable the cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.saltIterations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of iterations to generate the salt or user password. Changing this setting does not affect stored passwords</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65536</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.eventBusQueueSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the queue used as a buffer for unserviced database change events.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_database_2">DATABASE</h5>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 55%;">
<col style="width: 10%;">
<col style="width: 15%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>asyncOperationsQueueImpl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Queue implementation to use between 'standard' and 'fast'. 'standard' consumes less CPU than the 'fast' implementation, but it could be slower with high loads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">standard</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>asyncOperationsQueueSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the total asynchronous operation queues (it is divided by the number of parallel threads in the pool)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1024</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>asyncTxBatchSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of operations to commit in batch by async thread</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10240</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>asyncWorkerThreads</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of asynchronous worker threads. 0 (default) = available cores minus 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bucketDefaultPageSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default page size in bytes for buckets. Default is 65536</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65536</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>command.timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default timeout for commands (in ms)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>commitLockTimeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timeout in ms to lock resources during commit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cypher.statementCache</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max number of entries in the cypher statement cache. Use 0 to disable. Caching statements speeds up execution of the same cypher queries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dateFormat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default date format using Java SimpleDateFormat syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-MM-dd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dateImplementation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default date implementation to use on deserialization. By default java.util.Date is used, but the following are supported: java.util.Calendar, java.time.LocalDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">class java.util.Date</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dateTimeFormat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default date time format using Java SimpleDateFormat syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-MM-dd HH:mm:ss</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dateTimeImplementation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default datetime implementation to use on deserialization. By default java.util.Date is used, but the following are supported: java.util.Calendar, java.time.LocalDateTime, java.time.ZonedDateTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">class java.util.Date</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flushOnlyAtClose</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Never flushes pages on disk until the database closing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>freePageRAM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage (0-100) of memory to free when Page RAM is full</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gremlin.timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default timeout for gremlin commands (in ms)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>indexCompactionMinPagesSchedule</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimum number of mutable pages for an index to be schedule for automatic compaction. 0 = disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>indexCompactionRAM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum amount of RAM to use for index compaction, in MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>initialPageCacheSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial number of entries for page cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65535</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxPageRAM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum amount of pages (in MB) to keep in RAM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pageFlushQueue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the asynchronous page flush queue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>polyglotCommand.timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default timeout for polyglot commands (in ms)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>queryMaxHeapElementsAllowedPerOp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of elements (records) allowed in a single query for memory-intensive operations (eg. ORDER BY in heap). If exceeded, the query fails with an OCommandExecutionException. Negative number means no limit.This setting is intended as a safety measure against excessive resource consumption from a single query (eg. prevent OutOfMemory)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sqlStatementCache</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of parsed statements to keep in cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>txRetries</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of retries in case of MVCC exception</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>txWAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses the WAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>txWalFlush</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flushes the WAL on disk at commit time. It can be 0 = no flush, 1 = flush without metadata and 2 = full flush (fsync)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>typeDefaultBuckets</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default number of buckets to create per type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Managing-Dates">11.3. Managing Dates</h3>
<div class="paragraph">
<p>ArcadeDB treats dates as first class citizens. Internally, it saves dates in the <a href="https://en.wikipedia.org/wiki/Unix_time">Unix time</a> format.
Meaning, it stores dates as a <code>long</code> variable, which contains the count in milliseconds since the Unix Epoch, (that is, 1 January 1970).</p>
</div>
<div class="paragraph">
<p>Starting from v21.1.1, ArcadeDB sully support the new Java Time API with a custom precision from second to nanoseconds. The data types to manage date/time are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DATE</code>, to handle dates without a time. Example: <code>01/01/2023</code></p>
</li>
<li>
<p><code>DATETIME_SECOND</code>, to handle datetime with the precision of the second. Example: <code>01/01/2023 10:30:00</code></p>
</li>
<li>
<p><code>DATETIME</code>, to handle datetime with the precision of the millisecond. Example: <code>01/01/2023 10:30:00.333</code></p>
</li>
<li>
<p><code>DATETIME_MICROS</code>, to handle datetime with the precision of the microsecond. Example: <code>01/01/2023 10:30:00</code></p>
</li>
<li>
<p><code>DATETIME_NANOS</code>, to handle datetime with the precision of the nanosecond. Example: <code>01/01/2023 10:30:00</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
using high precision types increase the space used on disk. For example, using nanosecond precision instead of millisecond increase the space requested to store the datetime of a factor of 2X.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you&#8217;re working with the Java API, the class used for both <code>DATE</code> and <code>DATETIME</code> is <code>java.util.Date</code>. With <code>DATETIME</code> values, if you&#8217;re using higher precision than millisecond you need to use the new Java Time API:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.time.LocalDateTime</code></p>
</li>
<li>
<p><code>java.time.ZonedDateTime</code></p>
</li>
<li>
<p><code>java.time.Instant</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you&#8217;re starting a new project with ArcadeDB, using the new Java Time API is strongly advised. For example, if you want to use <code>LocalDateTime</code> as default class that represent <code>DATETIME</code>, set it in the binary serializer at startup and ArcadeDB will always return a LocalDateTime for DATETIME types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">alter database `arcadedb.dateTimeImplementation` `java.time.LocalDateTime`</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can do the same for <code>DATE</code> types using the new Java Time API for dates <code>java.time.LocalDate</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">alter database `arcadedb.dateImplementation` `java.time.LocalDate`</code></pre>
</div>
</div>
<h4 id="_date_and_datetime_formats" class="discrete">Date and Datetime Formats</h4>
<div class="paragraph">
<p>In order to make the internal count from the Unix Epoch into something human readable, ArcadeDB formats the count into date and datetime formats.  By default, these formats are <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Date Format: <code>yyyy-MM-dd</code></p>
</li>
<li>
<p>Datetime Format: <code>yyyy-MM-dd HH:mm:ss</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the event that these default formats are not sufficient for the needs of your application, you can customize them through <a href="#SQL-Alter-Database"><code>ALTER DATABASE &#8230;&#8203; DATEFORMAT</code></a> and <a href="#SQL-Alter-Database"><code>DATETIMEFORMAT</code></a> commands.
For instance,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>arcadedb&gt; ALTER DATABASE DATEFORMAT "dd MMMM yyyy"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command updates the current database to use the English format for dates.  That is, 14 Febr 2015.</p>
</div>
<h4 id="_sql_functions_and_methods" class="discrete">SQL Functions and Methods</h4>
<div class="paragraph">
<p>To simplify the management of dates, ArcadeDB SQL automatically parses dates to and from strings and longs.
These functions and methods provide you with more control to manage dates:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">SQL</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_date"><code>date()</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Function converts dates to and from strings and dates, also uses custom formats.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_sysdate"><code>sysdate()</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Function returns the current date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_format"><code>.format()</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method returns the date in different formats.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asdate"><code>.asDate()</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method converts any type into a date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_asdatetime"><code>.asDatetime()</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method converts any type into datetime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_aslong"><code>.asLong()</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method converts any date into long format, (that is, Unix time).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_precision"><code>.precision()</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method modifies the precision of a datetime property. For example, <code>.precision('millisecond')</code> returns the datetime property with millisecond precision</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, consider a case where you need to extract only the years for date entries and to arrange them in order.  You can use the <a href="#_format"><code>.format()</code></a> method to extract dates into different formats.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>arcadedb&gt; SELECT @RID, id, date.format('yyyy') AS year FROM Order

+--------+----+------+
| @RID   | id | year |
+--------+----+------+
| #31:10 | 92 | 2015 |
| #31:10 | 44 | 2014 |
| #31:10 | 32 | 2014 |
| #31:10 | 21 | 2013 |
+--------+----+------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to this, you can also group the results. For instance, extracting the number of orders grouped by year.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>arcadedb&gt; SELECT date.format('yyyy') AS Year, COUNT(*) AS Total FROM Order ORDER BY Year

+------+--------+
| Year |  Total |
+------+--------+
| 2015 |      1 |
| 2014 |      2 |
| 2013 |      1 |
+------+--------+</code></pre>
</div>
</div>
<h4 id="_dates_before_1970" class="discrete">Dates before 1970</h4>
<div class="paragraph">
<p>While you may find the default system for managing dates in ArcadeDB sufficient for your needs, there are some cases where it may not prove so.  For instance, consider a database of archaeological finds, a number of which date to periods not only before 1970 but possibly even before the Common Era.  You can manage this by defining an era or epoch variable in your dates.</p>
</div>
<div class="paragraph">
<p>For example, consider an instance where you want to add a record noting the date for the foundation of Rome, which is traditionally referred to as April 21, 753 BC.  To enter dates before the Common Era, first run the [<code>ALTER DATABASE DATETIMEFORMAT</code>] command to add the <code>GG</code> variable to use in referencing the epoch.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>arcadedb&gt; ALTER DATABASE DATETIMEFORMAT "yyyy-MM-dd HH:mm:ss GG"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you&#8217;ve run this command, you can create a record that references date and datetime by epoch.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>arcadedb&gt; CREATE VERTEX V SET city = "Rome", date = DATE("0753-04-21 00:00:00 BC")
arcadedb&gt; SELECT @RID, city, date FROM V

+-------+------+------------------------+
| @RID  | city | date                   |
+-------+------+------------------------+
| #9:10 | Rome | 0753-04-21 00:00:00 BC |
+-------+------+------------------------+</code></pre>
</div>
</div>
<h4 id="_using_format_on_insertion" class="discrete">Using <code>.format()</code> on Insertion</h4>
<div class="paragraph">
<p>In addition to the above method, instead of changing the date and datetime formats for the database, you can format the results as you insert the date.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>arcadedb&gt; CREATE VERTEX V SET city = "Rome", date = DATE("yyyy-MM-dd HH:mm:ss GG")
arcadedb&gt;  SELECT @RID, city, date FROM V

+------+------+------------------------+
| @RID | city | date                   |
+------+------+------------------------+
| #9:4 | Rome | 0753-04-21 00:00:00 BC |
+------+------+------------------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, you again create a vertex for the traditional date of the foundation of Rome.  However, instead of altering the database, you format the date field in <a href="#SQL-Create-Vertex"><code>CREATE VERTEX</code></a> command.</p>
</div>
<h4 id="_viewing_unix_time" class="discrete">Viewing Unix Time</h4>
<div class="paragraph">
<p>In addition to the formatted date and datetime, you can also view the underlying count from the Unix Epoch, using the <a href="#_aslong"><code>asLong()</code></a> method for records.  For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>arcadedb&gt; SELECT @RID, city, date.asLong() FROM #9:4

+------+------+------------------------+
| @RID | city | date                   |
+------+------+------------------------+
| #9:4 | Rome | -85889120400000        |
+------+------+------------------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>Meaning that, ArcadeDB represents the date of April 21, 753 BC, as -85889120400000 in Unix time.
You can also work with dates directly as longs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>arcadedb&gt; CREATE VERTEX V SET city = "Rome", date = DATE(-85889120400000)
arcadedb&gt; SELECT @RID, city, date FROM V

+-------+------+------------------------+
| @RID  | city | date                   |
+-------+------+------------------------+
| #9:11 | Rome | 0753-04-21 00:00:00 BC |
+-------+------+------------------------+</code></pre>
</div>
</div>
<h4 id="_use_iso_8601_dates" class="discrete">Use ISO 8601 Dates</h4>
<div class="paragraph">
<p>According to <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a>, Combined date and time in UTC: 2014-12-20T00:00:00. To use this standard change the date time format in the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">ALTER DATABASE DATETIMEFORMAT "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"</code></pre>
</div>
</div>
<h4 id="_arithmetic_with_dates" class="discrete">Arithmetic with dates</h4>
<div class="paragraph">
<p>Dates can be added and subtracted. If you want to know the difference in terms of seconds between two dates, you can use the <code>-</code> (minus) operator. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT sysdate() - lastActivity as secondsFromLastActivity FROM UserActivity</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns <code>1212113.232000000</code>.</p>
</div>
<div class="paragraph">
<p>if the date supports the fractional part of the second, then it&#8217;s returned as nanoseconds as decimal part. In the example above, <code>sysdate()</code> function returns a datetime with, by default, precision to the millisecond.</p>
</div>
</div>
<div class="sect2">
<h3 id="Binary-Types">11.4. Binary Types (BLOB)</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/appendix/binary-types.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>While some DBMSs (like OrientDB) specifically support <a href="https://en.wikipedia.org/wiki/Binary_large_object">BLOBs</a> (Binary Large OBjects) record types, with ArcadeDB the binary content must be stored as a property in documents, vertices and edges.</p>
</div>
<div class="paragraph">
<p>To create a BLOB like type, you can define a "Blob" document type and add a property of type <code>BINARY</code>. Then you can set and retrieve the binary content as byte array (<code>byte[]</code>). Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">database.transaction(() -&gt; {
  // DEFINE THE BLOB TYPE
  DocumentType blobType = database.getSchema().createDocumentType("Blob");
  blobType.createProperty("binary", Type.BINARY);
  ...
  // STORE SOME BINARY CONTENT IN THE DOCUMENT PROPERTY
  final MutableDocument blob = database.newDocument("Blob");
  blob.set("binary", "This is a test".getBytes());
  blob.save();
  ...
  // RETRIEVE THE BINARY CONTENT FROM THE DOCUMENT PROPERTY
  final Document blob = database.iterateType("Blob", false).next().asDocument();
  byte[] binaryContent = blob.getBinary("binary");
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="SQL-Syntax">11.5. SQL Syntax</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/appendix/sql-syntax.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB Query Language is an SQL dialect.</p>
</div>
<div class="paragraph">
<p>This page lists all the details about its syntax.</p>
</div>
<div id="SQL-Comments" class="paragraph">
<p><strong>Comments</strong></p>
</div>
<div class="paragraph">
<p>Comments in the ArcadeDB SQL scripts can be C-Style block comments, which are enclosed by <code>/<strong></code> and <code></strong>/</code>,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">/* This is a single-line comment */

/* This is a multi-
   line comment */</code></pre>
</div>
</div>
<div class="paragraph">
<p>as well as classic SQL end of line comments, started by <code>-- </code>  (note the space after the two dashes),</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">SELECT true; -- This is an end of line comment</code></pre>
</div>
</div>
<div id="SQL-Identifiers" class="paragraph">
<p><strong>Identifiers</strong></p>
</div>
<div class="paragraph">
<p>An identifier is a name that identifies an entity in ArcadeDB schema. Identifiers can refer to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type names</p>
</li>
<li>
<p>property names</p>
</li>
<li>
<p>index names</p>
</li>
<li>
<p>aliases</p>
</li>
<li>
<p>bucket names</p>
</li>
<li>
<p>method names</p>
</li>
<li>
<p>named parameters</p>
</li>
<li>
<p>variable names (LET)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An identifier is a sequence of characters delimited by back-ticks <code>`</code>.
Examples of valid identifiers are</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>`surname`</code></p>
</li>
<li>
<p><code>`name and surname`</code></p>
</li>
<li>
<p><code>`foo.bar`</code></p>
</li>
<li>
<p><code>`a + b`</code></p>
</li>
<li>
<p><code>`select`</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The back-tick character can be used as a valid character for identifiers, but it has to be escaped with a backslash, eg.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>`foo \` bar`</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following are reserved identifiers, they can NEVER be used with a different meaning (upper or lower case):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@rid</code>: record ID</p>
</li>
<li>
<p><code>@type</code>: document type</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Simplified identifiers</strong></p>
</div>
<div class="paragraph">
<p>Identifiers that start with a letter or with <code>$</code> and that contain only numbers, letters and underscores, can be written without back-tick quoting. Reserved words cannot be used as simplified identifiers. Valid simplified identifiers are</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code></p>
</li>
<li>
<p><code>name_and_surname</code></p>
</li>
<li>
<p><code>$foo</code></p>
</li>
<li>
<p><code>name_12</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples of INVALID queries for wrong identifier syntax</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-SQL" data-lang="SQL">/* INVALID - `from` is a reserved keyword */
SELECT from from from
/* CORRECT */
SELECT `from` from `from`

/* INVALID - simplified identifiers cannot start with a number */
SELECT name as 1name from Foo
/* CORRECT */
SELECT name as `1name` from Foo

/* INVALID - simplified identifiers cannot contain `-` character, `and` is a reserved keyword */
SELECT name-and-surname from Foo
/* CORRECT 1 - `name-and-surname` is a single field name */
SELECT `name-and-surname` from Foo
/* CORRECT 2 - `name`, `and` and `surname` are numbers and the result is the subtraction */
SELECT name-`and`-surname from Foo
/* CORRECT 2 - with spaces  */
SELECT name - `and` - surname from Foo

/* INVALID - wrong back-tick escaping */
SELECT `foo`bar` from Foo
/* CORRECT */
SELECT `foo\`bar` from Foo</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case sensitivity</strong></p>
</div>
<div class="paragraph">
<p><strong>(draft)</strong>
In current version, type names are case <strong>insensitive</strong>, all the other identifiers are case sensitive.</p>
</div>
<div id="SQL-Reserved-Words" class="paragraph">
<p><strong>Reserved words </strong></p>
</div>
<div class="paragraph">
<p>In ArcadeDB SQL the following are reserved words</p>
</div>
<div class="ulist">
<ul>
<li>
<p>AFTER</p>
</li>
<li>
<p>AND</p>
</li>
<li>
<p>AS</p>
</li>
<li>
<p>ASC</p>
</li>
<li>
<p>BATCH</p>
</li>
<li>
<p>BEFORE</p>
</li>
<li>
<p>BETWEEN</p>
</li>
<li>
<p>BREADTH_FIRST</p>
</li>
<li>
<p>BY</p>
</li>
<li>
<p>BUCKET</p>
</li>
<li>
<p>CONTAINS</p>
</li>
<li>
<p>CONTAINSALL</p>
</li>
<li>
<p>CONTAINSKEY</p>
</li>
<li>
<p>CONTAINSTEXT</p>
</li>
<li>
<p>CONTAINSVALUE</p>
</li>
<li>
<p>CREATE</p>
</li>
<li>
<p>DEFAULT</p>
</li>
<li>
<p>DEFINED</p>
</li>
<li>
<p>DELETE</p>
</li>
<li>
<p>DEPTH_FIRST</p>
</li>
<li>
<p>DESC</p>
</li>
<li>
<p>DISTINCT</p>
</li>
<li>
<p>EDGE</p>
</li>
<li>
<p>FETCHPLAN</p>
</li>
<li>
<p>FROM</p>
</li>
<li>
<p>INCREMENT</p>
</li>
<li>
<p>INSERT</p>
</li>
<li>
<p>INSTANCEOF</p>
</li>
<li>
<p>INTO</p>
</li>
<li>
<p>IS</p>
</li>
<li>
<p>LET</p>
</li>
<li>
<p>LIKE</p>
</li>
<li>
<p>LIMIT</p>
</li>
<li>
<p>MATCH</p>
</li>
<li>
<p>MATCHES</p>
</li>
<li>
<p>MAXDEPTH</p>
</li>
<li>
<p>NOCACHE</p>
</li>
<li>
<p>NOT</p>
</li>
<li>
<p>NULL</p>
</li>
<li>
<p>OR</p>
</li>
<li>
<p>PARALLEL</p>
</li>
<li>
<p>POLYMORPHIC</p>
</li>
<li>
<p>RETRY</p>
</li>
<li>
<p>RETURN</p>
</li>
<li>
<p>SELECT</p>
</li>
<li>
<p>SKIP</p>
</li>
<li>
<p>STRATEGY</p>
</li>
<li>
<p>TIMEOUT</p>
</li>
<li>
<p>TRAVERSE</p>
</li>
<li>
<p>UNSAFE</p>
</li>
<li>
<p>UNWIND</p>
</li>
<li>
<p>UPDATE</p>
</li>
<li>
<p>UPSERT</p>
</li>
<li>
<p>VERTEX</p>
</li>
<li>
<p>WAIT</p>
</li>
<li>
<p>WHERE</p>
</li>
<li>
<p>WHILE</p>
</li>
</ul>
</div>
<div id="SQL-Base-Types" class="paragraph">
<p><strong>Base types </strong></p>
</div>
<div class="paragraph">
<p>Accepted base types in ArcadeDB SQL are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>integer numbers</strong>:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Valid integers are</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(32bit)
1
12345678
-45

(64bit)
1L
12345678L
-45L</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>floating point numbers</strong>: single or double precision</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Valid floating point numbers are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(single precision)
1.5
12345678.65432
-45.0

(double precision)
0.23D
.23D</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>absolute precision, decimal numbers</strong>: like BigDecimal in Java</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the <code>bigDecimal(&lt;number&gt;)</code> function to explicitly instantiate an absolute precision number.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>strings</strong>: delimited by <code>'</code> or by <code>"</code>. Single quotes, double quotes and back-slash inside strings can escaped using a back-slash</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Valid strings are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>"foo bar"
'foo bar'
"foo \" bar"
'foo \' bar'
'foo \\ bar'</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>booleans</strong>: boolean values are case sensitive</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Valid boolean values are</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>true
false</code></pre>
</div>
</div>
<div class="paragraph">
<p>Boolean value constants are case insensitive, so also <code>TRUE</code>, <code>True</code> and so on are valid.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>links</strong>: A link is a pointer to a document in the database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In SQL a link is represented as follows (short and extended notation):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>#&lt;bucket-id&gt;:&lt;bucket-position&gt;

or

{"@rid": "#&lt;bucket-id&gt;:&lt;bucket-position&gt;"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>#12:15

or

{"@rid": "#12:15"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bracket notation is mandatory inside JSON, as the short notation is not a valid value in JSON.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>null</strong>: case insensitive (for consistency with IS NULL and IS NOT NULL conditions, that are case insensitive)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Valid null expressions include</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>NULL
null
Null
nUll
...</code></pre>
</div>
</div>
<div id="SQL-Numbers" class="paragraph">
<p><strong>Numbers</strong></p>
</div>
<div class="paragraph">
<p>ArcadeDB can store five different types of numbers</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Integer: 32bit signed</p>
</li>
<li>
<p>Long: 64bit signed</p>
</li>
<li>
<p>Float: decimal 32bit signed</p>
</li>
<li>
<p>Double: decimal 64bit signed</p>
</li>
<li>
<p>BigDecimal: absolute precision</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Integers</strong> are represented in SQL as plain numbers, eg. <code>123</code>. If the number represented exceeds the Integer maximum size (see Java java.lang.Integer <code>MAX_VALUE</code> and <code>MIN_VALUE</code>), then it&#8217;s automatically converted to a Long.</p>
</div>
<div class="paragraph">
<p>When an integer is saved to a schemaful property of another numerical type, it is automatically converted.</p>
</div>
<div class="paragraph">
<p><strong>Longs</strong> are represented in SQL as numbers with <code>L</code> suffix, eg. <code>123L</code> (L can be uppercase or lowercase). Plain numbers (withot L prefix) that exceed the Integer range are also automatically converted to Long. If the number represented exceeds the Long maximum size (see Java java.lang.Long <code>MAX_VALUE</code> and <code>MIN_VALUE</code>), then the result is <code>NULL</code>;</p>
</div>
<div class="paragraph">
<p>Integer and Long numbers can be represented in base 10 (decimal), 8 (octal) or 16 (hexadecimal):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>decimal: <code>["-"] ("0" | ( ("1"-"9") ("0"-"9")* ) ["l"|"L"]</code>, eg.</p>
</li>
<li>
<p><code>15</code>, <code>15L</code></p>
</li>
<li>
<p><code>-164</code></p>
</li>
<li>
<p><code>999999999999</code></p>
</li>
<li>
<p>octal: <code>["-"] "0" ("0"-"7")+ ["l"|"L"]</code>, eg.</p>
</li>
<li>
<p><code>01</code>, <code>01L</code> (equivalent to decimal 1)</p>
</li>
<li>
<p><code>010</code>, <code>010L</code> (equivalent to decimal 8)</p>
</li>
<li>
<p><code>-065</code>, <code>-065L</code> (equivalent to decimal 53)</p>
</li>
<li>
<p>hexadecimal: <code>["-"] "0" ("x"|"X") ("0"-"9"," a"-"f", "A"-"F")+ ["l"|"L"]</code>, eg.</p>
</li>
<li>
<p><code>0x1</code>, <code>0X1</code>, <code>0x1L</code> (equivalent to 1 decimal)</p>
</li>
<li>
<p><code>0x10</code> (equivalent to decimal 16)</p>
</li>
<li>
<p><code>0xff</code>, <code>0xFF</code> (equivalent to decimal 255)</p>
</li>
<li>
<p><code>-0xff</code>, <code>-0xFF</code> (equivalent to decimal -255)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Float</strong> numbers are represented in SQL as <code>[-][&lt;number&gt;].&lt;number&gt;</code>, eg. valid Float values are <code>1.5</code>, <code>-1567.0</code>, <code>.556767</code>. If the number represented exceeds the Float maximum size (see Java java.lang.Float <code>MAX_VALUE</code> and <code>MIN_VALUE</code>), then it&#8217;s automatically converted to a Double.</p>
</div>
<div class="paragraph">
<p><strong>Double</strong> numbers are represented in SQL as <code>[-][&lt;number&gt;].&lt;number&gt;D</code> (D can be uppercase or lowercase), eg. valid Float values are <code>1.5d</code>, <code>-1567.0D</code>, <code>.556767D</code>. If the number represented exceeds the Double maximum size (see Java java.lang.Double <code>MAX_VALUE</code> and <code>MIN_VALUE</code>), then the result is <code>NULL</code></p>
</div>
<div class="paragraph">
<p>Float and Double numbers can be represented as decimal, decimal with exponent, hexadecimal and hexadecimal with exponent.
Here is the full syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>FLOATING_POINT_LITERAL: ["-"] ( &lt;DECIMAL_FLOATING_POINT_LITERAL&gt; | &lt;HEXADECIMAL_FLOATING_POINT_LITERAL&gt; )

DECIMAL_FLOATING_POINT_LITERAL:
      (["0"-"9"])+ "." (["0"-"9"])* (&lt;DECIMAL_EXPONENT&gt;)? (["f","F","d","D"])?
      | "." (["0"-"9"])+ (&lt;DECIMAL_EXPONENT&gt;)? (["f","F","d","D"])?
      | (["0"-"9"])+ &lt;DECIMAL_EXPONENT&gt; (["f","F","d","D"])?
      | (["0"-"9"])+ (&lt;DECIMAL_EXPONENT&gt;)? ["f","F","d","D"]

DECIMAL_EXPONENT: ["e","E"] (["+","-"])? (["0"-"9"])+

HEXADECIMAL_FLOATING_POINT_LITERAL:
        "0" ["x", "X"] (["0"-"9","a"-"f","A"-"F"])+ (".")? &lt;HEXADECIMAL_EXPONENT&gt; (["f","F","d","D"])?
      | "0" ["x", "X"] (["0"-"9","a"-"f","A"-"F"])* "." (["0"-"9","a"-"f","A"-"F"])+ &lt;HEXADECIMAL_EXPONENT&gt; (["f","F","d","D"])?

HEXADECIMAL_EXPONENT: ["p","P"] (["+","-"])? (["0"-"9"])+</code></pre>
</div>
</div>
<div class="paragraph">
<p>Eg.
- base 10
  - <code>0.5</code>
  - <code>0.5f</code>, <code>0.5F</code>, <code>2f</code> (ATTENTION, this is NOT hexadecimal)
  - <code>0.5d</code>, <code>0.5D</code>, <code>2D</code> (ATTENTION, this is NOT hexadecimal)
  - <code>3.21e2d</code> equivalent to <code>3.21 * 10^2 = 321</code>
- base 16
  - <code>0x3p4d</code> equivalent to <code>3 * 2^4 = 48</code>
  - <code>0x3.5p4d</code> equivalent to <code>3.5(base 16) * 2^4</code></p>
</div>
<div class="paragraph">
<p><strong>BigDecimal</strong> in ArcadeDB is represented as a Java BigDecimal.
The instantiation of BigDecimal can be done explicitly, using the <code>bigDecimal(&lt;number&gt; | &lt;string&gt;)</code> funciton, eg. <code>bigDecimal(124.4)</code> or <code>bigDecimal("124.4")</code></p>
</div>
<div id="SQL-Mathematical-Operations" class="paragraph">
<p><strong>Mathematical operations</strong></p>
</div>
<div class="paragraph">
<p>Mathematical Operations with numbers follow these rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Operations are calculated from left to right, following the operand priority.</p>
</li>
<li>
<p>When an operation involves two numbers of different type, both are converted to the higher precision type between the two.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>15 + 20L = 15L + 20L     // the 15 is converted to 15L

15L + 20 = 15L + 20L     // the 20 is converted to 20L

15 + 20.3 = 15.0 + 20.3     // the 15 is converted to 15.0

15.0 + 20.3D = 15.0D + 20.3D     // the 15.0 is converted to 15.0D</code></pre>
</div>
</div>
<div class="paragraph">
<p>the overflow follows Java rules.</p>
</div>
<div class="paragraph">
<p>The conversion of a number to BigDecimal can be done explicitly, using the <code>bigDecimal()</code> funciton, eg. <code>bigDecimal(124.4)</code> or <code>bigDecimal("124.4")</code></p>
</div>
<div id="SQL-Collections" class="paragraph">
<p><strong>Collections</strong></p>
</div>
<div class="paragraph">
<p>ArcadeDB supports two types of collections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Lists</strong>: ordered, allow duplicates</p>
</li>
<li>
<p><strong>Sets</strong>: not ordered (?), no duplicates</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The SQL notation allows to create <code>Lists</code> with square bracket notation, eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[1, 3, 2, 2, 4]</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>List</code> can be converted to a <code>Set</code> using the <code>.asSet()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[1, 3, 2, 2, 4].asSet() = [1, 3, 2, 4] /*  the order of the elements in the resulting set is not guaranteed */</code></pre>
</div>
</div>
<div id="SQL-Binary" class="paragraph">
<p><strong>Binary data</strong></p>
</div>
<div class="paragraph">
<p>ArcadeDB can store binary data (byte arrays) in document fields. There is no native representation of binary data in SQL syntax, insert/update a binary field you have to use <code>decode(&lt;base64string&gt;, "base64")</code> function.</p>
</div>
<div class="paragraph">
<p>To obtain the base64 string representation of a byte array, you can use the function <code>encode(&lt;byteArray&gt;, "base64")</code></p>
</div>
<div id="SQL-Expressions" class="paragraph">
<p><strong>Expressions</strong></p>
</div>
<div class="paragraph">
<p>Expressions can be used as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>single projections</p>
</li>
<li>
<p>operands in a condition</p>
</li>
<li>
<p>items in a GROUP BY</p>
</li>
<li>
<p>items in an ORDER BY</p>
</li>
<li>
<p>right argument of a LET assignment</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Valid expressions are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;base type value&gt;</code> (string, number, boolean)</p>
</li>
<li>
<p><code>&lt;field name&gt;</code></p>
</li>
<li>
<p><code>&lt;@attribute name&gt;</code></p>
</li>
<li>
<p><code>&lt;function invocation&gt;</code></p>
</li>
<li>
<p><code>&lt;expression&gt; &lt;binary operator&gt; &lt;expression&gt;</code>: for operator precedence, see below table.</p>
</li>
<li>
<p><code>&lt;unary operator&gt; &lt;expression&gt;</code></p>
</li>
<li>
<p><code>( &lt;expression&gt; )</code>: expression between parenthesis, for precedences</p>
</li>
<li>
<p><code>( &lt;query&gt; )</code>: query between parenthesis</p>
</li>
<li>
<p><code>[ &lt;expression&gt; (, &lt;expression&gt;)* ]</code>: a list, an ordered collection that allows duplicates, eg. <code>["a", "b", "c"]</code>)</p>
</li>
<li>
<p><code>{ &lt;expression&gt;: &lt;expression&gt; (, &lt;expression&gt;: &lt;expression&gt;)* }</code>: the result is an ODocument, with &lt;field&gt;:&lt;value&gt; values, eg. <code>{"a":1, "b": 1+2+3, "c": foo.bar.size() }</code>. The key name is converted to String if it&#8217;s not.</p>
</li>
<li>
<p><code>&lt;expression&gt; &lt;modifier&gt; ( &lt;modifier&gt; )*</code>: a chain of modifiers (see below)</p>
</li>
<li>
<p><code>&lt;json&gt;</code>: It is translated to an ODocument. Nested JSON is allowed and is translated to nested ODocuments</p>
</li>
<li>
<p><code>&lt;expression&gt; IS NULL</code>: check for null value of an expression</p>
</li>
<li>
<p><code>&lt;expression&gt; IS NOT NULL</code>: check for non null value of an expression</p>
</li>
</ul>
</div>
<div id="SQL-Modifiers" class="paragraph">
<p><strong>Modifiers</strong></p>
</div>
<div class="paragraph">
<p>A modifier can be
- a dot-separated field chain, eg. <code>foo.bar</code>. Dot notation is used to navigate relationships and document fields. eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>  john = {
            name: "John",
            surname: "Jones",
            address: {
               city: {
                  name: "London"
               }
            }
         }

  john.address.city.name = "London"</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>a method invocation, eg. <code>foo.size()</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Method invocations can be chained, eg. <code>foo.toLowerCase().substring(2, 4)</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>a square bracket filter, eg. <code>foo[1]</code> or <code>foo[name = 'John']</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Square bracket filters</strong></p>
</div>
<div class="paragraph">
<p>Square brackets can be used to filter collections or maps.</p>
</div>
<div class="paragraph">
<p><code>field[ ( &lt;expression&gt; | &lt;range&gt; | &lt;condition&gt; ) ]</code></p>
</div>
<div class="paragraph">
<p>Based on what is between brackets, the square bracket filtering has different effects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;expression&gt;</code>: If the expression returns an Integer or Long value (i), the result of the square bracket filtering
is the i-th element of the collection/map. If the result of the expresson (K) is not a number, the filtering returns the value corresponding to the key K in the map field. If the field is not a collection/map, the square bracket filtering returns <code>null</code>.
The result of this filtering is ALWAYS a single value.</p>
</li>
<li>
<p><code>&lt;range&gt;</code>: A range is something like <code>M..N</code>  or <code>M&#8230;&#8203;N</code> where M and N are integer/long numbers, eg. <code>fieldName[2..5]</code>. The result of range filtering is a collection that is a subet of the original field value, containing all the items from position M (included) to position N (excluded for <code>..</code>, included for <code>&#8230;&#8203;</code>). Eg. if <code>fieldName = ['a', 'b', 'c', 'd', 'e']</code>, <code>fieldName[1..3] = ['b', 'c']</code>, <code>fieldName[1&#8230;&#8203;3] = ['b', 'c', 'd']</code>. Ranges start from <code>0</code>. The result of this filtering is ALWAYS a list (ordered collection, allowing duplicates). If the original collection was ordered, then the result will preserve the order.</p>
</li>
<li>
<p><code>&lt;condition&gt;</code>: A normal SQL condition, that is applied to each element in the <code>fieldName</code> collection. The result is a sub-collection that contains only items that match the condition. Eg. <code>fieldName = [{foo = 1},{foo = 2},{foo = 5},{foo = 8}]</code>, <code>fieldName[foo &gt; 4] = [{foo = 5},{foo = 8}]</code>. The result of this filtering is ALWAYS a list (ordered collection, allowing duplicates). If the original collection was ordered, then the result will preserve the order.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Conditions</strong></p>
</div>
<div class="paragraph">
<p>A condition is an expression that returns a boolean value.</p>
</div>
<div class="paragraph">
<p>An expression that returns something different from a boolean value is always evaluated to <code>false</code>.</p>
</div>
<div class="paragraph">
<p><strong>Comparison Operators</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>=</code>  (equals)</strong>: If used in an expression, it is the boolean equals (eg. <code>select from Foo where name = 'John'</code>. If used in an SET section of INSERT/UPDATE statements or on a LET statement, it represents a variable assignment (eg. <code>insert into Foo set name = 'John'</code>)</p>
</li>
<li>
<p><strong><code>==</code> (equals)</strong>: same as <code>=</code></p>
</li>
<li>
<p><strong><code>!=</code> (not equals)</strong>: inequality operator.</p>
</li>
<li>
<p><strong><code>&lt;&gt;</code> (not equals)</strong>: same as <code>!=</code></p>
</li>
<li>
<p><strong><code>&gt;</code>  (greater than)</strong></p>
</li>
<li>
<p><strong><code>&gt;=</code> (greater or equal)</strong></p>
</li>
<li>
<p><strong><code>&lt;</code>  (less than)</strong></p>
</li>
<li>
<p><strong><code>&lt;=</code> (less or equal)</strong></p>
</li>
<li>
<p><strong><code>&lt;=&gt;</code> (null-safe equals)</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Math Operators</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>+</code>  (plus)</strong>: addition if both operands are numbers, string concatenation (with string conversion) if one of the operands is not a number. The order of calculation (and conversion) is from left to right, eg <code>'a' + 1 + 2 = 'a12'</code>, <code>1 + 2 + 'a' = '3a'</code>. It can also be used as a unary operator (no effect).</p>
</li>
<li>
<p><strong><code>-</code>  (minus</strong>): subtraction between numbers. Non-number operands are evaluated to zero. Null values are treated as a zero, eg <code>1 + null = 1</code>. Minus can also be used as a unary operator, to invert the sign of a number.</p>
</li>
<li>
<p><strong><code>*</code>  (multiplication)</strong>: multiplication between numbers. If one of the operands is null, the multiplication will evaluate to null.</p>
</li>
<li>
<p><strong><code>/</code>  (division)</strong>: division between numbers. If one of the operands is null, the division will evaluate to null. The result of a division by zero is NaN.</p>
</li>
<li>
<p><strong><code>%</code>  (modulo)</strong>: modulo between numbers. If one of the operands is null, the modulo will evaluate to null.</p>
</li>
<li>
<p><strong><code>&gt;&gt;</code>  (bitwise right shift)</strong>: shifts bits on the right operand by a number of positions equal to the right operand. Eg. <code>8 &gt;&gt; 2 = 2</code>. Both operands have to be Integer or Long values, otherwise the result will be null.</p>
</li>
<li>
<p><strong><code>&gt;&gt;&gt;</code>  (unsigned bitwise right shift)</strong> The same as <code>&gt;&gt;</code>, but with negative numbers it will fill with <code>1</code> on the left. Both operands have to be Integer or Long values, otherwise the result will be null.</p>
</li>
<li>
<p><strong><code>[</code>  (bitwise right shift)</strong> shifts bits on the left, eg. <code>2 [ 2 = 8</code>. Both operands have to be Integer or Long values, otherwise the result will be null.</p>
</li>
<li>
<p><strong><code>&amp;</code>  (bitwise AND)</strong> executes a bitwise AND operation. Both operands have to be Integer or Long values, otherwise the result will be null.</p>
</li>
<li>
<p><strong><code>|</code>  (bitwise OR)</strong> executes a bitwise OR operation. Both operands have to be Integer or Long values, otherwise the result will be null.</p>
</li>
<li>
<p><strong><code>^</code>  (bitwise XOR)</strong> executes a bitwise XOR operation. Both operands have to be Integer or Long values, otherwise the result will be null.</p>
</li>
<li>
<p><strong><code>||</code></strong>: array concatenation (see below for details).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Math Operators precedence</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">Operators</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">multiplicative</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code> <code>/</code> <code>%</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">additive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code> <code>-</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">shift</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[</code> <code>&gt;&gt;</code> <code>&gt;&gt;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bitwise AND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bitwise exclusive OR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bitwise inclusive OR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&#124;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">array concatenation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&#124;&#124;</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Math + Assign operators</strong></p>
</div>
<div class="paragraph">
<p>These operators can be used in UPDATE statements to update and set values. The semantics is the same as the operation plus the assignment,
eg. <code>a += 2</code> is just a shortcut for <code>a = a + 2</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>+=</code>  (add and assign)</strong>: adds right operand to left operand and assigns the value to the left operand. Returns the final value of the left operand. If one of the operands is not a number, then this operator acts as a <code>concatenate string values and assign</code></p>
</li>
<li>
<p><strong><code>-=</code>  (subtract and assign)</strong>: subtracts right operand from left operand and assigns the value to the left operand. Returns the final value of the left operand</p>
</li>
<li>
<p><strong><code>*=</code>  (multiply and assign)</strong>: multiplies left operand and right operand and assigns the value to the left operand. Returns the final value of the left operand</p>
</li>
<li>
<p><strong><code>/=</code>  (divide and assign)</strong>: divides left operand by right operand and assigns the value to the left operand. Returns the final value of the left operand</p>
</li>
<li>
<p><strong><code>%=</code>  (modulo and assign)</strong>: calculates left operand modulo right operand and assigns the value to the left operand. Returns the final value of the left operand</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Array concatenation</strong></p>
</div>
<div class="paragraph">
<p>The <code>||</code> operator concatenates two arrays.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[1, 2, 3] || [4, 5] = [1, 2, 3, 4, 5]</code></pre>
</div>
</div>
<div class="paragraph">
<p>If one of the elements is not an array, then it&#8217;s converted to an array of one element, before the concatenation operation is executed</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[1, 2, 3] || 4 = [1, 2, 3, 4]

1 || [2, 3, 4] = [1, 2, 3, 4]

1 || 2 || 3 || 4 = [1, 2, 3, 4]</code></pre>
</div>
</div>
<div class="paragraph">
<p>To add an array, you have to wrap the array element in another array:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[[1, 2], [3, 4]] || [5, 6] = [[1, 2], [3, 4], 5, 6]

[[1, 2], [3, 4]] || [[5, 6]] = [[1, 2], [3, 4], [5, 6]]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of an array concatenation is always a List (ordered and with duplicates). The order of the elements in the list is the same as the order in the elements in the source arrays, in the order they appear in the original expression.</p>
</div>
<div class="paragraph">
<p>To transform the result of an array concatenation in a Set (remove duplicates), just use the <code>.asSet()</code> method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[1, 2] || [2, 3] = [1, 2, 2, 3]

([1, 2] || [2, 3]).asSet() = [1, 2, 3]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Specific behavior of NULL</strong></p>
</div>
<div class="paragraph">
<p>Null value has no effect when applied to a || operation. eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[1, 2] || null = [1, 2]

null || [1, 2] = [1, 2]</code></pre>
</div>
</div>
<div class="paragraph">
<p>To add null values to a collection, you have to explicitly wrap them in another collection, eg.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[1, 2] || [null] = [1, 2, null]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Boolean Operators</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>AND</code></strong>: logical AND</p>
</li>
<li>
<p><strong><code>OR</code></strong>: logical OR</p>
</li>
<li>
<p><strong><code>NOT</code></strong>: logical NOT</p>
</li>
<li>
<p><strong><code>CONTAINS</code></strong>: checks if the left collection contains the right element. The left argument has to be a colleciton, otherwise it returns FALSE. It&#8217;s NOT the check of colleciton intersections, so <code>['a', 'b', 'c'] CONTAINS ['a', 'b']</code> will return FALSE, while <code>['a', 'b', 'c'] CONTAINS 'a'</code> will return TRUE.</p>
</li>
<li>
<p><strong><code>IN</code></strong>: the same as CONTAINS, but with inverted operands.</p>
</li>
<li>
<p><strong><code>CONTAINSKEY</code></strong>: for maps, the same as for CONTAINS, but checks on the map keys</p>
</li>
<li>
<p><strong><code>CONTAINSVALUE</code></strong>: for maps, the same as for CONTAINS, but checks on the map values</p>
</li>
<li>
<p><strong><code>LIKE</code></strong>: for strings, checks if a string contains another string. <code>%</code> is used as a wildcard, eg. <code>'foobar CONTAINS '%ooba%''</code></p>
</li>
<li>
<p><strong><code>IS DEFINED</code></strong> (unary): returns TRUE is a field is defined in a document</p>
</li>
<li>
<p><strong><code>IS NOT DEFINED</code></strong> (unary): returns TRUE is a field is not defined in a document</p>
</li>
<li>
<p><strong><code>BETWEEN - AND</code></strong> (ternary): returns TRUE is a value is between two values, eg. <code>5 BETWEEN 1 AND 10</code></p>
</li>
<li>
<p><strong><code>MATCHES</code></strong>: checks if a string matches a regular expression</p>
</li>
<li>
<p><strong><code>INSTANCEOF</code></strong>: checks the type of a value, the right operand has to be the a String representing a type name, eg. <code>father INSTANCEOF 'Person'</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Storage-Internals">11.6. Storage Internals</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/appendix/storage.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="sect3">
<h4 id="_page_version">11.6.1. Page Version</h4>
<div class="paragraph">
<p>Records are stored in pages.
Each page has its own version number, which increments on each update.
At creation the page version is zero.
In optimistic transactions, ArcadeDB checks the version in order to avoid conflicts at commit time.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="LSM-Tree">11.7. LSM-Tree Algorithm</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/appendix/lsm-tree.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>ArcadeDB indexes are built by using the LSM Tree algorithm.</p>
</div>
<div class="sect3">
<h4 id="_quick_overview">11.7.1. Quick Overview</h4>
<div class="paragraph">
<p>The LSM-Tree index is optimized for writes with a complexity of O(1) in writing because it does not require a re-balancing of the tree (like the B+Tree) and O(log(N)) to O(log(N)^2) with reads, depending on how fragmented (non compacted) the index is at a point of time.</p>
</div>
<div class="paragraph">
<p>The class LSMTreeIndex is the main entrypoint for the index.
This class contains an instance of a LSMTreeIndexMutable class that manages the current mutable index and a subIndex in case there is a compacted index connected.</p>
</div>
<div class="paragraph">
<p>ArcadeDB uses pages to store index entries.
Those pages are immutable once full and cannot be changed.
This is why it is considered an append-only index.
After a while, ArcadeDB runs the compactor that compacts the index by reading the content of the pages from disk, compresses the content and write them back into new pages to disk.
This process happens in background while the index can be used by the application.</p>
</div>
<div class="paragraph">
<p>The LSMTreeIndexMutable class holds the current page in RAM so new entries can be quickly appended to the page.
When the database is closed or when the page is full, the page is serialized to disk and becomes immutable.
Since the pages are immutable, deletion are managed with special placeholders to mark the entries as removed.</p>
</div>
<div class="paragraph">
<p>Since the LSM-Tree is append only, the most updated entries are at the end of the index.
If an entry is created and then deleted, the deletion will always be after the creation.
For this reason cursors start from the last pages back to the first one available.
While the cursor is browsing the pages back, it keeps track of the deleted values encountered.</p>
</div>
<div class="sect4">
<h5 id="_compaction">Compaction</h5>
<div class="paragraph">
<p>During compaction, new compressed version of the pages are stored.
The pages are stored in segments where the root page is the first page of the segment.
A file can have multiple segments.
The compaction requires a lot of RAM to properly compact large indexes and make them efficient.
To control the amount of RAM the compaction task is using, the setting <code>arcadedb.indexCompactionRAM</code> is used to determine the maximum amount of RAM allowed to use for compaction.
By default is 300MB of RAM.
Also, the setting <code>arcadedb.indexCompactionMinPagesSchedule</code> tells the index when it is time for scheduling a compaction.
By default the minimum is 10 pages not compacted.
If you set <code>0</code>, the automatic compaction is disabled.</p>
</div>
<div class="paragraph">
<p>If, for example, the compaction task finds 20 pages to compact, but the RAM requirements allow only 10 pages to be compacted, then the task will process the first 10 pages in one segment and the remaining 10 pages in the following segment.
Having multiple segments in the same file allows to run the compaction with a minimum amount of RAM if needed.</p>
</div>
</div>
<div class="sect4">
<h5 id="_page_layout">Page layout</h5>
<div class="paragraph">
<p>There are 2 types of pages: root page and data page.
The pages are populated from the head of the page by storing the pointers to the pair of key/value that are written from the tail.
A page is full when there is no space between the head (key pointers) and the tail (key/value pairs).
When a page is full, another page is created, waiting for a compaction.</p>
</div>
<div class="paragraph">
<p><strong>Root Page</strong></p>
</div>
<div class="paragraph">
<p>It&#8217;s the first page of a segment of pages.
The header contains more information than the Data Page (see below).
Both root pages and data pages store keys.
With mutable indexes the only difference is that the root page has a larger header.
For compacted indexes, the root page does not store entries, but contains pointers to the data pages with the first key indexed on the page of the current segment.</p>
</div>
<div class="paragraph">
<p>Header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[offsetFreeKeyValueContent(int:4),numberOfEntries(int:4),mutable(boolean:1),compactedPageNumberOfSeries(int:4),subIndexFileId(int:4),numberOfKeys(byte:1),keyType(byte:1)*]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>offsetFreeKeyValueContent</strong> is the offset in the page of free space to store key/value pairs.
When a page is new, the offset points to the end of the page because the pairs are filled from the end to the beginning</p>
</li>
<li>
<p><strong>numberOfEntries</strong> number of entries (pairs) in the current page</p>
</li>
<li>
<p><strong>mutable</strong> 1 means mutable, 0 immutable.
Immutable pages cannot be modified, only compacted and then removed at the end of compaction cycle</p>
</li>
<li>
<p><strong>compactedPageNumberOfSeries</strong> number of pages in the compacted segment.
This is stored in the last page of the segment and it is used to count the pages of the current segment and therefore finding the root page of the segment</p>
</li>
<li>
<p><strong>subIndexFileId</strong> file id of compacted page segment</p>
</li>
<li>
<p><strong>numberOfKeys</strong> number of keys.
If you&#8217;re using a composite index, multiple keys are used, otherwise only 1</p>
</li>
<li>
<p><strong>keyType</strong> an array of key types.
If the numberOfKeys is 3, then 3 bytes for keyType are written</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Data Page</strong></p>
</div>
<div class="paragraph">
<p>Header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[offsetFreeKeyValueContent(int:4),numberOfEntries(int:4),mutable(boolean:1),compactedPageNumberOfSeries(int:4)]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Look the root page for the meaning of the header fields.</p>
</div>
</div>
<div class="sect4">
<h5 id="_mutable_structure">Mutable Structure</h5>
<div class="paragraph">
<p>Before being compacted, the LSM-Tree index is conceptually simple: new entries are always inserted in the last page of the file that is the only mutable page of the index.
If the page is full, a new mutable page is created and the old mutable page become immutable and stored on disk.
The entries in the page are written already ordered by key.
This means a cursor can just browse the page from the first entry to the last to have ordered items.
The search of a key is executed with the <a href="https://en.wikipedia.org/wiki/Dichotomic_search">dichotomy algorithm</a>.
Pages can have entries with the same key, because have been added later in the index.
On writing, the order of the keys is maintained inside the same page.
This means to have a true ordered iterator, a virtual iterator is created with pointers to all the pages.
Every time you move forward in the iterator, the next available key in the page pointer is compared among each other and the minor is returned.
This can become quite expensive in the case of millions of entries and hundreds of pages.
For this reason a periodic compaction is needed to keep values ordered together in the same page and also to remove deleted items.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Requirements">11.8. Requirements</h3>
<h4 id="_memory" class="discrete">Memory</h4>
<div class="paragraph">
<p>ArcadeDB&#8217;s memory (RAM) requirements depend on the <a href="#Settings">configured profile</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>default</code> profile: 800MB</p>
</li>
<li>
<p><code>low-ram</code> profile: 16MB</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>see also <a href="#_ram-configuration">RAM Configuration</a>.</p>
</div>
<h4 id="_java" class="discrete">Java</h4>
<div class="paragraph">
<p>ArcadeDB runs on the Java Runtime Environment (JRE) in <a href="https://en.wikipedia.org/wiki/Java_version_history">versions</a> <strong>11</strong> to <strong>15</strong>;
tested JREs are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://openjdk.org/">OpenJDK</a> 11</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Newer JRE versions (<strong>16</strong> and onwards) are currently incompatible due to a bug in Gremlin,
see <a href="https://github.com/ArcadeData/arcadedb/issues/17">ArcadeDB: Gremlin doesn&#8217;t work with Java 16+</a> and <a href="https://issues.apache.org/jira/browse/TINKERPOP-2703">Tinkerpop: Build on JDK17</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="Community">11.9. Community</h3>
<div class="paragraph">
<p>Join our growing community around the world, for ideas, discussions and help regarding ArcadeDB.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Chat live with us on Discord: <a href="https://discord.gg/w2Npx2B7hZ" class="bare">https://discord.gg/w2Npx2B7hZ</a></p>
</li>
<li>
<p>Follow us on Twitter: <a href="https://twitter.com/arcade_db" class="bare">https://twitter.com/arcade_db</a></p>
</li>
<li>
<p>Connect with us on LinkedIn: <a href="https://www.linkedin.com/products/arcadedb" class="bare">https://www.linkedin.com/products/arcadedb</a></p>
</li>
<li>
<p>or on Facebook: <a href="https://www.facebook.com/arcadedb" class="bare">https://www.facebook.com/arcadedb</a></p>
</li>
<li>
<p>Questions tagged <code>#arcadedb</code> on Stack Overflow: <a href="https://stackoverflow.com/questions/tagged/arcadedb" class="bare">https://stackoverflow.com/questions/tagged/arcadedb</a></p>
</li>
<li>
<p>View our official Blog: <a href="https://blog.arcadedb.com/" class="bare">https://blog.arcadedb.com/</a></p>
</li>
</ul>
</div>
<h4 id="FAQ" class="discrete">Frequently Asked Questions</h4>
<div class="ulist">
<ul>
<li>
<p>How do I build or contribute to ArcadeDB?</p>
<div class="ulist">
<ul>
<li>
<p>See the contributing guide in the ArcadeDB <a href="https://github.com/ArcadeData/arcadedb">github</a> repository: <a href="https://github.com/ArcadeData/arcadedb/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="ReportAnIssue">11.10. Report an Issue</h3>
<div class="paragraph">
<p><span class="image right"><a class="image" href="https://github.com/ArcadeData/arcadedb-docs/blob/main/src/main/asciidoc/appendix/issues.adoc"><img src="images/edit.png" alt="edit"></a></span></p>
</div>
<div class="paragraph">
<p>Very often when a new issue is open it lacks some fundamental information. This slows down the entire process because the first question from the ArcadeDB team is always "What release of ArcadeDB are you using?" and every time a Ferret dies in the world.</p>
</div>
<div class="paragraph">
<p>So please add more information about your issue:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ArcadeDB <strong>release</strong>? (If you&#8217;re using a SNAPSHOT please attach also the build number found in "build.number" file)</p>
</li>
<li>
<p>What <strong>steps</strong> will reproduce the problem?</p>
</li>
<li>
<p><strong>Settings</strong>. If you&#8217;re using custom settings please provide them below (to dump all the settings run the application using the JVM argument <code>-Darcadedb.environment.dumpCfgAtStartup=true</code>)</p>
</li>
<li>
<p>What is the <strong>expected behavior</strong> or output? What do you get or see instead?</p>
</li>
<li>
<p>If you&#8217;re describing a performance or memory problem the <strong>profiler</strong> dump can be very useful</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now you&#8217;re ready to create a new issue on <a href="https://github.com/arcadedata/arcadedb/issues/new">GitHub</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>* Java and JVM are registered trademarks of Oracle Corporation
* * All the trademarks are property of their owner. ArcadeDB does not own such trademarks.</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>ArcadeDB is a trademark registered by Arcade Data Ltd. Copyright (c) Arcade Data LTD.

Every effort has been made to ensure the accuracy of this manual. However, Arcade Data, LTD. makes no warranties with respect to this documentation and disclaims any implied warranties of merchantability and fitness for a particular purpose. The information in this document is subject to change without notice.

If you would like to report an issue in the documentation or you would like to be part of our community on improving the documentation for ArcadeDB Open Source project, please send your changes through our GitHub project and send a Pull Request for approval.</pre>
</div>
</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VMEXV32107"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-VMEXV32107');
</script>

<script type="text/javascript" id="zsiqchat">var $zoho=$zoho || {};$zoho.salesiq = $zoho.salesiq || {widgetcode: "3091fde2aff944230b8c3ce6dda09e325a1c1f19ae25d8030e03b9c2c17e71db1a2010ab7b6727677d37b27582c0e9c4", values:{},ready:function(){}};var d=document;s=d.createElement("script");s.type="text/javascript";s.id="zsiqscript";s.defer=true;s.src="https://salesiq.zoho.com/widget";t=d.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t);</script>

<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />

<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script>
<script>
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#000"
    },
    "button": {
      "background": "#f1d600"
    }
  },
  "theme": "edgeless",
  "position": "top",
  "content": {
    "href": "https://arcadedb.com/privacy.html"
  },
  "domain": "arcadedb.com"
});
</script>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 23.3.1<br>
Last updated 2023-04-08 23:53:16 UTC
</div>
</div>
</body>
</html>